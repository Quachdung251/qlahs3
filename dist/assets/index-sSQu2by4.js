var ny=Object.defineProperty;var iy=(e,t,r)=>t in e?ny(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var le=(e,t,r)=>iy(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var Dt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function sy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ay(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var Jp={exports:{}},vc={},Zp={exports:{}},be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var To=Symbol.for("react.element"),oy=Symbol.for("react.portal"),ly=Symbol.for("react.fragment"),cy=Symbol.for("react.strict_mode"),uy=Symbol.for("react.profiler"),fy=Symbol.for("react.provider"),hy=Symbol.for("react.context"),dy=Symbol.for("react.forward_ref"),py=Symbol.for("react.suspense"),my=Symbol.for("react.memo"),gy=Symbol.for("react.lazy"),bh=Symbol.iterator;function xy(e){return e===null||typeof e!="object"?null:(e=bh&&e[bh]||e["@@iterator"],typeof e=="function"?e:null)}var e1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},t1=Object.assign,r1={};function Ks(e,t,r){this.props=e,this.context=t,this.refs=r1,this.updater=r||e1}Ks.prototype.isReactComponent={};Ks.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ks.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function n1(){}n1.prototype=Ks.prototype;function q0(e,t,r){this.props=e,this.context=t,this.refs=r1,this.updater=r||e1}var Q0=q0.prototype=new n1;Q0.constructor=q0;t1(Q0,Ks.prototype);Q0.isPureReactComponent=!0;var Nh=Array.isArray,i1=Object.prototype.hasOwnProperty,J0={current:null},s1={key:!0,ref:!0,__self:!0,__source:!0};function a1(e,t,r){var n,i={},s=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)i1.call(t,n)&&!s1.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:To,type:e,key:s,ref:a,props:i,_owner:J0.current}}function vy(e,t){return{$$typeof:To,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Z0(e){return typeof e=="object"&&e!==null&&e.$$typeof===To}function yy(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Ah=/\/+/g;function Jc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?yy(""+e.key):t.toString(36)}function ml(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case To:case oy:a=!0}}if(a)return a=e,i=i(a),e=n===""?"."+Jc(a,0):n,Nh(i)?(r="",e!=null&&(r=e.replace(Ah,"$&/")+"/"),ml(i,t,r,"",function(c){return c})):i!=null&&(Z0(i)&&(i=vy(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(Ah,"$&/")+"/")+e)),t.push(i)),1;if(a=0,n=n===""?".":n+":",Nh(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+Jc(s,o);a+=ml(s,t,r,l,i)}else if(l=xy(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+Jc(s,o++),a+=ml(s,t,r,l,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Mo(e,t,r){if(e==null)return e;var n=[],i=0;return ml(e,n,"","",function(s){return t.call(r,s,i++)}),n}function wy(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Jt={current:null},gl={transition:null},_y={ReactCurrentDispatcher:Jt,ReactCurrentBatchConfig:gl,ReactCurrentOwner:J0};function o1(){throw Error("act(...) is not supported in production builds of React.")}be.Children={map:Mo,forEach:function(e,t,r){Mo(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Mo(e,function(){t++}),t},toArray:function(e){return Mo(e,function(t){return t})||[]},only:function(e){if(!Z0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};be.Component=Ks;be.Fragment=ly;be.Profiler=uy;be.PureComponent=q0;be.StrictMode=cy;be.Suspense=py;be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_y;be.act=o1;be.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=t1({},e.props),i=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=J0.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)i1.call(t,l)&&!s1.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:To,type:e.type,key:i,ref:s,props:n,_owner:a}};be.createContext=function(e){return e={$$typeof:hy,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:fy,_context:e},e.Consumer=e};be.createElement=a1;be.createFactory=function(e){var t=a1.bind(null,e);return t.type=e,t};be.createRef=function(){return{current:null}};be.forwardRef=function(e){return{$$typeof:dy,render:e}};be.isValidElement=Z0;be.lazy=function(e){return{$$typeof:gy,_payload:{_status:-1,_result:e},_init:wy}};be.memo=function(e,t){return{$$typeof:my,type:e,compare:t===void 0?null:t}};be.startTransition=function(e){var t=gl.transition;gl.transition={};try{e()}finally{gl.transition=t}};be.unstable_act=o1;be.useCallback=function(e,t){return Jt.current.useCallback(e,t)};be.useContext=function(e){return Jt.current.useContext(e)};be.useDebugValue=function(){};be.useDeferredValue=function(e){return Jt.current.useDeferredValue(e)};be.useEffect=function(e,t){return Jt.current.useEffect(e,t)};be.useId=function(){return Jt.current.useId()};be.useImperativeHandle=function(e,t,r){return Jt.current.useImperativeHandle(e,t,r)};be.useInsertionEffect=function(e,t){return Jt.current.useInsertionEffect(e,t)};be.useLayoutEffect=function(e,t){return Jt.current.useLayoutEffect(e,t)};be.useMemo=function(e,t){return Jt.current.useMemo(e,t)};be.useReducer=function(e,t,r){return Jt.current.useReducer(e,t,r)};be.useRef=function(e){return Jt.current.useRef(e)};be.useState=function(e){return Jt.current.useState(e)};be.useSyncExternalStore=function(e,t,r){return Jt.current.useSyncExternalStore(e,t,r)};be.useTransition=function(){return Jt.current.useTransition()};be.version="18.3.1";Zp.exports=be;var ee=Zp.exports;const l1=sy(ee);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ty=ee,Ey=Symbol.for("react.element"),Sy=Symbol.for("react.fragment"),ky=Object.prototype.hasOwnProperty,Cy=Ty.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,by={key:!0,ref:!0,__self:!0,__source:!0};function c1(e,t,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)ky.call(t,n)&&!by.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:Ey,type:e,key:s,ref:a,props:i,_owner:Cy.current}}vc.Fragment=Sy;vc.jsx=c1;vc.jsxs=c1;Jp.exports=vc;var f=Jp.exports,u1={exports:{}},wr={},f1={exports:{}},h1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(H,q){var ie=H.length;H.push(q);e:for(;0<ie;){var pe=ie-1>>>1,O=H[pe];if(0<i(O,q))H[pe]=q,H[ie]=O,ie=pe;else break e}}function r(H){return H.length===0?null:H[0]}function n(H){if(H.length===0)return null;var q=H[0],ie=H.pop();if(ie!==q){H[0]=ie;e:for(var pe=0,O=H.length,L=O>>>1;pe<L;){var j=2*(pe+1)-1,I=H[j],X=j+1,ce=H[X];if(0>i(I,ie))X<O&&0>i(ce,I)?(H[pe]=ce,H[X]=ie,pe=X):(H[pe]=I,H[j]=ie,pe=j);else if(X<O&&0>i(ce,ie))H[pe]=ce,H[X]=ie,pe=X;else break e}}return q}function i(H,q){var ie=H.sortIndex-q.sortIndex;return ie!==0?ie:H.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,h=null,d=3,m=!1,g=!1,p=!1,v=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(H){for(var q=r(c);q!==null;){if(q.callback===null)n(c);else if(q.startTime<=H)n(c),q.sortIndex=q.expirationTime,t(l,q);else break;q=r(c)}}function E(H){if(p=!1,y(H),!g)if(r(l)!==null)g=!0,Te(C);else{var q=r(c);q!==null&&Ee(E,q.startTime-H)}}function C(H,q){g=!1,p&&(p=!1,x(F),F=-1),m=!0;var ie=d;try{for(y(q),h=r(l);h!==null&&(!(h.expirationTime>q)||H&&!W());){var pe=h.callback;if(typeof pe=="function"){h.callback=null,d=h.priorityLevel;var O=pe(h.expirationTime<=q);q=e.unstable_now(),typeof O=="function"?h.callback=O:h===r(l)&&n(l),y(q)}else n(l);h=r(l)}if(h!==null)var L=!0;else{var j=r(c);j!==null&&Ee(E,j.startTime-q),L=!1}return L}finally{h=null,d=ie,m=!1}}var R=!1,D=null,F=-1,N=5,P=-1;function W(){return!(e.unstable_now()-P<N)}function G(){if(D!==null){var H=e.unstable_now();P=H;var q=!0;try{q=D(!0,H)}finally{q?Q():(R=!1,D=null)}}else R=!1}var Q;if(typeof w=="function")Q=function(){w(G)};else if(typeof MessageChannel<"u"){var ve=new MessageChannel,ge=ve.port2;ve.port1.onmessage=G,Q=function(){ge.postMessage(null)}}else Q=function(){v(G,0)};function Te(H){D=H,R||(R=!0,Q())}function Ee(H,q){F=v(function(){H(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(H){H.callback=null},e.unstable_continueExecution=function(){g||m||(g=!0,Te(C))},e.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<H?Math.floor(1e3/H):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(H){switch(d){case 1:case 2:case 3:var q=3;break;default:q=d}var ie=d;d=q;try{return H()}finally{d=ie}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(H,q){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var ie=d;d=H;try{return q()}finally{d=ie}},e.unstable_scheduleCallback=function(H,q,ie){var pe=e.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?pe+ie:pe):ie=pe,H){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=ie+O,H={id:u++,callback:q,priorityLevel:H,startTime:ie,expirationTime:O,sortIndex:-1},ie>pe?(H.sortIndex=ie,t(c,H),r(l)===null&&H===r(c)&&(p?(x(F),F=-1):p=!0,Ee(E,ie-pe))):(H.sortIndex=O,t(l,H),g||m||(g=!0,Te(C))),H},e.unstable_shouldYield=W,e.unstable_wrapCallback=function(H){var q=d;return function(){var ie=d;d=q;try{return H.apply(this,arguments)}finally{d=ie}}}})(h1);f1.exports=h1;var Ny=f1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ay=ee,vr=Ny;function Z(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d1=new Set,Xa={};function Vi(e,t){Is(e,t),Is(e+"Capture",t)}function Is(e,t){for(Xa[e]=t,e=0;e<t.length;e++)d1.add(t[e])}var Sn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),$u=Object.prototype.hasOwnProperty,Dy=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Dh={},Oh={};function Oy(e){return $u.call(Oh,e)?!0:$u.call(Dh,e)?!1:Dy.test(e)?Oh[e]=!0:(Dh[e]=!0,!1)}function Py(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Fy(e,t,r,n){if(t===null||typeof t>"u"||Py(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Zt(e,t,r,n,i,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var jt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){jt[e]=new Zt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];jt[t]=new Zt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){jt[e]=new Zt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){jt[e]=new Zt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){jt[e]=new Zt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){jt[e]=new Zt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){jt[e]=new Zt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){jt[e]=new Zt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){jt[e]=new Zt(e,5,!1,e.toLowerCase(),null,!1,!1)});var ef=/[\-:]([a-z])/g;function tf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(ef,tf);jt[t]=new Zt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(ef,tf);jt[t]=new Zt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(ef,tf);jt[t]=new Zt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){jt[e]=new Zt(e,1,!1,e.toLowerCase(),null,!1,!1)});jt.xlinkHref=new Zt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){jt[e]=new Zt(e,1,!1,e.toLowerCase(),null,!0,!0)});function rf(e,t,r,n){var i=jt.hasOwnProperty(t)?jt[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Fy(t,r,i,n)&&(r=null),n||i===null?Oy(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var On=Ay.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Bo=Symbol.for("react.element"),hs=Symbol.for("react.portal"),ds=Symbol.for("react.fragment"),nf=Symbol.for("react.strict_mode"),Hu=Symbol.for("react.profiler"),p1=Symbol.for("react.provider"),m1=Symbol.for("react.context"),sf=Symbol.for("react.forward_ref"),zu=Symbol.for("react.suspense"),Wu=Symbol.for("react.suspense_list"),af=Symbol.for("react.memo"),Mn=Symbol.for("react.lazy"),g1=Symbol.for("react.offscreen"),Ph=Symbol.iterator;function ua(e){return e===null||typeof e!="object"?null:(e=Ph&&e[Ph]||e["@@iterator"],typeof e=="function"?e:null)}var tt=Object.assign,Zc;function _a(e){if(Zc===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Zc=t&&t[1]||""}return`
`+Zc+e}var eu=!1;function tu(e,t){if(!e||eu)return"";eu=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=o);break}}}finally{eu=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?_a(e):""}function Ry(e){switch(e.tag){case 5:return _a(e.type);case 16:return _a("Lazy");case 13:return _a("Suspense");case 19:return _a("SuspenseList");case 0:case 2:case 15:return e=tu(e.type,!1),e;case 11:return e=tu(e.type.render,!1),e;case 1:return e=tu(e.type,!0),e;default:return""}}function Vu(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ds:return"Fragment";case hs:return"Portal";case Hu:return"Profiler";case nf:return"StrictMode";case zu:return"Suspense";case Wu:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case m1:return(e.displayName||"Context")+".Consumer";case p1:return(e._context.displayName||"Context")+".Provider";case sf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case af:return t=e.displayName||null,t!==null?t:Vu(e.type)||"Memo";case Mn:t=e._payload,e=e._init;try{return Vu(e(t))}catch{}}return null}function jy(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Vu(t);case 8:return t===nf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ni(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function x1(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Iy(e){var t=x1(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Uo(e){e._valueTracker||(e._valueTracker=Iy(e))}function v1(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=x1(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Nl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Gu(e,t){var r=t.checked;return tt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Fh(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ni(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function y1(e,t){t=t.checked,t!=null&&rf(e,"checked",t,!1)}function Ku(e,t){y1(e,t);var r=ni(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Xu(e,t.type,r):t.hasOwnProperty("defaultValue")&&Xu(e,t.type,ni(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Rh(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Xu(e,t,r){(t!=="number"||Nl(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ta=Array.isArray;function ks(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ni(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Yu(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Z(91));return tt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function jh(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Z(92));if(Ta(r)){if(1<r.length)throw Error(Z(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ni(r)}}function w1(e,t){var r=ni(t.value),n=ni(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Ih(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function _1(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qu(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?_1(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var $o,T1=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for($o=$o||document.createElement("div"),$o.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=$o.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ya(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Na={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ly=["Webkit","ms","Moz","O"];Object.keys(Na).forEach(function(e){Ly.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Na[t]=Na[e]})});function E1(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Na.hasOwnProperty(e)&&Na[e]?(""+t).trim():t+"px"}function S1(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=E1(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var My=tt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Qu(e,t){if(t){if(My[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Z(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Z(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Z(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Z(62))}}function Ju(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zu=null;function of(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var e0=null,Cs=null,bs=null;function Lh(e){if(e=ko(e)){if(typeof e0!="function")throw Error(Z(280));var t=e.stateNode;t&&(t=Ec(t),e0(e.stateNode,e.type,t))}}function k1(e){Cs?bs?bs.push(e):bs=[e]:Cs=e}function C1(){if(Cs){var e=Cs,t=bs;if(bs=Cs=null,Lh(e),t)for(e=0;e<t.length;e++)Lh(t[e])}}function b1(e,t){return e(t)}function N1(){}var ru=!1;function A1(e,t,r){if(ru)return e(t,r);ru=!0;try{return b1(e,t,r)}finally{ru=!1,(Cs!==null||bs!==null)&&(N1(),C1())}}function qa(e,t){var r=e.stateNode;if(r===null)return null;var n=Ec(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Z(231,t,typeof r));return r}var t0=!1;if(Sn)try{var fa={};Object.defineProperty(fa,"passive",{get:function(){t0=!0}}),window.addEventListener("test",fa,fa),window.removeEventListener("test",fa,fa)}catch{t0=!1}function By(e,t,r,n,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var Aa=!1,Al=null,Dl=!1,r0=null,Uy={onError:function(e){Aa=!0,Al=e}};function $y(e,t,r,n,i,s,a,o,l){Aa=!1,Al=null,By.apply(Uy,arguments)}function Hy(e,t,r,n,i,s,a,o,l){if($y.apply(this,arguments),Aa){if(Aa){var c=Al;Aa=!1,Al=null}else throw Error(Z(198));Dl||(Dl=!0,r0=c)}}function Gi(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function D1(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Mh(e){if(Gi(e)!==e)throw Error(Z(188))}function zy(e){var t=e.alternate;if(!t){if(t=Gi(e),t===null)throw Error(Z(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return Mh(i),e;if(s===n)return Mh(i),t;s=s.sibling}throw Error(Z(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(Z(189))}}if(r.alternate!==n)throw Error(Z(190))}if(r.tag!==3)throw Error(Z(188));return r.stateNode.current===r?e:t}function O1(e){return e=zy(e),e!==null?P1(e):null}function P1(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=P1(e);if(t!==null)return t;e=e.sibling}return null}var F1=vr.unstable_scheduleCallback,Bh=vr.unstable_cancelCallback,Wy=vr.unstable_shouldYield,Vy=vr.unstable_requestPaint,ot=vr.unstable_now,Gy=vr.unstable_getCurrentPriorityLevel,lf=vr.unstable_ImmediatePriority,R1=vr.unstable_UserBlockingPriority,Ol=vr.unstable_NormalPriority,Ky=vr.unstable_LowPriority,j1=vr.unstable_IdlePriority,yc=null,rn=null;function Xy(e){if(rn&&typeof rn.onCommitFiberRoot=="function")try{rn.onCommitFiberRoot(yc,e,void 0,(e.current.flags&128)===128)}catch{}}var zr=Math.clz32?Math.clz32:Qy,Yy=Math.log,qy=Math.LN2;function Qy(e){return e>>>=0,e===0?32:31-(Yy(e)/qy|0)|0}var Ho=64,zo=4194304;function Ea(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Pl(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=Ea(o):(s&=a,s!==0&&(n=Ea(s)))}else a=r&~i,a!==0?n=Ea(a):s!==0&&(n=Ea(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-zr(t),i=1<<r,n|=e[r],t&=~i;return n}function Jy(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Zy(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-zr(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=Jy(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function n0(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function I1(){var e=Ho;return Ho<<=1,!(Ho&4194240)&&(Ho=64),e}function nu(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Eo(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-zr(t),e[t]=r}function ew(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-zr(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function cf(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-zr(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Ue=0;function L1(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var M1,uf,B1,U1,$1,i0=!1,Wo=[],Yn=null,qn=null,Qn=null,Qa=new Map,Ja=new Map,$n=[],tw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Uh(e,t){switch(e){case"focusin":case"focusout":Yn=null;break;case"dragenter":case"dragleave":qn=null;break;case"mouseover":case"mouseout":Qn=null;break;case"pointerover":case"pointerout":Qa.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ja.delete(t.pointerId)}}function ha(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=ko(t),t!==null&&uf(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function rw(e,t,r,n,i){switch(t){case"focusin":return Yn=ha(Yn,e,t,r,n,i),!0;case"dragenter":return qn=ha(qn,e,t,r,n,i),!0;case"mouseover":return Qn=ha(Qn,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return Qa.set(s,ha(Qa.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Ja.set(s,ha(Ja.get(s)||null,e,t,r,n,i)),!0}return!1}function H1(e){var t=Di(e.target);if(t!==null){var r=Gi(t);if(r!==null){if(t=r.tag,t===13){if(t=D1(r),t!==null){e.blockedOn=t,$1(e.priority,function(){B1(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function xl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=s0(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Zu=n,r.target.dispatchEvent(n),Zu=null}else return t=ko(r),t!==null&&uf(t),e.blockedOn=r,!1;t.shift()}return!0}function $h(e,t,r){xl(e)&&r.delete(t)}function nw(){i0=!1,Yn!==null&&xl(Yn)&&(Yn=null),qn!==null&&xl(qn)&&(qn=null),Qn!==null&&xl(Qn)&&(Qn=null),Qa.forEach($h),Ja.forEach($h)}function da(e,t){e.blockedOn===t&&(e.blockedOn=null,i0||(i0=!0,vr.unstable_scheduleCallback(vr.unstable_NormalPriority,nw)))}function Za(e){function t(i){return da(i,e)}if(0<Wo.length){da(Wo[0],e);for(var r=1;r<Wo.length;r++){var n=Wo[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Yn!==null&&da(Yn,e),qn!==null&&da(qn,e),Qn!==null&&da(Qn,e),Qa.forEach(t),Ja.forEach(t),r=0;r<$n.length;r++)n=$n[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<$n.length&&(r=$n[0],r.blockedOn===null);)H1(r),r.blockedOn===null&&$n.shift()}var Ns=On.ReactCurrentBatchConfig,Fl=!0;function iw(e,t,r,n){var i=Ue,s=Ns.transition;Ns.transition=null;try{Ue=1,ff(e,t,r,n)}finally{Ue=i,Ns.transition=s}}function sw(e,t,r,n){var i=Ue,s=Ns.transition;Ns.transition=null;try{Ue=4,ff(e,t,r,n)}finally{Ue=i,Ns.transition=s}}function ff(e,t,r,n){if(Fl){var i=s0(e,t,r,n);if(i===null)du(e,t,n,Rl,r),Uh(e,n);else if(rw(i,e,t,r,n))n.stopPropagation();else if(Uh(e,n),t&4&&-1<tw.indexOf(e)){for(;i!==null;){var s=ko(i);if(s!==null&&M1(s),s=s0(e,t,r,n),s===null&&du(e,t,n,Rl,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else du(e,t,n,null,r)}}var Rl=null;function s0(e,t,r,n){if(Rl=null,e=of(n),e=Di(e),e!==null)if(t=Gi(e),t===null)e=null;else if(r=t.tag,r===13){if(e=D1(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Rl=e,null}function z1(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Gy()){case lf:return 1;case R1:return 4;case Ol:case Ky:return 16;case j1:return 536870912;default:return 16}default:return 16}}var Wn=null,hf=null,vl=null;function W1(){if(vl)return vl;var e,t=hf,r=t.length,n,i="value"in Wn?Wn.value:Wn.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===i[s-n];n++);return vl=i.slice(e,1<n?1-n:void 0)}function yl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Vo(){return!0}function Hh(){return!1}function _r(e){function t(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Vo:Hh,this.isPropagationStopped=Hh,this}return tt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Vo)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Vo)},persist:function(){},isPersistent:Vo}),t}var Xs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},df=_r(Xs),So=tt({},Xs,{view:0,detail:0}),aw=_r(So),iu,su,pa,wc=tt({},So,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==pa&&(pa&&e.type==="mousemove"?(iu=e.screenX-pa.screenX,su=e.screenY-pa.screenY):su=iu=0,pa=e),iu)},movementY:function(e){return"movementY"in e?e.movementY:su}}),zh=_r(wc),ow=tt({},wc,{dataTransfer:0}),lw=_r(ow),cw=tt({},So,{relatedTarget:0}),au=_r(cw),uw=tt({},Xs,{animationName:0,elapsedTime:0,pseudoElement:0}),fw=_r(uw),hw=tt({},Xs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),dw=_r(hw),pw=tt({},Xs,{data:0}),Wh=_r(pw),mw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vw(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=xw[e])?!!t[e]:!1}function pf(){return vw}var yw=tt({},So,{key:function(e){if(e.key){var t=mw[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=yl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?gw[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pf,charCode:function(e){return e.type==="keypress"?yl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?yl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),ww=_r(yw),_w=tt({},wc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vh=_r(_w),Tw=tt({},So,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pf}),Ew=_r(Tw),Sw=tt({},Xs,{propertyName:0,elapsedTime:0,pseudoElement:0}),kw=_r(Sw),Cw=tt({},wc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),bw=_r(Cw),Nw=[9,13,27,32],mf=Sn&&"CompositionEvent"in window,Da=null;Sn&&"documentMode"in document&&(Da=document.documentMode);var Aw=Sn&&"TextEvent"in window&&!Da,V1=Sn&&(!mf||Da&&8<Da&&11>=Da),Gh=" ",Kh=!1;function G1(e,t){switch(e){case"keyup":return Nw.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function K1(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ps=!1;function Dw(e,t){switch(e){case"compositionend":return K1(t);case"keypress":return t.which!==32?null:(Kh=!0,Gh);case"textInput":return e=t.data,e===Gh&&Kh?null:e;default:return null}}function Ow(e,t){if(ps)return e==="compositionend"||!mf&&G1(e,t)?(e=W1(),vl=hf=Wn=null,ps=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return V1&&t.locale!=="ko"?null:t.data;default:return null}}var Pw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Pw[e.type]:t==="textarea"}function X1(e,t,r,n){k1(n),t=jl(t,"onChange"),0<t.length&&(r=new df("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Oa=null,eo=null;function Fw(e){sm(e,0)}function _c(e){var t=xs(e);if(v1(t))return e}function Rw(e,t){if(e==="change")return t}var Y1=!1;if(Sn){var ou;if(Sn){var lu="oninput"in document;if(!lu){var Yh=document.createElement("div");Yh.setAttribute("oninput","return;"),lu=typeof Yh.oninput=="function"}ou=lu}else ou=!1;Y1=ou&&(!document.documentMode||9<document.documentMode)}function qh(){Oa&&(Oa.detachEvent("onpropertychange",q1),eo=Oa=null)}function q1(e){if(e.propertyName==="value"&&_c(eo)){var t=[];X1(t,eo,e,of(e)),A1(Fw,t)}}function jw(e,t,r){e==="focusin"?(qh(),Oa=t,eo=r,Oa.attachEvent("onpropertychange",q1)):e==="focusout"&&qh()}function Iw(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return _c(eo)}function Lw(e,t){if(e==="click")return _c(t)}function Mw(e,t){if(e==="input"||e==="change")return _c(t)}function Bw(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Gr=typeof Object.is=="function"?Object.is:Bw;function to(e,t){if(Gr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!$u.call(t,i)||!Gr(e[i],t[i]))return!1}return!0}function Qh(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Jh(e,t){var r=Qh(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Qh(r)}}function Q1(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Q1(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function J1(){for(var e=window,t=Nl();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Nl(e.document)}return t}function gf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Uw(e){var t=J1(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Q1(r.ownerDocument.documentElement,r)){if(n!==null&&gf(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=Jh(r,s);var a=Jh(r,n);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var $w=Sn&&"documentMode"in document&&11>=document.documentMode,ms=null,a0=null,Pa=null,o0=!1;function Zh(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;o0||ms==null||ms!==Nl(n)||(n=ms,"selectionStart"in n&&gf(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Pa&&to(Pa,n)||(Pa=n,n=jl(a0,"onSelect"),0<n.length&&(t=new df("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=ms)))}function Go(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var gs={animationend:Go("Animation","AnimationEnd"),animationiteration:Go("Animation","AnimationIteration"),animationstart:Go("Animation","AnimationStart"),transitionend:Go("Transition","TransitionEnd")},cu={},Z1={};Sn&&(Z1=document.createElement("div").style,"AnimationEvent"in window||(delete gs.animationend.animation,delete gs.animationiteration.animation,delete gs.animationstart.animation),"TransitionEvent"in window||delete gs.transitionend.transition);function Tc(e){if(cu[e])return cu[e];if(!gs[e])return e;var t=gs[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Z1)return cu[e]=t[r];return e}var em=Tc("animationend"),tm=Tc("animationiteration"),rm=Tc("animationstart"),nm=Tc("transitionend"),im=new Map,ed="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function hi(e,t){im.set(e,t),Vi(t,[e])}for(var uu=0;uu<ed.length;uu++){var fu=ed[uu],Hw=fu.toLowerCase(),zw=fu[0].toUpperCase()+fu.slice(1);hi(Hw,"on"+zw)}hi(em,"onAnimationEnd");hi(tm,"onAnimationIteration");hi(rm,"onAnimationStart");hi("dblclick","onDoubleClick");hi("focusin","onFocus");hi("focusout","onBlur");hi(nm,"onTransitionEnd");Is("onMouseEnter",["mouseout","mouseover"]);Is("onMouseLeave",["mouseout","mouseover"]);Is("onPointerEnter",["pointerout","pointerover"]);Is("onPointerLeave",["pointerout","pointerover"]);Vi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vi("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ww=new Set("cancel close invalid load scroll toggle".split(" ").concat(Sa));function td(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Hy(n,t,void 0,e),e.currentTarget=null}function sm(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;td(i,o,c),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;td(i,o,c),s=l}}}if(Dl)throw e=r0,Dl=!1,r0=null,e}function Ge(e,t){var r=t[h0];r===void 0&&(r=t[h0]=new Set);var n=e+"__bubble";r.has(n)||(am(t,e,2,!1),r.add(n))}function hu(e,t,r){var n=0;t&&(n|=4),am(r,e,n,t)}var Ko="_reactListening"+Math.random().toString(36).slice(2);function ro(e){if(!e[Ko]){e[Ko]=!0,d1.forEach(function(r){r!=="selectionchange"&&(Ww.has(r)||hu(r,!1,e),hu(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ko]||(t[Ko]=!0,hu("selectionchange",!1,t))}}function am(e,t,r,n){switch(z1(t)){case 1:var i=iw;break;case 4:i=sw;break;default:i=ff}r=i.bind(null,t,r,e),i=void 0,!t0||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function du(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=Di(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}A1(function(){var c=s,u=of(r),h=[];e:{var d=im.get(e);if(d!==void 0){var m=df,g=e;switch(e){case"keypress":if(yl(r)===0)break e;case"keydown":case"keyup":m=ww;break;case"focusin":g="focus",m=au;break;case"focusout":g="blur",m=au;break;case"beforeblur":case"afterblur":m=au;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=zh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=lw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=Ew;break;case em:case tm:case rm:m=fw;break;case nm:m=kw;break;case"scroll":m=aw;break;case"wheel":m=bw;break;case"copy":case"cut":case"paste":m=dw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Vh}var p=(t&4)!==0,v=!p&&e==="scroll",x=p?d!==null?d+"Capture":null:d;p=[];for(var w=c,y;w!==null;){y=w;var E=y.stateNode;if(y.tag===5&&E!==null&&(y=E,x!==null&&(E=qa(w,x),E!=null&&p.push(no(w,E,y)))),v)break;w=w.return}0<p.length&&(d=new m(d,g,null,r,u),h.push({event:d,listeners:p}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",d&&r!==Zu&&(g=r.relatedTarget||r.fromElement)&&(Di(g)||g[kn]))break e;if((m||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,m?(g=r.relatedTarget||r.toElement,m=c,g=g?Di(g):null,g!==null&&(v=Gi(g),g!==v||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=c),m!==g)){if(p=zh,E="onMouseLeave",x="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(p=Vh,E="onPointerLeave",x="onPointerEnter",w="pointer"),v=m==null?d:xs(m),y=g==null?d:xs(g),d=new p(E,w+"leave",m,r,u),d.target=v,d.relatedTarget=y,E=null,Di(u)===c&&(p=new p(x,w+"enter",g,r,u),p.target=y,p.relatedTarget=v,E=p),v=E,m&&g)t:{for(p=m,x=g,w=0,y=p;y;y=ts(y))w++;for(y=0,E=x;E;E=ts(E))y++;for(;0<w-y;)p=ts(p),w--;for(;0<y-w;)x=ts(x),y--;for(;w--;){if(p===x||x!==null&&p===x.alternate)break t;p=ts(p),x=ts(x)}p=null}else p=null;m!==null&&rd(h,d,m,p,!1),g!==null&&v!==null&&rd(h,v,g,p,!0)}}e:{if(d=c?xs(c):window,m=d.nodeName&&d.nodeName.toLowerCase(),m==="select"||m==="input"&&d.type==="file")var C=Rw;else if(Xh(d))if(Y1)C=Mw;else{C=Iw;var R=jw}else(m=d.nodeName)&&m.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(C=Lw);if(C&&(C=C(e,c))){X1(h,C,r,u);break e}R&&R(e,d,c),e==="focusout"&&(R=d._wrapperState)&&R.controlled&&d.type==="number"&&Xu(d,"number",d.value)}switch(R=c?xs(c):window,e){case"focusin":(Xh(R)||R.contentEditable==="true")&&(ms=R,a0=c,Pa=null);break;case"focusout":Pa=a0=ms=null;break;case"mousedown":o0=!0;break;case"contextmenu":case"mouseup":case"dragend":o0=!1,Zh(h,r,u);break;case"selectionchange":if($w)break;case"keydown":case"keyup":Zh(h,r,u)}var D;if(mf)e:{switch(e){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else ps?G1(e,r)&&(F="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(F="onCompositionStart");F&&(V1&&r.locale!=="ko"&&(ps||F!=="onCompositionStart"?F==="onCompositionEnd"&&ps&&(D=W1()):(Wn=u,hf="value"in Wn?Wn.value:Wn.textContent,ps=!0)),R=jl(c,F),0<R.length&&(F=new Wh(F,e,null,r,u),h.push({event:F,listeners:R}),D?F.data=D:(D=K1(r),D!==null&&(F.data=D)))),(D=Aw?Dw(e,r):Ow(e,r))&&(c=jl(c,"onBeforeInput"),0<c.length&&(u=new Wh("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:c}),u.data=D))}sm(h,t)})}function no(e,t,r){return{instance:e,listener:t,currentTarget:r}}function jl(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=qa(e,r),s!=null&&n.unshift(no(e,s,i)),s=qa(e,t),s!=null&&n.push(no(e,s,i))),e=e.return}return n}function ts(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function rd(e,t,r,n,i){for(var s=t._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=qa(r,s),l!=null&&a.unshift(no(r,l,o))):i||(l=qa(r,s),l!=null&&a.push(no(r,l,o)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var Vw=/\r\n?/g,Gw=/\u0000|\uFFFD/g;function nd(e){return(typeof e=="string"?e:""+e).replace(Vw,`
`).replace(Gw,"")}function Xo(e,t,r){if(t=nd(t),nd(e)!==t&&r)throw Error(Z(425))}function Il(){}var l0=null,c0=null;function u0(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var f0=typeof setTimeout=="function"?setTimeout:void 0,Kw=typeof clearTimeout=="function"?clearTimeout:void 0,id=typeof Promise=="function"?Promise:void 0,Xw=typeof queueMicrotask=="function"?queueMicrotask:typeof id<"u"?function(e){return id.resolve(null).then(e).catch(Yw)}:f0;function Yw(e){setTimeout(function(){throw e})}function pu(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Za(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Za(t)}function Jn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function sd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ys=Math.random().toString(36).slice(2),Qr="__reactFiber$"+Ys,io="__reactProps$"+Ys,kn="__reactContainer$"+Ys,h0="__reactEvents$"+Ys,qw="__reactListeners$"+Ys,Qw="__reactHandles$"+Ys;function Di(e){var t=e[Qr];if(t)return t;for(var r=e.parentNode;r;){if(t=r[kn]||r[Qr]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=sd(e);e!==null;){if(r=e[Qr])return r;e=sd(e)}return t}e=r,r=e.parentNode}return null}function ko(e){return e=e[Qr]||e[kn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function xs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Z(33))}function Ec(e){return e[io]||null}var d0=[],vs=-1;function di(e){return{current:e}}function Ke(e){0>vs||(e.current=d0[vs],d0[vs]=null,vs--)}function We(e,t){vs++,d0[vs]=e.current,e.current=t}var ii={},Wt=di(ii),sr=di(!1),Li=ii;function Ls(e,t){var r=e.type.contextTypes;if(!r)return ii;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function ar(e){return e=e.childContextTypes,e!=null}function Ll(){Ke(sr),Ke(Wt)}function ad(e,t,r){if(Wt.current!==ii)throw Error(Z(168));We(Wt,t),We(sr,r)}function om(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Z(108,jy(e)||"Unknown",i));return tt({},r,n)}function Ml(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ii,Li=Wt.current,We(Wt,e),We(sr,sr.current),!0}function od(e,t,r){var n=e.stateNode;if(!n)throw Error(Z(169));r?(e=om(e,t,Li),n.__reactInternalMemoizedMergedChildContext=e,Ke(sr),Ke(Wt),We(Wt,e)):Ke(sr),We(sr,r)}var mn=null,Sc=!1,mu=!1;function lm(e){mn===null?mn=[e]:mn.push(e)}function Jw(e){Sc=!0,lm(e)}function pi(){if(!mu&&mn!==null){mu=!0;var e=0,t=Ue;try{var r=mn;for(Ue=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}mn=null,Sc=!1}catch(i){throw mn!==null&&(mn=mn.slice(e+1)),F1(lf,pi),i}finally{Ue=t,mu=!1}}return null}var ys=[],ws=0,Bl=null,Ul=0,Cr=[],br=0,Mi=null,xn=1,vn="";function Ti(e,t){ys[ws++]=Ul,ys[ws++]=Bl,Bl=e,Ul=t}function cm(e,t,r){Cr[br++]=xn,Cr[br++]=vn,Cr[br++]=Mi,Mi=e;var n=xn;e=vn;var i=32-zr(n)-1;n&=~(1<<i),r+=1;var s=32-zr(t)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,xn=1<<32-zr(t)+i|r<<i|n,vn=s+e}else xn=1<<s|r<<i|n,vn=e}function xf(e){e.return!==null&&(Ti(e,1),cm(e,1,0))}function vf(e){for(;e===Bl;)Bl=ys[--ws],ys[ws]=null,Ul=ys[--ws],ys[ws]=null;for(;e===Mi;)Mi=Cr[--br],Cr[br]=null,vn=Cr[--br],Cr[br]=null,xn=Cr[--br],Cr[br]=null}var xr=null,gr=null,Ye=!1,Ur=null;function um(e,t){var r=Nr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function ld(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,xr=e,gr=Jn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,xr=e,gr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Mi!==null?{id:xn,overflow:vn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Nr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,xr=e,gr=null,!0):!1;default:return!1}}function p0(e){return(e.mode&1)!==0&&(e.flags&128)===0}function m0(e){if(Ye){var t=gr;if(t){var r=t;if(!ld(e,t)){if(p0(e))throw Error(Z(418));t=Jn(r.nextSibling);var n=xr;t&&ld(e,t)?um(n,r):(e.flags=e.flags&-4097|2,Ye=!1,xr=e)}}else{if(p0(e))throw Error(Z(418));e.flags=e.flags&-4097|2,Ye=!1,xr=e}}}function cd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;xr=e}function Yo(e){if(e!==xr)return!1;if(!Ye)return cd(e),Ye=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!u0(e.type,e.memoizedProps)),t&&(t=gr)){if(p0(e))throw fm(),Error(Z(418));for(;t;)um(e,t),t=Jn(t.nextSibling)}if(cd(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Z(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){gr=Jn(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}gr=null}}else gr=xr?Jn(e.stateNode.nextSibling):null;return!0}function fm(){for(var e=gr;e;)e=Jn(e.nextSibling)}function Ms(){gr=xr=null,Ye=!1}function yf(e){Ur===null?Ur=[e]:Ur.push(e)}var Zw=On.ReactCurrentBatchConfig;function ma(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Z(309));var n=r.stateNode}if(!n)throw Error(Z(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(Z(284));if(!r._owner)throw Error(Z(290,e))}return e}function qo(e,t){throw e=Object.prototype.toString.call(t),Error(Z(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ud(e){var t=e._init;return t(e._payload)}function hm(e){function t(x,w){if(e){var y=x.deletions;y===null?(x.deletions=[w],x.flags|=16):y.push(w)}}function r(x,w){if(!e)return null;for(;w!==null;)t(x,w),w=w.sibling;return null}function n(x,w){for(x=new Map;w!==null;)w.key!==null?x.set(w.key,w):x.set(w.index,w),w=w.sibling;return x}function i(x,w){return x=ri(x,w),x.index=0,x.sibling=null,x}function s(x,w,y){return x.index=y,e?(y=x.alternate,y!==null?(y=y.index,y<w?(x.flags|=2,w):y):(x.flags|=2,w)):(x.flags|=1048576,w)}function a(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,w,y,E){return w===null||w.tag!==6?(w=Tu(y,x.mode,E),w.return=x,w):(w=i(w,y),w.return=x,w)}function l(x,w,y,E){var C=y.type;return C===ds?u(x,w,y.props.children,E,y.key):w!==null&&(w.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Mn&&ud(C)===w.type)?(E=i(w,y.props),E.ref=ma(x,w,y),E.return=x,E):(E=Cl(y.type,y.key,y.props,null,x.mode,E),E.ref=ma(x,w,y),E.return=x,E)}function c(x,w,y,E){return w===null||w.tag!==4||w.stateNode.containerInfo!==y.containerInfo||w.stateNode.implementation!==y.implementation?(w=Eu(y,x.mode,E),w.return=x,w):(w=i(w,y.children||[]),w.return=x,w)}function u(x,w,y,E,C){return w===null||w.tag!==7?(w=Ri(y,x.mode,E,C),w.return=x,w):(w=i(w,y),w.return=x,w)}function h(x,w,y){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Tu(""+w,x.mode,y),w.return=x,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Bo:return y=Cl(w.type,w.key,w.props,null,x.mode,y),y.ref=ma(x,null,w),y.return=x,y;case hs:return w=Eu(w,x.mode,y),w.return=x,w;case Mn:var E=w._init;return h(x,E(w._payload),y)}if(Ta(w)||ua(w))return w=Ri(w,x.mode,y,null),w.return=x,w;qo(x,w)}return null}function d(x,w,y,E){var C=w!==null?w.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return C!==null?null:o(x,w,""+y,E);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Bo:return y.key===C?l(x,w,y,E):null;case hs:return y.key===C?c(x,w,y,E):null;case Mn:return C=y._init,d(x,w,C(y._payload),E)}if(Ta(y)||ua(y))return C!==null?null:u(x,w,y,E,null);qo(x,y)}return null}function m(x,w,y,E,C){if(typeof E=="string"&&E!==""||typeof E=="number")return x=x.get(y)||null,o(w,x,""+E,C);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Bo:return x=x.get(E.key===null?y:E.key)||null,l(w,x,E,C);case hs:return x=x.get(E.key===null?y:E.key)||null,c(w,x,E,C);case Mn:var R=E._init;return m(x,w,y,R(E._payload),C)}if(Ta(E)||ua(E))return x=x.get(y)||null,u(w,x,E,C,null);qo(w,E)}return null}function g(x,w,y,E){for(var C=null,R=null,D=w,F=w=0,N=null;D!==null&&F<y.length;F++){D.index>F?(N=D,D=null):N=D.sibling;var P=d(x,D,y[F],E);if(P===null){D===null&&(D=N);break}e&&D&&P.alternate===null&&t(x,D),w=s(P,w,F),R===null?C=P:R.sibling=P,R=P,D=N}if(F===y.length)return r(x,D),Ye&&Ti(x,F),C;if(D===null){for(;F<y.length;F++)D=h(x,y[F],E),D!==null&&(w=s(D,w,F),R===null?C=D:R.sibling=D,R=D);return Ye&&Ti(x,F),C}for(D=n(x,D);F<y.length;F++)N=m(D,x,F,y[F],E),N!==null&&(e&&N.alternate!==null&&D.delete(N.key===null?F:N.key),w=s(N,w,F),R===null?C=N:R.sibling=N,R=N);return e&&D.forEach(function(W){return t(x,W)}),Ye&&Ti(x,F),C}function p(x,w,y,E){var C=ua(y);if(typeof C!="function")throw Error(Z(150));if(y=C.call(y),y==null)throw Error(Z(151));for(var R=C=null,D=w,F=w=0,N=null,P=y.next();D!==null&&!P.done;F++,P=y.next()){D.index>F?(N=D,D=null):N=D.sibling;var W=d(x,D,P.value,E);if(W===null){D===null&&(D=N);break}e&&D&&W.alternate===null&&t(x,D),w=s(W,w,F),R===null?C=W:R.sibling=W,R=W,D=N}if(P.done)return r(x,D),Ye&&Ti(x,F),C;if(D===null){for(;!P.done;F++,P=y.next())P=h(x,P.value,E),P!==null&&(w=s(P,w,F),R===null?C=P:R.sibling=P,R=P);return Ye&&Ti(x,F),C}for(D=n(x,D);!P.done;F++,P=y.next())P=m(D,x,F,P.value,E),P!==null&&(e&&P.alternate!==null&&D.delete(P.key===null?F:P.key),w=s(P,w,F),R===null?C=P:R.sibling=P,R=P);return e&&D.forEach(function(G){return t(x,G)}),Ye&&Ti(x,F),C}function v(x,w,y,E){if(typeof y=="object"&&y!==null&&y.type===ds&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Bo:e:{for(var C=y.key,R=w;R!==null;){if(R.key===C){if(C=y.type,C===ds){if(R.tag===7){r(x,R.sibling),w=i(R,y.props.children),w.return=x,x=w;break e}}else if(R.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Mn&&ud(C)===R.type){r(x,R.sibling),w=i(R,y.props),w.ref=ma(x,R,y),w.return=x,x=w;break e}r(x,R);break}else t(x,R);R=R.sibling}y.type===ds?(w=Ri(y.props.children,x.mode,E,y.key),w.return=x,x=w):(E=Cl(y.type,y.key,y.props,null,x.mode,E),E.ref=ma(x,w,y),E.return=x,x=E)}return a(x);case hs:e:{for(R=y.key;w!==null;){if(w.key===R)if(w.tag===4&&w.stateNode.containerInfo===y.containerInfo&&w.stateNode.implementation===y.implementation){r(x,w.sibling),w=i(w,y.children||[]),w.return=x,x=w;break e}else{r(x,w);break}else t(x,w);w=w.sibling}w=Eu(y,x.mode,E),w.return=x,x=w}return a(x);case Mn:return R=y._init,v(x,w,R(y._payload),E)}if(Ta(y))return g(x,w,y,E);if(ua(y))return p(x,w,y,E);qo(x,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,w!==null&&w.tag===6?(r(x,w.sibling),w=i(w,y),w.return=x,x=w):(r(x,w),w=Tu(y,x.mode,E),w.return=x,x=w),a(x)):r(x,w)}return v}var Bs=hm(!0),dm=hm(!1),$l=di(null),Hl=null,_s=null,wf=null;function _f(){wf=_s=Hl=null}function Tf(e){var t=$l.current;Ke($l),e._currentValue=t}function g0(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function As(e,t){Hl=e,wf=_s=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(nr=!0),e.firstContext=null)}function Dr(e){var t=e._currentValue;if(wf!==e)if(e={context:e,memoizedValue:t,next:null},_s===null){if(Hl===null)throw Error(Z(308));_s=e,Hl.dependencies={lanes:0,firstContext:e}}else _s=_s.next=e;return t}var Oi=null;function Ef(e){Oi===null?Oi=[e]:Oi.push(e)}function pm(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,Ef(t)):(r.next=i.next,i.next=r),t.interleaved=r,Cn(e,n)}function Cn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Bn=!1;function Sf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function mm(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function yn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Zn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Oe&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Cn(e,r)}return i=n.interleaved,i===null?(t.next=t,Ef(n)):(t.next=i.next,i.next=t),n.interleaved=t,Cn(e,r)}function wl(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,cf(e,r)}}function fd(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function zl(e,t,r,n){var i=e.updateQueue;Bn=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;a=0,u=c=l=null,o=s;do{var d=o.lane,m=o.eventTime;if((n&d)===d){u!==null&&(u=u.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,p=o;switch(d=t,m=r,p.tag){case 1:if(g=p.payload,typeof g=="function"){h=g.call(m,h,d);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=p.payload,d=typeof g=="function"?g.call(m,h,d):g,d==null)break e;h=tt({},h,d);break e;case 2:Bn=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,d=i.effects,d===null?i.effects=[o]:d.push(o))}else m={eventTime:m,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=m,l=h):u=u.next=m,a|=d;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;d=o,o=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(u===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Ui|=a,e.lanes=a,e.memoizedState=h}}function hd(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Z(191,i));i.call(n)}}}var Co={},nn=di(Co),so=di(Co),ao=di(Co);function Pi(e){if(e===Co)throw Error(Z(174));return e}function kf(e,t){switch(We(ao,t),We(so,e),We(nn,Co),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:qu(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=qu(t,e)}Ke(nn),We(nn,t)}function Us(){Ke(nn),Ke(so),Ke(ao)}function gm(e){Pi(ao.current);var t=Pi(nn.current),r=qu(t,e.type);t!==r&&(We(so,e),We(nn,r))}function Cf(e){so.current===e&&(Ke(nn),Ke(so))}var Je=di(0);function Wl(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var gu=[];function bf(){for(var e=0;e<gu.length;e++)gu[e]._workInProgressVersionPrimary=null;gu.length=0}var _l=On.ReactCurrentDispatcher,xu=On.ReactCurrentBatchConfig,Bi=0,et=null,xt=null,wt=null,Vl=!1,Fa=!1,oo=0,e2=0;function Mt(){throw Error(Z(321))}function Nf(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Gr(e[r],t[r]))return!1;return!0}function Af(e,t,r,n,i,s){if(Bi=s,et=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,_l.current=e===null||e.memoizedState===null?i2:s2,e=r(n,i),Fa){s=0;do{if(Fa=!1,oo=0,25<=s)throw Error(Z(301));s+=1,wt=xt=null,t.updateQueue=null,_l.current=a2,e=r(n,i)}while(Fa)}if(_l.current=Gl,t=xt!==null&&xt.next!==null,Bi=0,wt=xt=et=null,Vl=!1,t)throw Error(Z(300));return e}function Df(){var e=oo!==0;return oo=0,e}function qr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wt===null?et.memoizedState=wt=e:wt=wt.next=e,wt}function Or(){if(xt===null){var e=et.alternate;e=e!==null?e.memoizedState:null}else e=xt.next;var t=wt===null?et.memoizedState:wt.next;if(t!==null)wt=t,xt=e;else{if(e===null)throw Error(Z(310));xt=e,e={memoizedState:xt.memoizedState,baseState:xt.baseState,baseQueue:xt.baseQueue,queue:xt.queue,next:null},wt===null?et.memoizedState=wt=e:wt=wt.next=e}return wt}function lo(e,t){return typeof t=="function"?t(e):t}function vu(e){var t=Or(),r=t.queue;if(r===null)throw Error(Z(311));r.lastRenderedReducer=e;var n=xt,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,c=s;do{var u=c.lane;if((Bi&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,a=n):l=l.next=h,et.lanes|=u,Ui|=u}c=c.next}while(c!==null&&c!==s);l===null?a=n:l.next=o,Gr(n,t.memoizedState)||(nr=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,et.lanes|=s,Ui|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function yu(e){var t=Or(),r=t.queue;if(r===null)throw Error(Z(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=e(s,a.action),a=a.next;while(a!==i);Gr(s,t.memoizedState)||(nr=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function xm(){}function vm(e,t){var r=et,n=Or(),i=t(),s=!Gr(n.memoizedState,i);if(s&&(n.memoizedState=i,nr=!0),n=n.queue,Of(_m.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||wt!==null&&wt.memoizedState.tag&1){if(r.flags|=2048,co(9,wm.bind(null,r,n,i,t),void 0,null),St===null)throw Error(Z(349));Bi&30||ym(r,t,i)}return i}function ym(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=et.updateQueue,t===null?(t={lastEffect:null,stores:null},et.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function wm(e,t,r,n){t.value=r,t.getSnapshot=n,Tm(t)&&Em(e)}function _m(e,t,r){return r(function(){Tm(t)&&Em(e)})}function Tm(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Gr(e,r)}catch{return!0}}function Em(e){var t=Cn(e,1);t!==null&&Wr(t,e,1,-1)}function dd(e){var t=qr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:lo,lastRenderedState:e},t.queue=e,e=e.dispatch=n2.bind(null,et,e),[t.memoizedState,e]}function co(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=et.updateQueue,t===null?(t={lastEffect:null,stores:null},et.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Sm(){return Or().memoizedState}function Tl(e,t,r,n){var i=qr();et.flags|=e,i.memoizedState=co(1|t,r,void 0,n===void 0?null:n)}function kc(e,t,r,n){var i=Or();n=n===void 0?null:n;var s=void 0;if(xt!==null){var a=xt.memoizedState;if(s=a.destroy,n!==null&&Nf(n,a.deps)){i.memoizedState=co(t,r,s,n);return}}et.flags|=e,i.memoizedState=co(1|t,r,s,n)}function pd(e,t){return Tl(8390656,8,e,t)}function Of(e,t){return kc(2048,8,e,t)}function km(e,t){return kc(4,2,e,t)}function Cm(e,t){return kc(4,4,e,t)}function bm(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Nm(e,t,r){return r=r!=null?r.concat([e]):null,kc(4,4,bm.bind(null,t,e),r)}function Pf(){}function Am(e,t){var r=Or();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Nf(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Dm(e,t){var r=Or();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Nf(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Om(e,t,r){return Bi&21?(Gr(r,t)||(r=I1(),et.lanes|=r,Ui|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,nr=!0),e.memoizedState=r)}function t2(e,t){var r=Ue;Ue=r!==0&&4>r?r:4,e(!0);var n=xu.transition;xu.transition={};try{e(!1),t()}finally{Ue=r,xu.transition=n}}function Pm(){return Or().memoizedState}function r2(e,t,r){var n=ti(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Fm(e))Rm(t,r);else if(r=pm(e,t,r,n),r!==null){var i=Yt();Wr(r,e,n,i),jm(r,t,n)}}function n2(e,t,r){var n=ti(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Fm(e))Rm(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,Gr(o,a)){var l=t.interleaved;l===null?(i.next=i,Ef(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}r=pm(e,t,i,n),r!==null&&(i=Yt(),Wr(r,e,n,i),jm(r,t,n))}}function Fm(e){var t=e.alternate;return e===et||t!==null&&t===et}function Rm(e,t){Fa=Vl=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function jm(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,cf(e,r)}}var Gl={readContext:Dr,useCallback:Mt,useContext:Mt,useEffect:Mt,useImperativeHandle:Mt,useInsertionEffect:Mt,useLayoutEffect:Mt,useMemo:Mt,useReducer:Mt,useRef:Mt,useState:Mt,useDebugValue:Mt,useDeferredValue:Mt,useTransition:Mt,useMutableSource:Mt,useSyncExternalStore:Mt,useId:Mt,unstable_isNewReconciler:!1},i2={readContext:Dr,useCallback:function(e,t){return qr().memoizedState=[e,t===void 0?null:t],e},useContext:Dr,useEffect:pd,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Tl(4194308,4,bm.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Tl(4194308,4,e,t)},useInsertionEffect:function(e,t){return Tl(4,2,e,t)},useMemo:function(e,t){var r=qr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=qr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=r2.bind(null,et,e),[n.memoizedState,e]},useRef:function(e){var t=qr();return e={current:e},t.memoizedState=e},useState:dd,useDebugValue:Pf,useDeferredValue:function(e){return qr().memoizedState=e},useTransition:function(){var e=dd(!1),t=e[0];return e=t2.bind(null,e[1]),qr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=et,i=qr();if(Ye){if(r===void 0)throw Error(Z(407));r=r()}else{if(r=t(),St===null)throw Error(Z(349));Bi&30||ym(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,pd(_m.bind(null,n,s,e),[e]),n.flags|=2048,co(9,wm.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=qr(),t=St.identifierPrefix;if(Ye){var r=vn,n=xn;r=(n&~(1<<32-zr(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=oo++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=e2++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},s2={readContext:Dr,useCallback:Am,useContext:Dr,useEffect:Of,useImperativeHandle:Nm,useInsertionEffect:km,useLayoutEffect:Cm,useMemo:Dm,useReducer:vu,useRef:Sm,useState:function(){return vu(lo)},useDebugValue:Pf,useDeferredValue:function(e){var t=Or();return Om(t,xt.memoizedState,e)},useTransition:function(){var e=vu(lo)[0],t=Or().memoizedState;return[e,t]},useMutableSource:xm,useSyncExternalStore:vm,useId:Pm,unstable_isNewReconciler:!1},a2={readContext:Dr,useCallback:Am,useContext:Dr,useEffect:Of,useImperativeHandle:Nm,useInsertionEffect:km,useLayoutEffect:Cm,useMemo:Dm,useReducer:yu,useRef:Sm,useState:function(){return yu(lo)},useDebugValue:Pf,useDeferredValue:function(e){var t=Or();return xt===null?t.memoizedState=e:Om(t,xt.memoizedState,e)},useTransition:function(){var e=yu(lo)[0],t=Or().memoizedState;return[e,t]},useMutableSource:xm,useSyncExternalStore:vm,useId:Pm,unstable_isNewReconciler:!1};function Lr(e,t){if(e&&e.defaultProps){t=tt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function x0(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:tt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Cc={isMounted:function(e){return(e=e._reactInternals)?Gi(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Yt(),i=ti(e),s=yn(n,i);s.payload=t,r!=null&&(s.callback=r),t=Zn(e,s,i),t!==null&&(Wr(t,e,i,n),wl(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Yt(),i=ti(e),s=yn(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Zn(e,s,i),t!==null&&(Wr(t,e,i,n),wl(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Yt(),n=ti(e),i=yn(r,n);i.tag=2,t!=null&&(i.callback=t),t=Zn(e,i,n),t!==null&&(Wr(t,e,n,r),wl(t,e,n))}};function md(e,t,r,n,i,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,a):t.prototype&&t.prototype.isPureReactComponent?!to(r,n)||!to(i,s):!0}function Im(e,t,r){var n=!1,i=ii,s=t.contextType;return typeof s=="object"&&s!==null?s=Dr(s):(i=ar(t)?Li:Wt.current,n=t.contextTypes,s=(n=n!=null)?Ls(e,i):ii),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Cc,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function gd(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Cc.enqueueReplaceState(t,t.state,null)}function v0(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},Sf(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Dr(s):(s=ar(t)?Li:Wt.current,i.context=Ls(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(x0(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Cc.enqueueReplaceState(i,i.state,null),zl(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function $s(e,t){try{var r="",n=t;do r+=Ry(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function wu(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function y0(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var o2=typeof WeakMap=="function"?WeakMap:Map;function Lm(e,t,r){r=yn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Xl||(Xl=!0,A0=n),y0(e,t)},r}function Mm(e,t,r){r=yn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){y0(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){y0(e,t),typeof n!="function"&&(ei===null?ei=new Set([this]):ei.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function xd(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new o2;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=_2.bind(null,e,t,r),t.then(e,e))}function vd(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function yd(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=yn(-1,1),t.tag=2,Zn(r,t,1))),r.lanes|=1),e)}var l2=On.ReactCurrentOwner,nr=!1;function Gt(e,t,r,n){t.child=e===null?dm(t,null,r,n):Bs(t,e.child,r,n)}function wd(e,t,r,n,i){r=r.render;var s=t.ref;return As(t,i),n=Af(e,t,r,n,s,i),r=Df(),e!==null&&!nr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,bn(e,t,i)):(Ye&&r&&xf(t),t.flags|=1,Gt(e,t,n,i),t.child)}function _d(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!Uf(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,Bm(e,t,s,n,i)):(e=Cl(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:to,r(a,n)&&e.ref===t.ref)return bn(e,t,i)}return t.flags|=1,e=ri(s,n),e.ref=t.ref,e.return=t,t.child=e}function Bm(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(to(s,n)&&e.ref===t.ref)if(nr=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(nr=!0);else return t.lanes=e.lanes,bn(e,t,i)}return w0(e,t,r,n,i)}function Um(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},We(Es,hr),hr|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,We(Es,hr),hr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,We(Es,hr),hr|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,We(Es,hr),hr|=n;return Gt(e,t,i,r),t.child}function $m(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function w0(e,t,r,n,i){var s=ar(r)?Li:Wt.current;return s=Ls(t,s),As(t,i),r=Af(e,t,r,n,s,i),n=Df(),e!==null&&!nr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,bn(e,t,i)):(Ye&&n&&xf(t),t.flags|=1,Gt(e,t,r,i),t.child)}function Td(e,t,r,n,i){if(ar(r)){var s=!0;Ml(t)}else s=!1;if(As(t,i),t.stateNode===null)El(e,t),Im(t,r,n),v0(t,r,n,i),n=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=Dr(c):(c=ar(r)?Li:Wt.current,c=Ls(t,c));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&gd(t,a,n,c),Bn=!1;var d=t.memoizedState;a.state=d,zl(t,n,a,i),l=t.memoizedState,o!==n||d!==l||sr.current||Bn?(typeof u=="function"&&(x0(t,r,u,n),l=t.memoizedState),(o=Bn||md(t,r,o,n,d,l,c))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,mm(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Lr(t.type,o),a.props=c,h=t.pendingProps,d=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Dr(l):(l=ar(r)?Li:Wt.current,l=Ls(t,l));var m=r.getDerivedStateFromProps;(u=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||d!==l)&&gd(t,a,n,l),Bn=!1,d=t.memoizedState,a.state=d,zl(t,n,a,i);var g=t.memoizedState;o!==h||d!==g||sr.current||Bn?(typeof m=="function"&&(x0(t,r,m,n),g=t.memoizedState),(c=Bn||md(t,r,c,n,d,g,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,g,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,g,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),a.props=n,a.state=g,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return _0(e,t,r,n,s,i)}function _0(e,t,r,n,i,s){$m(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return i&&od(t,r,!1),bn(e,t,s);n=t.stateNode,l2.current=t;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=Bs(t,e.child,null,s),t.child=Bs(t,null,o,s)):Gt(e,t,o,s),t.memoizedState=n.state,i&&od(t,r,!0),t.child}function Hm(e){var t=e.stateNode;t.pendingContext?ad(e,t.pendingContext,t.pendingContext!==t.context):t.context&&ad(e,t.context,!1),kf(e,t.containerInfo)}function Ed(e,t,r,n,i){return Ms(),yf(i),t.flags|=256,Gt(e,t,r,n),t.child}var T0={dehydrated:null,treeContext:null,retryLane:0};function E0(e){return{baseLanes:e,cachePool:null,transitions:null}}function zm(e,t,r){var n=t.pendingProps,i=Je.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),We(Je,i&1),e===null)return m0(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,s?(n=t.mode,s=t.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Ac(a,n,0,null),e=Ri(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=E0(r),t.memoizedState=T0,e):Ff(t,a));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return c2(e,t,a,n,o,i,r);if(s){s=n.fallback,a=t.mode,i=e.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=ri(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=ri(o,s):(s=Ri(s,a,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,a=e.child.memoizedState,a=a===null?E0(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~r,t.memoizedState=T0,n}return s=e.child,e=s.sibling,n=ri(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Ff(e,t){return t=Ac({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Qo(e,t,r,n){return n!==null&&yf(n),Bs(t,e.child,null,r),e=Ff(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function c2(e,t,r,n,i,s,a){if(r)return t.flags&256?(t.flags&=-257,n=wu(Error(Z(422))),Qo(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=Ac({mode:"visible",children:n.children},i,0,null),s=Ri(s,i,a,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Bs(t,e.child,null,a),t.child.memoizedState=E0(a),t.memoizedState=T0,s);if(!(t.mode&1))return Qo(e,t,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(Z(419)),n=wu(s,n,void 0),Qo(e,t,a,n)}if(o=(a&e.childLanes)!==0,nr||o){if(n=St,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Cn(e,i),Wr(n,e,i,-1))}return Bf(),n=wu(Error(Z(421))),Qo(e,t,a,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=T2.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,gr=Jn(i.nextSibling),xr=t,Ye=!0,Ur=null,e!==null&&(Cr[br++]=xn,Cr[br++]=vn,Cr[br++]=Mi,xn=e.id,vn=e.overflow,Mi=t),t=Ff(t,n.children),t.flags|=4096,t)}function Sd(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),g0(e.return,t,r)}function _u(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function Wm(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Gt(e,t,n.children,r),n=Je.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Sd(e,r,t);else if(e.tag===19)Sd(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(We(Je,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&Wl(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),_u(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Wl(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}_u(t,!0,r,null,s);break;case"together":_u(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function El(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function bn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ui|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Z(153));if(t.child!==null){for(e=t.child,r=ri(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ri(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function u2(e,t,r){switch(t.tag){case 3:Hm(t),Ms();break;case 5:gm(t);break;case 1:ar(t.type)&&Ml(t);break;case 4:kf(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;We($l,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(We(Je,Je.current&1),t.flags|=128,null):r&t.child.childLanes?zm(e,t,r):(We(Je,Je.current&1),e=bn(e,t,r),e!==null?e.sibling:null);We(Je,Je.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Wm(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),We(Je,Je.current),n)break;return null;case 22:case 23:return t.lanes=0,Um(e,t,r)}return bn(e,t,r)}var Vm,S0,Gm,Km;Vm=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};S0=function(){};Gm=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Pi(nn.current);var s=null;switch(r){case"input":i=Gu(e,i),n=Gu(e,n),s=[];break;case"select":i=tt({},i,{value:void 0}),n=tt({},n,{value:void 0}),s=[];break;case"textarea":i=Yu(e,i),n=Yu(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Il)}Qu(r,n);var a;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Xa.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Xa.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ge("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};Km=function(e,t,r,n){r!==n&&(t.flags|=4)};function ga(e,t){if(!Ye)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Bt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function f2(e,t,r){var n=t.pendingProps;switch(vf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bt(t),null;case 1:return ar(t.type)&&Ll(),Bt(t),null;case 3:return n=t.stateNode,Us(),Ke(sr),Ke(Wt),bf(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Yo(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ur!==null&&(P0(Ur),Ur=null))),S0(e,t),Bt(t),null;case 5:Cf(t);var i=Pi(ao.current);if(r=t.type,e!==null&&t.stateNode!=null)Gm(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Z(166));return Bt(t),null}if(e=Pi(nn.current),Yo(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Qr]=t,n[io]=s,e=(t.mode&1)!==0,r){case"dialog":Ge("cancel",n),Ge("close",n);break;case"iframe":case"object":case"embed":Ge("load",n);break;case"video":case"audio":for(i=0;i<Sa.length;i++)Ge(Sa[i],n);break;case"source":Ge("error",n);break;case"img":case"image":case"link":Ge("error",n),Ge("load",n);break;case"details":Ge("toggle",n);break;case"input":Fh(n,s),Ge("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Ge("invalid",n);break;case"textarea":jh(n,s),Ge("invalid",n)}Qu(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&Xo(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Xo(n.textContent,o,e),i=["children",""+o]):Xa.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Ge("scroll",n)}switch(r){case"input":Uo(n),Rh(n,s,!0);break;case"textarea":Uo(n),Ih(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Il)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=_1(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[Qr]=t,e[io]=n,Vm(e,t,!1,!1),t.stateNode=e;e:{switch(a=Ju(r,n),r){case"dialog":Ge("cancel",e),Ge("close",e),i=n;break;case"iframe":case"object":case"embed":Ge("load",e),i=n;break;case"video":case"audio":for(i=0;i<Sa.length;i++)Ge(Sa[i],e);i=n;break;case"source":Ge("error",e),i=n;break;case"img":case"image":case"link":Ge("error",e),Ge("load",e),i=n;break;case"details":Ge("toggle",e),i=n;break;case"input":Fh(e,n),i=Gu(e,n),Ge("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=tt({},n,{value:void 0}),Ge("invalid",e);break;case"textarea":jh(e,n),i=Yu(e,n),Ge("invalid",e);break;default:i=n}Qu(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?S1(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&T1(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Ya(e,l):typeof l=="number"&&Ya(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Xa.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Ge("scroll",e):l!=null&&rf(e,s,l,a))}switch(r){case"input":Uo(e),Rh(e,n,!1);break;case"textarea":Uo(e),Ih(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ni(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?ks(e,!!n.multiple,s,!1):n.defaultValue!=null&&ks(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=Il)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Bt(t),null;case 6:if(e&&t.stateNode!=null)Km(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Z(166));if(r=Pi(ao.current),Pi(nn.current),Yo(t)){if(n=t.stateNode,r=t.memoizedProps,n[Qr]=t,(s=n.nodeValue!==r)&&(e=xr,e!==null))switch(e.tag){case 3:Xo(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Xo(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Qr]=t,t.stateNode=n}return Bt(t),null;case 13:if(Ke(Je),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ye&&gr!==null&&t.mode&1&&!(t.flags&128))fm(),Ms(),t.flags|=98560,s=!1;else if(s=Yo(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(Z(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Z(317));s[Qr]=t}else Ms(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Bt(t),s=!1}else Ur!==null&&(P0(Ur),Ur=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Je.current&1?vt===0&&(vt=3):Bf())),t.updateQueue!==null&&(t.flags|=4),Bt(t),null);case 4:return Us(),S0(e,t),e===null&&ro(t.stateNode.containerInfo),Bt(t),null;case 10:return Tf(t.type._context),Bt(t),null;case 17:return ar(t.type)&&Ll(),Bt(t),null;case 19:if(Ke(Je),s=t.memoizedState,s===null)return Bt(t),null;if(n=(t.flags&128)!==0,a=s.rendering,a===null)if(n)ga(s,!1);else{if(vt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Wl(e),a!==null){for(t.flags|=128,ga(s,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return We(Je,Je.current&1|2),t.child}e=e.sibling}s.tail!==null&&ot()>Hs&&(t.flags|=128,n=!0,ga(s,!1),t.lanes=4194304)}else{if(!n)if(e=Wl(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),ga(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Ye)return Bt(t),null}else 2*ot()-s.renderingStartTime>Hs&&r!==1073741824&&(t.flags|=128,n=!0,ga(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(r=s.last,r!==null?r.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=ot(),t.sibling=null,r=Je.current,We(Je,n?r&1|2:r&1),t):(Bt(t),null);case 22:case 23:return Mf(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?hr&1073741824&&(Bt(t),t.subtreeFlags&6&&(t.flags|=8192)):Bt(t),null;case 24:return null;case 25:return null}throw Error(Z(156,t.tag))}function h2(e,t){switch(vf(t),t.tag){case 1:return ar(t.type)&&Ll(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Us(),Ke(sr),Ke(Wt),bf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Cf(t),null;case 13:if(Ke(Je),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Z(340));Ms()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ke(Je),null;case 4:return Us(),null;case 10:return Tf(t.type._context),null;case 22:case 23:return Mf(),null;case 24:return null;default:return null}}var Jo=!1,$t=!1,d2=typeof WeakSet=="function"?WeakSet:Set,he=null;function Ts(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){rt(e,t,n)}else r.current=null}function k0(e,t,r){try{r()}catch(n){rt(e,t,n)}}var kd=!1;function p2(e,t){if(l0=Fl,e=J1(),gf(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,u=0,h=e,d=null;t:for(;;){for(var m;h!==r||i!==0&&h.nodeType!==3||(o=a+i),h!==s||n!==0&&h.nodeType!==3||(l=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(m=h.firstChild)!==null;)d=h,h=m;for(;;){if(h===e)break t;if(d===r&&++c===i&&(o=a),d===s&&++u===n&&(l=a),(m=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=m}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(c0={focusedElem:e,selectionRange:r},Fl=!1,he=t;he!==null;)if(t=he,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,he=e;else for(;he!==null;){t=he;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var p=g.memoizedProps,v=g.memoizedState,x=t.stateNode,w=x.getSnapshotBeforeUpdate(t.elementType===t.type?p:Lr(t.type,p),v);x.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Z(163))}}catch(E){rt(t,t.return,E)}if(e=t.sibling,e!==null){e.return=t.return,he=e;break}he=t.return}return g=kd,kd=!1,g}function Ra(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&k0(t,r,s)}i=i.next}while(i!==n)}}function bc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function C0(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Xm(e){var t=e.alternate;t!==null&&(e.alternate=null,Xm(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Qr],delete t[io],delete t[h0],delete t[qw],delete t[Qw])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Ym(e){return e.tag===5||e.tag===3||e.tag===4}function Cd(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Ym(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function b0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Il));else if(n!==4&&(e=e.child,e!==null))for(b0(e,t,r),e=e.sibling;e!==null;)b0(e,t,r),e=e.sibling}function N0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(N0(e,t,r),e=e.sibling;e!==null;)N0(e,t,r),e=e.sibling}var Nt=null,Mr=!1;function Rn(e,t,r){for(r=r.child;r!==null;)qm(e,t,r),r=r.sibling}function qm(e,t,r){if(rn&&typeof rn.onCommitFiberUnmount=="function")try{rn.onCommitFiberUnmount(yc,r)}catch{}switch(r.tag){case 5:$t||Ts(r,t);case 6:var n=Nt,i=Mr;Nt=null,Rn(e,t,r),Nt=n,Mr=i,Nt!==null&&(Mr?(e=Nt,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Nt.removeChild(r.stateNode));break;case 18:Nt!==null&&(Mr?(e=Nt,r=r.stateNode,e.nodeType===8?pu(e.parentNode,r):e.nodeType===1&&pu(e,r),Za(e)):pu(Nt,r.stateNode));break;case 4:n=Nt,i=Mr,Nt=r.stateNode.containerInfo,Mr=!0,Rn(e,t,r),Nt=n,Mr=i;break;case 0:case 11:case 14:case 15:if(!$t&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&k0(r,t,a),i=i.next}while(i!==n)}Rn(e,t,r);break;case 1:if(!$t&&(Ts(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){rt(r,t,o)}Rn(e,t,r);break;case 21:Rn(e,t,r);break;case 22:r.mode&1?($t=(n=$t)||r.memoizedState!==null,Rn(e,t,r),$t=n):Rn(e,t,r);break;default:Rn(e,t,r)}}function bd(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new d2),t.forEach(function(n){var i=E2.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Fr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:Nt=o.stateNode,Mr=!1;break e;case 3:Nt=o.stateNode.containerInfo,Mr=!0;break e;case 4:Nt=o.stateNode.containerInfo,Mr=!0;break e}o=o.return}if(Nt===null)throw Error(Z(160));qm(s,a,i),Nt=null,Mr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){rt(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Qm(t,e),t=t.sibling}function Qm(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Fr(t,e),Kr(e),n&4){try{Ra(3,e,e.return),bc(3,e)}catch(p){rt(e,e.return,p)}try{Ra(5,e,e.return)}catch(p){rt(e,e.return,p)}}break;case 1:Fr(t,e),Kr(e),n&512&&r!==null&&Ts(r,r.return);break;case 5:if(Fr(t,e),Kr(e),n&512&&r!==null&&Ts(r,r.return),e.flags&32){var i=e.stateNode;try{Ya(i,"")}catch(p){rt(e,e.return,p)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,a=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&y1(i,s),Ju(o,a);var c=Ju(o,s);for(a=0;a<l.length;a+=2){var u=l[a],h=l[a+1];u==="style"?S1(i,h):u==="dangerouslySetInnerHTML"?T1(i,h):u==="children"?Ya(i,h):rf(i,u,h,c)}switch(o){case"input":Ku(i,s);break;case"textarea":w1(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?ks(i,!!s.multiple,m,!1):d!==!!s.multiple&&(s.defaultValue!=null?ks(i,!!s.multiple,s.defaultValue,!0):ks(i,!!s.multiple,s.multiple?[]:"",!1))}i[io]=s}catch(p){rt(e,e.return,p)}}break;case 6:if(Fr(t,e),Kr(e),n&4){if(e.stateNode===null)throw Error(Z(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(p){rt(e,e.return,p)}}break;case 3:if(Fr(t,e),Kr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Za(t.containerInfo)}catch(p){rt(e,e.return,p)}break;case 4:Fr(t,e),Kr(e);break;case 13:Fr(t,e),Kr(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(If=ot())),n&4&&bd(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?($t=(c=$t)||u,Fr(t,e),$t=c):Fr(t,e),Kr(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(he=e,u=e.child;u!==null;){for(h=he=u;he!==null;){switch(d=he,m=d.child,d.tag){case 0:case 11:case 14:case 15:Ra(4,d,d.return);break;case 1:Ts(d,d.return);var g=d.stateNode;if(typeof g.componentWillUnmount=="function"){n=d,r=d.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(p){rt(n,r,p)}}break;case 5:Ts(d,d.return);break;case 22:if(d.memoizedState!==null){Ad(h);continue}}m!==null?(m.return=d,he=m):Ad(h)}u=u.sibling}e:for(u=null,h=e;;){if(h.tag===5){if(u===null){u=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=E1("display",a))}catch(p){rt(e,e.return,p)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(p){rt(e,e.return,p)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Fr(t,e),Kr(e),n&4&&bd(e);break;case 21:break;default:Fr(t,e),Kr(e)}}function Kr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Ym(r)){var n=r;break e}r=r.return}throw Error(Z(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Ya(i,""),n.flags&=-33);var s=Cd(e);N0(e,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=Cd(e);b0(e,o,a);break;default:throw Error(Z(161))}}catch(l){rt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function m2(e,t,r){he=e,Jm(e)}function Jm(e,t,r){for(var n=(e.mode&1)!==0;he!==null;){var i=he,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||Jo;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||$t;o=Jo;var c=$t;if(Jo=a,($t=l)&&!c)for(he=i;he!==null;)a=he,l=a.child,a.tag===22&&a.memoizedState!==null?Dd(i):l!==null?(l.return=a,he=l):Dd(i);for(;s!==null;)he=s,Jm(s),s=s.sibling;he=i,Jo=o,$t=c}Nd(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,he=s):Nd(e)}}function Nd(e){for(;he!==null;){var t=he;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:$t||bc(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!$t)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Lr(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&hd(t,s,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}hd(t,a,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Za(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Z(163))}$t||t.flags&512&&C0(t)}catch(d){rt(t,t.return,d)}}if(t===e){he=null;break}if(r=t.sibling,r!==null){r.return=t.return,he=r;break}he=t.return}}function Ad(e){for(;he!==null;){var t=he;if(t===e){he=null;break}var r=t.sibling;if(r!==null){r.return=t.return,he=r;break}he=t.return}}function Dd(e){for(;he!==null;){var t=he;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{bc(4,t)}catch(l){rt(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(l){rt(t,i,l)}}var s=t.return;try{C0(t)}catch(l){rt(t,s,l)}break;case 5:var a=t.return;try{C0(t)}catch(l){rt(t,a,l)}}}catch(l){rt(t,t.return,l)}if(t===e){he=null;break}var o=t.sibling;if(o!==null){o.return=t.return,he=o;break}he=t.return}}var g2=Math.ceil,Kl=On.ReactCurrentDispatcher,Rf=On.ReactCurrentOwner,Ar=On.ReactCurrentBatchConfig,Oe=0,St=null,ht=null,Ft=0,hr=0,Es=di(0),vt=0,uo=null,Ui=0,Nc=0,jf=0,ja=null,tr=null,If=0,Hs=1/0,dn=null,Xl=!1,A0=null,ei=null,Zo=!1,Vn=null,Yl=0,Ia=0,D0=null,Sl=-1,kl=0;function Yt(){return Oe&6?ot():Sl!==-1?Sl:Sl=ot()}function ti(e){return e.mode&1?Oe&2&&Ft!==0?Ft&-Ft:Zw.transition!==null?(kl===0&&(kl=I1()),kl):(e=Ue,e!==0||(e=window.event,e=e===void 0?16:z1(e.type)),e):1}function Wr(e,t,r,n){if(50<Ia)throw Ia=0,D0=null,Error(Z(185));Eo(e,r,n),(!(Oe&2)||e!==St)&&(e===St&&(!(Oe&2)&&(Nc|=r),vt===4&&Hn(e,Ft)),or(e,n),r===1&&Oe===0&&!(t.mode&1)&&(Hs=ot()+500,Sc&&pi()))}function or(e,t){var r=e.callbackNode;Zy(e,t);var n=Pl(e,e===St?Ft:0);if(n===0)r!==null&&Bh(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Bh(r),t===1)e.tag===0?Jw(Od.bind(null,e)):lm(Od.bind(null,e)),Xw(function(){!(Oe&6)&&pi()}),r=null;else{switch(L1(n)){case 1:r=lf;break;case 4:r=R1;break;case 16:r=Ol;break;case 536870912:r=j1;break;default:r=Ol}r=ag(r,Zm.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Zm(e,t){if(Sl=-1,kl=0,Oe&6)throw Error(Z(327));var r=e.callbackNode;if(Ds()&&e.callbackNode!==r)return null;var n=Pl(e,e===St?Ft:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=ql(e,n);else{t=n;var i=Oe;Oe|=2;var s=tg();(St!==e||Ft!==t)&&(dn=null,Hs=ot()+500,Fi(e,t));do try{y2();break}catch(o){eg(e,o)}while(!0);_f(),Kl.current=s,Oe=i,ht!==null?t=0:(St=null,Ft=0,t=vt)}if(t!==0){if(t===2&&(i=n0(e),i!==0&&(n=i,t=O0(e,i))),t===1)throw r=uo,Fi(e,0),Hn(e,n),or(e,ot()),r;if(t===6)Hn(e,n);else{if(i=e.current.alternate,!(n&30)&&!x2(i)&&(t=ql(e,n),t===2&&(s=n0(e),s!==0&&(n=s,t=O0(e,s))),t===1))throw r=uo,Fi(e,0),Hn(e,n),or(e,ot()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Z(345));case 2:Ei(e,tr,dn);break;case 3:if(Hn(e,n),(n&130023424)===n&&(t=If+500-ot(),10<t)){if(Pl(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Yt(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=f0(Ei.bind(null,e,tr,dn),t);break}Ei(e,tr,dn);break;case 4:if(Hn(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var a=31-zr(n);s=1<<a,a=t[a],a>i&&(i=a),n&=~s}if(n=i,n=ot()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*g2(n/1960))-n,10<n){e.timeoutHandle=f0(Ei.bind(null,e,tr,dn),n);break}Ei(e,tr,dn);break;case 5:Ei(e,tr,dn);break;default:throw Error(Z(329))}}}return or(e,ot()),e.callbackNode===r?Zm.bind(null,e):null}function O0(e,t){var r=ja;return e.current.memoizedState.isDehydrated&&(Fi(e,t).flags|=256),e=ql(e,t),e!==2&&(t=tr,tr=r,t!==null&&P0(t)),e}function P0(e){tr===null?tr=e:tr.push.apply(tr,e)}function x2(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Gr(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Hn(e,t){for(t&=~jf,t&=~Nc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-zr(t),n=1<<r;e[r]=-1,t&=~n}}function Od(e){if(Oe&6)throw Error(Z(327));Ds();var t=Pl(e,0);if(!(t&1))return or(e,ot()),null;var r=ql(e,t);if(e.tag!==0&&r===2){var n=n0(e);n!==0&&(t=n,r=O0(e,n))}if(r===1)throw r=uo,Fi(e,0),Hn(e,t),or(e,ot()),r;if(r===6)throw Error(Z(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ei(e,tr,dn),or(e,ot()),null}function Lf(e,t){var r=Oe;Oe|=1;try{return e(t)}finally{Oe=r,Oe===0&&(Hs=ot()+500,Sc&&pi())}}function $i(e){Vn!==null&&Vn.tag===0&&!(Oe&6)&&Ds();var t=Oe;Oe|=1;var r=Ar.transition,n=Ue;try{if(Ar.transition=null,Ue=1,e)return e()}finally{Ue=n,Ar.transition=r,Oe=t,!(Oe&6)&&pi()}}function Mf(){hr=Es.current,Ke(Es)}function Fi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Kw(r)),ht!==null)for(r=ht.return;r!==null;){var n=r;switch(vf(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ll();break;case 3:Us(),Ke(sr),Ke(Wt),bf();break;case 5:Cf(n);break;case 4:Us();break;case 13:Ke(Je);break;case 19:Ke(Je);break;case 10:Tf(n.type._context);break;case 22:case 23:Mf()}r=r.return}if(St=e,ht=e=ri(e.current,null),Ft=hr=t,vt=0,uo=null,jf=Nc=Ui=0,tr=ja=null,Oi!==null){for(t=0;t<Oi.length;t++)if(r=Oi[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}Oi=null}return e}function eg(e,t){do{var r=ht;try{if(_f(),_l.current=Gl,Vl){for(var n=et.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Vl=!1}if(Bi=0,wt=xt=et=null,Fa=!1,oo=0,Rf.current=null,r===null||r.return===null){vt=1,uo=t,ht=null;break}e:{var s=e,a=r.return,o=r,l=t;if(t=Ft,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=vd(a);if(m!==null){m.flags&=-257,yd(m,a,o,s,t),m.mode&1&&xd(s,c,t),t=m,l=c;var g=t.updateQueue;if(g===null){var p=new Set;p.add(l),t.updateQueue=p}else g.add(l);break e}else{if(!(t&1)){xd(s,c,t),Bf();break e}l=Error(Z(426))}}else if(Ye&&o.mode&1){var v=vd(a);if(v!==null){!(v.flags&65536)&&(v.flags|=256),yd(v,a,o,s,t),yf($s(l,o));break e}}s=l=$s(l,o),vt!==4&&(vt=2),ja===null?ja=[s]:ja.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var x=Lm(s,l,t);fd(s,x);break e;case 1:o=l;var w=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(ei===null||!ei.has(y)))){s.flags|=65536,t&=-t,s.lanes|=t;var E=Mm(s,o,t);fd(s,E);break e}}s=s.return}while(s!==null)}ng(r)}catch(C){t=C,ht===r&&r!==null&&(ht=r=r.return);continue}break}while(!0)}function tg(){var e=Kl.current;return Kl.current=Gl,e===null?Gl:e}function Bf(){(vt===0||vt===3||vt===2)&&(vt=4),St===null||!(Ui&268435455)&&!(Nc&268435455)||Hn(St,Ft)}function ql(e,t){var r=Oe;Oe|=2;var n=tg();(St!==e||Ft!==t)&&(dn=null,Fi(e,t));do try{v2();break}catch(i){eg(e,i)}while(!0);if(_f(),Oe=r,Kl.current=n,ht!==null)throw Error(Z(261));return St=null,Ft=0,vt}function v2(){for(;ht!==null;)rg(ht)}function y2(){for(;ht!==null&&!Wy();)rg(ht)}function rg(e){var t=sg(e.alternate,e,hr);e.memoizedProps=e.pendingProps,t===null?ng(e):ht=t,Rf.current=null}function ng(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=h2(r,t),r!==null){r.flags&=32767,ht=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{vt=6,ht=null;return}}else if(r=f2(r,t,hr),r!==null){ht=r;return}if(t=t.sibling,t!==null){ht=t;return}ht=t=e}while(t!==null);vt===0&&(vt=5)}function Ei(e,t,r){var n=Ue,i=Ar.transition;try{Ar.transition=null,Ue=1,w2(e,t,r,n)}finally{Ar.transition=i,Ue=n}return null}function w2(e,t,r,n){do Ds();while(Vn!==null);if(Oe&6)throw Error(Z(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Z(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(ew(e,s),e===St&&(ht=St=null,Ft=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Zo||(Zo=!0,ag(Ol,function(){return Ds(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Ar.transition,Ar.transition=null;var a=Ue;Ue=1;var o=Oe;Oe|=4,Rf.current=null,p2(e,r),Qm(r,e),Uw(c0),Fl=!!l0,c0=l0=null,e.current=r,m2(r),Vy(),Oe=o,Ue=a,Ar.transition=s}else e.current=r;if(Zo&&(Zo=!1,Vn=e,Yl=i),s=e.pendingLanes,s===0&&(ei=null),Xy(r.stateNode),or(e,ot()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Xl)throw Xl=!1,e=A0,A0=null,e;return Yl&1&&e.tag!==0&&Ds(),s=e.pendingLanes,s&1?e===D0?Ia++:(Ia=0,D0=e):Ia=0,pi(),null}function Ds(){if(Vn!==null){var e=L1(Yl),t=Ar.transition,r=Ue;try{if(Ar.transition=null,Ue=16>e?16:e,Vn===null)var n=!1;else{if(e=Vn,Vn=null,Yl=0,Oe&6)throw Error(Z(331));var i=Oe;for(Oe|=4,he=e.current;he!==null;){var s=he,a=s.child;if(he.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(he=c;he!==null;){var u=he;switch(u.tag){case 0:case 11:case 15:Ra(8,u,s)}var h=u.child;if(h!==null)h.return=u,he=h;else for(;he!==null;){u=he;var d=u.sibling,m=u.return;if(Xm(u),u===c){he=null;break}if(d!==null){d.return=m,he=d;break}he=m}}}var g=s.alternate;if(g!==null){var p=g.child;if(p!==null){g.child=null;do{var v=p.sibling;p.sibling=null,p=v}while(p!==null)}}he=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,he=a;else e:for(;he!==null;){if(s=he,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ra(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,he=x;break e}he=s.return}}var w=e.current;for(he=w;he!==null;){a=he;var y=a.child;if(a.subtreeFlags&2064&&y!==null)y.return=a,he=y;else e:for(a=w;he!==null;){if(o=he,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:bc(9,o)}}catch(C){rt(o,o.return,C)}if(o===a){he=null;break e}var E=o.sibling;if(E!==null){E.return=o.return,he=E;break e}he=o.return}}if(Oe=i,pi(),rn&&typeof rn.onPostCommitFiberRoot=="function")try{rn.onPostCommitFiberRoot(yc,e)}catch{}n=!0}return n}finally{Ue=r,Ar.transition=t}}return!1}function Pd(e,t,r){t=$s(r,t),t=Lm(e,t,1),e=Zn(e,t,1),t=Yt(),e!==null&&(Eo(e,1,t),or(e,t))}function rt(e,t,r){if(e.tag===3)Pd(e,e,r);else for(;t!==null;){if(t.tag===3){Pd(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ei===null||!ei.has(n))){e=$s(r,e),e=Mm(t,e,1),t=Zn(t,e,1),e=Yt(),t!==null&&(Eo(t,1,e),or(t,e));break}}t=t.return}}function _2(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Yt(),e.pingedLanes|=e.suspendedLanes&r,St===e&&(Ft&r)===r&&(vt===4||vt===3&&(Ft&130023424)===Ft&&500>ot()-If?Fi(e,0):jf|=r),or(e,t)}function ig(e,t){t===0&&(e.mode&1?(t=zo,zo<<=1,!(zo&130023424)&&(zo=4194304)):t=1);var r=Yt();e=Cn(e,t),e!==null&&(Eo(e,t,r),or(e,r))}function T2(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),ig(e,r)}function E2(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Z(314))}n!==null&&n.delete(t),ig(e,r)}var sg;sg=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||sr.current)nr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return nr=!1,u2(e,t,r);nr=!!(e.flags&131072)}else nr=!1,Ye&&t.flags&1048576&&cm(t,Ul,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;El(e,t),e=t.pendingProps;var i=Ls(t,Wt.current);As(t,r),i=Af(null,t,n,e,i,r);var s=Df();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ar(n)?(s=!0,Ml(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Sf(t),i.updater=Cc,t.stateNode=i,i._reactInternals=t,v0(t,n,e,r),t=_0(null,t,n,!0,s,r)):(t.tag=0,Ye&&s&&xf(t),Gt(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(El(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=k2(n),e=Lr(n,e),i){case 0:t=w0(null,t,n,e,r);break e;case 1:t=Td(null,t,n,e,r);break e;case 11:t=wd(null,t,n,e,r);break e;case 14:t=_d(null,t,n,Lr(n.type,e),r);break e}throw Error(Z(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Lr(n,i),w0(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Lr(n,i),Td(e,t,n,i,r);case 3:e:{if(Hm(t),e===null)throw Error(Z(387));n=t.pendingProps,s=t.memoizedState,i=s.element,mm(e,t),zl(t,n,null,r);var a=t.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=$s(Error(Z(423)),t),t=Ed(e,t,n,r,i);break e}else if(n!==i){i=$s(Error(Z(424)),t),t=Ed(e,t,n,r,i);break e}else for(gr=Jn(t.stateNode.containerInfo.firstChild),xr=t,Ye=!0,Ur=null,r=dm(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ms(),n===i){t=bn(e,t,r);break e}Gt(e,t,n,r)}t=t.child}return t;case 5:return gm(t),e===null&&m0(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,a=i.children,u0(n,i)?a=null:s!==null&&u0(n,s)&&(t.flags|=32),$m(e,t),Gt(e,t,a,r),t.child;case 6:return e===null&&m0(t),null;case 13:return zm(e,t,r);case 4:return kf(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Bs(t,null,n,r):Gt(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Lr(n,i),wd(e,t,n,i,r);case 7:return Gt(e,t,t.pendingProps,r),t.child;case 8:return Gt(e,t,t.pendingProps.children,r),t.child;case 12:return Gt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,We($l,n._currentValue),n._currentValue=a,s!==null)if(Gr(s.value,a)){if(s.children===i.children&&!sr.current){t=bn(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=yn(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),g0(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Z(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),g0(a,r,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Gt(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,As(t,r),i=Dr(i),n=n(i),t.flags|=1,Gt(e,t,n,r),t.child;case 14:return n=t.type,i=Lr(n,t.pendingProps),i=Lr(n.type,i),_d(e,t,n,i,r);case 15:return Bm(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Lr(n,i),El(e,t),t.tag=1,ar(n)?(e=!0,Ml(t)):e=!1,As(t,r),Im(t,n,i),v0(t,n,i,r),_0(null,t,n,!0,e,r);case 19:return Wm(e,t,r);case 22:return Um(e,t,r)}throw Error(Z(156,t.tag))};function ag(e,t){return F1(e,t)}function S2(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nr(e,t,r,n){return new S2(e,t,r,n)}function Uf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function k2(e){if(typeof e=="function")return Uf(e)?1:0;if(e!=null){if(e=e.$$typeof,e===sf)return 11;if(e===af)return 14}return 2}function ri(e,t){var r=e.alternate;return r===null?(r=Nr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Cl(e,t,r,n,i,s){var a=2;if(n=e,typeof e=="function")Uf(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case ds:return Ri(r.children,i,s,t);case nf:a=8,i|=8;break;case Hu:return e=Nr(12,r,t,i|2),e.elementType=Hu,e.lanes=s,e;case zu:return e=Nr(13,r,t,i),e.elementType=zu,e.lanes=s,e;case Wu:return e=Nr(19,r,t,i),e.elementType=Wu,e.lanes=s,e;case g1:return Ac(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case p1:a=10;break e;case m1:a=9;break e;case sf:a=11;break e;case af:a=14;break e;case Mn:a=16,n=null;break e}throw Error(Z(130,e==null?e:typeof e,""))}return t=Nr(a,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function Ri(e,t,r,n){return e=Nr(7,e,n,t),e.lanes=r,e}function Ac(e,t,r,n){return e=Nr(22,e,n,t),e.elementType=g1,e.lanes=r,e.stateNode={isHidden:!1},e}function Tu(e,t,r){return e=Nr(6,e,null,t),e.lanes=r,e}function Eu(e,t,r){return t=Nr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function C2(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nu(0),this.expirationTimes=nu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nu(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function $f(e,t,r,n,i,s,a,o,l){return e=new C2(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Nr(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Sf(s),e}function b2(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:hs,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function og(e){if(!e)return ii;e=e._reactInternals;e:{if(Gi(e)!==e||e.tag!==1)throw Error(Z(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ar(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Z(171))}if(e.tag===1){var r=e.type;if(ar(r))return om(e,r,t)}return t}function lg(e,t,r,n,i,s,a,o,l){return e=$f(r,n,!0,e,i,s,a,o,l),e.context=og(null),r=e.current,n=Yt(),i=ti(r),s=yn(n,i),s.callback=t??null,Zn(r,s,i),e.current.lanes=i,Eo(e,i,n),or(e,n),e}function Dc(e,t,r,n){var i=t.current,s=Yt(),a=ti(i);return r=og(r),t.context===null?t.context=r:t.pendingContext=r,t=yn(s,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Zn(i,t,a),e!==null&&(Wr(e,i,a,s),wl(e,i,a)),a}function Ql(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Fd(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Hf(e,t){Fd(e,t),(e=e.alternate)&&Fd(e,t)}function N2(){return null}var cg=typeof reportError=="function"?reportError:function(e){console.error(e)};function zf(e){this._internalRoot=e}Oc.prototype.render=zf.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Z(409));Dc(e,t,null,null)};Oc.prototype.unmount=zf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;$i(function(){Dc(null,e,null,null)}),t[kn]=null}};function Oc(e){this._internalRoot=e}Oc.prototype.unstable_scheduleHydration=function(e){if(e){var t=U1();e={blockedOn:null,target:e,priority:t};for(var r=0;r<$n.length&&t!==0&&t<$n[r].priority;r++);$n.splice(r,0,e),r===0&&H1(e)}};function Wf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Pc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Rd(){}function A2(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=Ql(a);s.call(c)}}var a=lg(t,n,e,0,null,!1,!1,"",Rd);return e._reactRootContainer=a,e[kn]=a.current,ro(e.nodeType===8?e.parentNode:e),$i(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=Ql(l);o.call(c)}}var l=$f(e,0,!1,null,null,!1,!1,"",Rd);return e._reactRootContainer=l,e[kn]=l.current,ro(e.nodeType===8?e.parentNode:e),$i(function(){Dc(t,l,r,n)}),l}function Fc(e,t,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=Ql(a);o.call(l)}}Dc(t,a,e,i)}else a=A2(r,t,e,i,n);return Ql(a)}M1=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Ea(t.pendingLanes);r!==0&&(cf(t,r|1),or(t,ot()),!(Oe&6)&&(Hs=ot()+500,pi()))}break;case 13:$i(function(){var n=Cn(e,1);if(n!==null){var i=Yt();Wr(n,e,1,i)}}),Hf(e,1)}};uf=function(e){if(e.tag===13){var t=Cn(e,134217728);if(t!==null){var r=Yt();Wr(t,e,134217728,r)}Hf(e,134217728)}};B1=function(e){if(e.tag===13){var t=ti(e),r=Cn(e,t);if(r!==null){var n=Yt();Wr(r,e,t,n)}Hf(e,t)}};U1=function(){return Ue};$1=function(e,t){var r=Ue;try{return Ue=e,t()}finally{Ue=r}};e0=function(e,t,r){switch(t){case"input":if(Ku(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=Ec(n);if(!i)throw Error(Z(90));v1(n),Ku(n,i)}}}break;case"textarea":w1(e,r);break;case"select":t=r.value,t!=null&&ks(e,!!r.multiple,t,!1)}};b1=Lf;N1=$i;var D2={usingClientEntryPoint:!1,Events:[ko,xs,Ec,k1,C1,Lf]},xa={findFiberByHostInstance:Di,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},O2={bundleType:xa.bundleType,version:xa.version,rendererPackageName:xa.rendererPackageName,rendererConfig:xa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:On.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=O1(e),e===null?null:e.stateNode},findFiberByHostInstance:xa.findFiberByHostInstance||N2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var el=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!el.isDisabled&&el.supportsFiber)try{yc=el.inject(O2),rn=el}catch{}}wr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D2;wr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Wf(t))throw Error(Z(200));return b2(e,t,null,r)};wr.createRoot=function(e,t){if(!Wf(e))throw Error(Z(299));var r=!1,n="",i=cg;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=$f(e,1,!1,null,null,r,!1,n,i),e[kn]=t.current,ro(e.nodeType===8?e.parentNode:e),new zf(t)};wr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Z(188)):(e=Object.keys(e).join(","),Error(Z(268,e)));return e=O1(t),e=e===null?null:e.stateNode,e};wr.flushSync=function(e){return $i(e)};wr.hydrate=function(e,t,r){if(!Pc(t))throw Error(Z(200));return Fc(null,e,t,!0,r)};wr.hydrateRoot=function(e,t,r){if(!Wf(e))throw Error(Z(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=cg;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=lg(t,null,e,1,r??null,i,!1,s,a),e[kn]=t.current,ro(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Oc(t)};wr.render=function(e,t,r){if(!Pc(t))throw Error(Z(200));return Fc(null,e,t,!1,r)};wr.unmountComponentAtNode=function(e){if(!Pc(e))throw Error(Z(40));return e._reactRootContainer?($i(function(){Fc(null,null,e,!1,function(){e._reactRootContainer=null,e[kn]=null})}),!0):!1};wr.unstable_batchedUpdates=Lf;wr.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Pc(r))throw Error(Z(200));if(e==null||e._reactInternals===void 0)throw Error(Z(38));return Fc(e,t,r,!1,n)};wr.version="18.3.1-next-f1338f8080-20240426";function ug(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ug)}catch(e){console.error(e)}}ug(),u1.exports=wr;var P2=u1.exports,fg,jd=P2;fg=jd.createRoot,jd.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var F2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R2=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Se=(e,t)=>{const r=ee.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,...c},u)=>ee.createElement("svg",{ref:u,...F2,width:i,height:i,stroke:n,strokeWidth:a?Number(s)*24/Number(i):s,className:["lucide",`lucide-${R2(e)}`,o].join(" "),...c},[...t.map(([h,d])=>ee.createElement(h,d)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Id=Se("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F0=Se("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ji=Se("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j2=Se("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R0=Se("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vf=Se("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gf=Se("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hg=Se("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fo=Se("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I2=Se("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ld=Se("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ci=Se("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=Se("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L2=Se("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M2=Se("Gavel",[["path",{d:"m14.5 12.5-8 8a2.119 2.119 0 1 1-3-3l8-8",key:"15492f"}],["path",{d:"m16 16 6-6",key:"vzrcl6"}],["path",{d:"m8 8 6-6",key:"18bi4p"}],["path",{d:"m9 7 8 8",key:"5jnvq1"}],["path",{d:"m21 11-8-8",key:"z4y7zo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Md=Se("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B2=Se("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U2=Se("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $2=Se("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dg=Se("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pg=Se("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mg=Se("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gg=Se("PauseCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jl=Se("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const si=Se("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ho=Se("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=Se("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xg=Se("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vg=Se("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ai=Se("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H2=Se("StopCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{width:"6",height:"6",x:"9",y:"9",key:"1wrtvo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zl=Se("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yg=Se("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wg=Se("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nn=Se("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j0=Se("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z2=Se("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=Se("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),W2=({activeTab:e,onTabChange:t,expiringSoonCount:r,systemType:n})=>{const a=n==="cases"?[{id:"add",label:"Thêm mới Vụ án",icon:si,color:"bg-green-600"},{id:"expiring",label:"Vụ án Sắp hết hạn",icon:Id,color:"bg-red-600"},{id:"all",label:"Tổng tất cả các vụ",icon:Md,color:"bg-blue-600"},{id:"investigation",label:"Giai đoạn Điều tra",icon:xg,color:"bg-orange-600"},{id:"prosecution",label:"Giai đoạn Truy tố",icon:La,color:"bg-purple-600"},{id:"trial",label:"Giai đoạn Xét xử",icon:M2,color:"bg-indigo-600"},{id:"statistics",label:"Thống kê Dữ liệu",icon:ji,color:"bg-teal-600"},{id:"data",label:"Quản lý Dữ liệu",icon:Ld,color:"bg-gray-600"}]:[{id:"add",label:"Thêm mới Tin báo",icon:si,color:"bg-green-600"},{id:"expiring",label:"Tin báo Sắp hết hạn",icon:Id,color:"bg-red-600"},{id:"all",label:"Tổng tất cả Tin báo",icon:Md,color:"bg-blue-600"},{id:"pending",label:"Đang xử lý",icon:fo,color:"bg-yellow-600"},{id:"statistics",label:"Thống kê Dữ liệu",icon:ji,color:"bg-teal-600"},{id:"data",label:"Quản lý Dữ liệu",icon:Ld,color:"bg-gray-600"}];return f.jsx("div",{className:"bg-white border-b border-gray-200 px-6",children:f.jsx("nav",{className:"flex space-x-8 overflow-x-auto",children:a.map(o=>{const l=o.icon,c=e===o.id,u=o.id==="expiring";return f.jsxs("button",{onClick:()=>t(o.id),className:`
                flex items-center gap-2 py-4 px-2 border-b-2 font-medium text-sm whitespace-nowrap
                ${c?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
                transition-colors
              `,children:[f.jsx(l,{size:18}),o.label,u&&r>0&&f.jsx("span",{className:"bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full",children:r})]},o.id)})})})},Kf=e=>{const t=e.getDate().toString().padStart(2,"0"),r=(e.getMonth()+1).toString().padStart(2,"0"),n=e.getFullYear();return`${t}/${r}/${n}`},qt=e=>{const[t,r,n]=e.split("/").map(Number);return new Date(n,r-1,t)},Gn=e=>{const t=new Date,n=qt(e).getTime()-t.getTime();return Math.ceil(n/(1e3*60*60*24))},Su=e=>Gn(e)<=15,lt=()=>Kf(new Date),ku=(e,t)=>{const r=qt(e);return r.setDate(r.getDate()+t),Kf(r)},sn=({value:e,onChange:t,options:r,placeholder:n,className:i="",required:s=!1,icon:a})=>{const[o,l]=ee.useState(!1),[c,u]=ee.useState(r),[h,d]=ee.useState(-1),m=ee.useRef(null),g=ee.useRef(null);ee.useEffect(()=>{if(!e.trim())u(r);else{const E=r.filter(C=>C.label.toLowerCase().includes(e.toLowerCase())||C.value.toLowerCase().includes(e.toLowerCase())||C.description&&C.description.toLowerCase().includes(e.toLowerCase()));u(E)}d(-1)},[e,r]);const p=E=>{const C=E.target.value;t(C),l(!0)},v=E=>{var C;t(E.value),l(!1),(C=m.current)==null||C.blur()},x=E=>{var C;if(!o&&(E.key==="ArrowDown"||E.key==="Enter")){l(!0);return}switch(E.key){case"ArrowDown":E.preventDefault(),d(R=>R<c.length-1?R+1:0);break;case"ArrowUp":E.preventDefault(),d(R=>R>0?R-1:c.length-1);break;case"Enter":E.preventDefault(),h>=0&&h<c.length&&v(c[h]);break;case"Escape":l(!1),d(-1),(C=m.current)==null||C.blur();break}},w=()=>{l(!0)},y=E=>{setTimeout(()=>{var C;(C=g.current)!=null&&C.contains(document.activeElement)||(l(!1),d(-1))},150)};return f.jsxs("div",{className:"relative",children:[f.jsxs("div",{className:"relative",children:[a&&f.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:a}),f.jsx("input",{ref:m,type:"text",value:e,onChange:p,onKeyDown:x,onFocus:w,onBlur:y,placeholder:n,required:s,className:`w-full ${a?"pl-10":"pl-3"} pr-10 py-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent ${i}`}),f.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:f.jsx(Gf,{size:16,className:`transition-transform ${o?"rotate-180":""}`})})]}),o&&c.length>0&&f.jsx("ul",{ref:g,className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-auto",children:c.map((E,C)=>f.jsxs("li",{onClick:()=>v(E),className:`px-3 py-2 cursor-pointer hover:bg-blue-50 ${C===h?"bg-blue-50":""}`,children:[f.jsx("div",{className:"font-medium text-gray-900",children:E.label}),E.description&&f.jsx("div",{className:"text-sm text-gray-600",children:E.description})]},`${E.value}-${C}`))})]})},_g=6048e5,V2=864e5,G2=6e4,K2=36e5,X2=1e3,Bd=Symbol.for("constructDateFrom");function kt(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&Bd in e?e[Bd](t):e instanceof Date?new e.constructor(t):new Date(t)}function pt(e,t){return kt(t||e,e)}function Tg(e,t,r){const n=pt(e,r==null?void 0:r.in);return isNaN(t)?kt((r==null?void 0:r.in)||e,NaN):(t&&n.setDate(n.getDate()+t),n)}let Y2={};function qs(){return Y2}function oi(e,t){var o,l,c,u;const r=qs(),n=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??r.weekStartsOn??((u=(c=r.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,i=pt(e,t==null?void 0:t.in),s=i.getDay(),a=(s<n?7:0)+s-n;return i.setDate(i.getDate()-a),i.setHours(0,0,0,0),i}function Ws(e,t){return oi(e,{...t,weekStartsOn:1})}function Eg(e,t){const r=pt(e,t==null?void 0:t.in),n=r.getFullYear(),i=kt(r,0);i.setFullYear(n+1,0,4),i.setHours(0,0,0,0);const s=Ws(i),a=kt(r,0);a.setFullYear(n,0,4),a.setHours(0,0,0,0);const o=Ws(a);return r.getTime()>=s.getTime()?n+1:r.getTime()>=o.getTime()?n:n-1}function ec(e){const t=pt(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function q2(e,...t){const r=kt.bind(null,t.find(n=>typeof n=="object"));return t.map(r)}function Ud(e,t){const r=pt(e,t==null?void 0:t.in);return r.setHours(0,0,0,0),r}function Q2(e,t,r){const[n,i]=q2(r==null?void 0:r.in,e,t),s=Ud(n),a=Ud(i),o=+s-ec(s),l=+a-ec(a);return Math.round((o-l)/V2)}function J2(e,t){const r=Eg(e,t),n=kt(e,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),Ws(n)}function Z2(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function bl(e){return!(!Z2(e)&&typeof e!="number"||isNaN(+pt(e)))}function e_(e,t){const r=pt(e,t==null?void 0:t.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const t_={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},r_=(e,t,r)=>{let n;const i=t_[e];return typeof i=="string"?n=i:t===1?n=i.one:n=i.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Os(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const n_={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},i_={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},s_={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},a_={date:Os({formats:n_,defaultWidth:"full"}),time:Os({formats:i_,defaultWidth:"full"}),dateTime:Os({formats:s_,defaultWidth:"full"})},o_={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},l_=(e,t,r,n)=>o_[e];function Jr(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let i;if(n==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):a;i=e.formattingValues[o]||e.formattingValues[a]}else{const a=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;i=e.values[o]||e.values[a]}const s=e.argumentCallback?e.argumentCallback(t):t;return i[s]}}const c_={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},u_={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},f_={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},h_={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},d_={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},p_={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},m_=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},g_={ordinalNumber:m_,era:Jr({values:c_,defaultWidth:"wide"}),quarter:Jr({values:u_,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Jr({values:f_,defaultWidth:"wide"}),day:Jr({values:h_,defaultWidth:"wide"}),dayPeriod:Jr({values:d_,defaultWidth:"wide",formattingValues:p_,defaultFormattingWidth:"wide"})};function Zr(e){return(t,r={})=>{const n=r.width,i=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=t.match(i);if(!s)return null;const a=s[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?v_(o,h=>h.test(a)):x_(o,h=>h.test(a));let c;c=e.valueCallback?e.valueCallback(l):l,c=r.valueCallback?r.valueCallback(c):c;const u=t.slice(a.length);return{value:c,rest:u}}}function x_(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function v_(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function Sg(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const i=n[0],s=t.match(e.parsePattern);if(!s)return null;let a=e.valueCallback?e.valueCallback(s[0]):s[0];a=r.valueCallback?r.valueCallback(a):a;const o=t.slice(i.length);return{value:a,rest:o}}}const y_=/^(\d+)(th|st|nd|rd)?/i,w_=/\d+/i,__={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},T_={any:[/^b/i,/^(a|c)/i]},E_={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},S_={any:[/1/i,/2/i,/3/i,/4/i]},k_={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},C_={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},b_={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},N_={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},A_={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},D_={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},O_={ordinalNumber:Sg({matchPattern:y_,parsePattern:w_,valueCallback:e=>parseInt(e,10)}),era:Zr({matchPatterns:__,defaultMatchWidth:"wide",parsePatterns:T_,defaultParseWidth:"any"}),quarter:Zr({matchPatterns:E_,defaultMatchWidth:"wide",parsePatterns:S_,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Zr({matchPatterns:k_,defaultMatchWidth:"wide",parsePatterns:C_,defaultParseWidth:"any"}),day:Zr({matchPatterns:b_,defaultMatchWidth:"wide",parsePatterns:N_,defaultParseWidth:"any"}),dayPeriod:Zr({matchPatterns:A_,defaultMatchWidth:"any",parsePatterns:D_,defaultParseWidth:"any"})},kg={code:"en-US",formatDistance:r_,formatLong:a_,formatRelative:l_,localize:g_,match:O_,options:{weekStartsOn:0,firstWeekContainsDate:1}};function P_(e,t){const r=pt(e,t==null?void 0:t.in);return Q2(r,e_(r))+1}function Cg(e,t){const r=pt(e,t==null?void 0:t.in),n=+Ws(r)-+J2(r);return Math.round(n/_g)+1}function Xf(e,t){var u,h,d,m;const r=pt(e,t==null?void 0:t.in),n=r.getFullYear(),i=qs(),s=(t==null?void 0:t.firstWeekContainsDate)??((h=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??i.firstWeekContainsDate??((m=(d=i.locale)==null?void 0:d.options)==null?void 0:m.firstWeekContainsDate)??1,a=kt((t==null?void 0:t.in)||e,0);a.setFullYear(n+1,0,s),a.setHours(0,0,0,0);const o=oi(a,t),l=kt((t==null?void 0:t.in)||e,0);l.setFullYear(n,0,s),l.setHours(0,0,0,0);const c=oi(l,t);return+r>=+o?n+1:+r>=+c?n:n-1}function F_(e,t){var o,l,c,u;const r=qs(),n=(t==null?void 0:t.firstWeekContainsDate)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??r.firstWeekContainsDate??((u=(c=r.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,i=Xf(e,t),s=kt((t==null?void 0:t.in)||e,0);return s.setFullYear(i,0,n),s.setHours(0,0,0,0),oi(s,t)}function bg(e,t){const r=pt(e,t==null?void 0:t.in),n=+oi(r,t)-+F_(r,t);return Math.round(n/_g)+1}function Le(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const jn={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Le(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Le(r+1,2)},d(e,t){return Le(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Le(e.getHours()%12||12,t.length)},H(e,t){return Le(e.getHours(),t.length)},m(e,t){return Le(e.getMinutes(),t.length)},s(e,t){return Le(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),i=Math.trunc(n*Math.pow(10,r-3));return Le(i,t.length)}},rs={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},$d={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),i=n>0?n:1-n;return r.ordinalNumber(i,{unit:"year"})}return jn.y(e,t)},Y:function(e,t,r,n){const i=Xf(e,n),s=i>0?i:1-i;if(t==="YY"){const a=s%100;return Le(a,2)}return t==="Yo"?r.ordinalNumber(s,{unit:"year"}):Le(s,t.length)},R:function(e,t){const r=Eg(e);return Le(r,t.length)},u:function(e,t){const r=e.getFullYear();return Le(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Le(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Le(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return jn.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Le(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const i=bg(e,n);return t==="wo"?r.ordinalNumber(i,{unit:"week"}):Le(i,t.length)},I:function(e,t,r){const n=Cg(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Le(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):jn.d(e,t)},D:function(e,t,r){const n=P_(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Le(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const i=e.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return Le(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});case"eeee":default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const i=e.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return Le(s,t.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});case"cccc":default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),i=n===0?7:n;switch(t){case"i":return String(i);case"ii":return Le(i,t.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const i=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let i;switch(n===12?i=rs.noon:n===0?i=rs.midnight:i=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let i;switch(n>=17?i=rs.evening:n>=12?i=rs.afternoon:n>=4?i=rs.morning:i=rs.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return jn.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):jn.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Le(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Le(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):jn.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):jn.s(e,t)},S:function(e,t){return jn.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return zd(n);case"XXXX":case"XX":return Si(n);case"XXXXX":case"XXX":default:return Si(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return zd(n);case"xxxx":case"xx":return Si(n);case"xxxxx":case"xxx":default:return Si(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Hd(n,":");case"OOOO":default:return"GMT"+Si(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Hd(n,":");case"zzzz":default:return"GMT"+Si(n,":")}},t:function(e,t,r){const n=Math.trunc(+e/1e3);return Le(n,t.length)},T:function(e,t,r){return Le(+e,t.length)}};function Hd(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=Math.trunc(n/60),s=n%60;return s===0?r+String(i):r+String(i)+t+Le(s,2)}function zd(e,t){return e%60===0?(e>0?"-":"+")+Le(Math.abs(e)/60,2):Si(e,t)}function Si(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=Le(Math.trunc(n/60),2),s=Le(n%60,2);return r+i+t+s}const Wd=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Ng=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},R_=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],i=r[2];if(!i)return Wd(e,t);let s;switch(n){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;case"PPPP":default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",Wd(n,t)).replace("{{time}}",Ng(i,t))},I0={p:Ng,P:R_},j_=/^D+$/,I_=/^Y+$/,L_=["D","DD","YY","YYYY"];function Ag(e){return j_.test(e)}function Dg(e){return I_.test(e)}function L0(e,t,r){const n=M_(e,t,r);if(console.warn(n),L_.includes(e))throw new RangeError(n)}function M_(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const B_=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,U_=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,$_=/^'([^]*?)'?$/,H_=/''/g,z_=/[a-zA-Z]/;function wi(e,t,r){var u,h,d,m,g,p,v,x;const n=qs(),i=(r==null?void 0:r.locale)??n.locale??kg,s=(r==null?void 0:r.firstWeekContainsDate)??((h=(u=r==null?void 0:r.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??n.firstWeekContainsDate??((m=(d=n.locale)==null?void 0:d.options)==null?void 0:m.firstWeekContainsDate)??1,a=(r==null?void 0:r.weekStartsOn)??((p=(g=r==null?void 0:r.locale)==null?void 0:g.options)==null?void 0:p.weekStartsOn)??n.weekStartsOn??((x=(v=n.locale)==null?void 0:v.options)==null?void 0:x.weekStartsOn)??0,o=pt(e,r==null?void 0:r.in);if(!bl(o))throw new RangeError("Invalid time value");let l=t.match(U_).map(w=>{const y=w[0];if(y==="p"||y==="P"){const E=I0[y];return E(w,i.formatLong)}return w}).join("").match(B_).map(w=>{if(w==="''")return{isToken:!1,value:"'"};const y=w[0];if(y==="'")return{isToken:!1,value:W_(w)};if($d[y])return{isToken:!0,value:w};if(y.match(z_))throw new RangeError("Format string contains an unescaped latin alphabet character `"+y+"`");return{isToken:!1,value:w}});i.localize.preprocessor&&(l=i.localize.preprocessor(o,l));const c={firstWeekContainsDate:s,weekStartsOn:a,locale:i};return l.map(w=>{if(!w.isToken)return w.value;const y=w.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&Dg(y)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&Ag(y))&&L0(y,t,String(e));const E=$d[y[0]];return E(o,y,i.localize,c)}).join("")}function W_(e){const t=e.match($_);return t?t[1].replace(H_,"'"):e}function V_(){return Object.assign({},qs())}function G_(e,t){const r=pt(e,t==null?void 0:t.in).getDay();return r===0?7:r}function K_(e,t){const r=X_(t)?new t(0):kt(t,0);return r.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),r.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),r}function X_(e){var t;return typeof e=="function"&&((t=e.prototype)==null?void 0:t.constructor)===e}const Y_=10;class Og{constructor(){le(this,"subPriority",0)}validate(t,r){return!0}}class q_ extends Og{constructor(t,r,n,i,s){super(),this.value=t,this.validateValue=r,this.setValue=n,this.priority=i,s&&(this.subPriority=s)}validate(t,r){return this.validateValue(t,this.value,r)}set(t,r,n){return this.setValue(t,r,this.value,n)}}class Q_ extends Og{constructor(r,n){super();le(this,"priority",Y_);le(this,"subPriority",-1);this.context=r||(i=>kt(n,i))}set(r,n){return n.timestampIsSet?r:kt(r,K_(r,this.context))}}class Re{run(t,r,n,i){const s=this.parse(t,r,n,i);return s?{setter:new q_(s.value,this.validate,this.set,this.priority,this.subPriority),rest:s.rest}:null}validate(t,r,n){return!0}}class J_ extends Re{constructor(){super(...arguments);le(this,"priority",140);le(this,"incompatibleTokens",["R","u","t","T"])}parse(r,n,i){switch(n){case"G":case"GG":case"GGG":return i.era(r,{width:"abbreviated"})||i.era(r,{width:"narrow"});case"GGGGG":return i.era(r,{width:"narrow"});case"GGGG":default:return i.era(r,{width:"wide"})||i.era(r,{width:"abbreviated"})||i.era(r,{width:"narrow"})}}set(r,n,i){return n.era=i,r.setFullYear(i,0,1),r.setHours(0,0,0,0),r}}const ct={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},en={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function ut(e,t){return e&&{value:t(e.value),rest:e.rest}}function Ze(e,t){const r=t.match(e);return r?{value:parseInt(r[0],10),rest:t.slice(r[0].length)}:null}function tn(e,t){const r=t.match(e);if(!r)return null;if(r[0]==="Z")return{value:0,rest:t.slice(1)};const n=r[1]==="+"?1:-1,i=r[2]?parseInt(r[2],10):0,s=r[3]?parseInt(r[3],10):0,a=r[5]?parseInt(r[5],10):0;return{value:n*(i*K2+s*G2+a*X2),rest:t.slice(r[0].length)}}function Pg(e){return Ze(ct.anyDigitsSigned,e)}function st(e,t){switch(e){case 1:return Ze(ct.singleDigit,t);case 2:return Ze(ct.twoDigits,t);case 3:return Ze(ct.threeDigits,t);case 4:return Ze(ct.fourDigits,t);default:return Ze(new RegExp("^\\d{1,"+e+"}"),t)}}function tc(e,t){switch(e){case 1:return Ze(ct.singleDigitSigned,t);case 2:return Ze(ct.twoDigitsSigned,t);case 3:return Ze(ct.threeDigitsSigned,t);case 4:return Ze(ct.fourDigitsSigned,t);default:return Ze(new RegExp("^-?\\d{1,"+e+"}"),t)}}function Yf(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function Fg(e,t){const r=t>0,n=r?t:1-t;let i;if(n<=50)i=e||100;else{const s=n+50,a=Math.trunc(s/100)*100,o=e>=s%100;i=e+a-(o?100:0)}return r?i:1-i}function Rg(e){return e%400===0||e%4===0&&e%100!==0}class Z_ extends Re{constructor(){super(...arguments);le(this,"priority",130);le(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(r,n,i){const s=a=>({year:a,isTwoDigitYear:n==="yy"});switch(n){case"y":return ut(st(4,r),s);case"yo":return ut(i.ordinalNumber(r,{unit:"year"}),s);default:return ut(st(n.length,r),s)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,i){const s=r.getFullYear();if(i.isTwoDigitYear){const o=Fg(i.year,s);return r.setFullYear(o,0,1),r.setHours(0,0,0,0),r}const a=!("era"in n)||n.era===1?i.year:1-i.year;return r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}}class eT extends Re{constructor(){super(...arguments);le(this,"priority",130);le(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(r,n,i){const s=a=>({year:a,isTwoDigitYear:n==="YY"});switch(n){case"Y":return ut(st(4,r),s);case"Yo":return ut(i.ordinalNumber(r,{unit:"year"}),s);default:return ut(st(n.length,r),s)}}validate(r,n){return n.isTwoDigitYear||n.year>0}set(r,n,i,s){const a=Xf(r,s);if(i.isTwoDigitYear){const l=Fg(i.year,a);return r.setFullYear(l,0,s.firstWeekContainsDate),r.setHours(0,0,0,0),oi(r,s)}const o=!("era"in n)||n.era===1?i.year:1-i.year;return r.setFullYear(o,0,s.firstWeekContainsDate),r.setHours(0,0,0,0),oi(r,s)}}class tT extends Re{constructor(){super(...arguments);le(this,"priority",130);le(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(r,n){return tc(n==="R"?4:n.length,r)}set(r,n,i){const s=kt(r,0);return s.setFullYear(i,0,4),s.setHours(0,0,0,0),Ws(s)}}class rT extends Re{constructor(){super(...arguments);le(this,"priority",130);le(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(r,n){return tc(n==="u"?4:n.length,r)}set(r,n,i){return r.setFullYear(i,0,1),r.setHours(0,0,0,0),r}}class nT extends Re{constructor(){super(...arguments);le(this,"priority",120);le(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,i){switch(n){case"Q":case"QQ":return st(n.length,r);case"Qo":return i.ordinalNumber(r,{unit:"quarter"});case"QQQ":return i.quarter(r,{width:"abbreviated",context:"formatting"})||i.quarter(r,{width:"narrow",context:"formatting"});case"QQQQQ":return i.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return i.quarter(r,{width:"wide",context:"formatting"})||i.quarter(r,{width:"abbreviated",context:"formatting"})||i.quarter(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=1&&n<=4}set(r,n,i){return r.setMonth((i-1)*3,1),r.setHours(0,0,0,0),r}}class iT extends Re{constructor(){super(...arguments);le(this,"priority",120);le(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(r,n,i){switch(n){case"q":case"qq":return st(n.length,r);case"qo":return i.ordinalNumber(r,{unit:"quarter"});case"qqq":return i.quarter(r,{width:"abbreviated",context:"standalone"})||i.quarter(r,{width:"narrow",context:"standalone"});case"qqqqq":return i.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return i.quarter(r,{width:"wide",context:"standalone"})||i.quarter(r,{width:"abbreviated",context:"standalone"})||i.quarter(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=1&&n<=4}set(r,n,i){return r.setMonth((i-1)*3,1),r.setHours(0,0,0,0),r}}class sT extends Re{constructor(){super(...arguments);le(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);le(this,"priority",110)}parse(r,n,i){const s=a=>a-1;switch(n){case"M":return ut(Ze(ct.month,r),s);case"MM":return ut(st(2,r),s);case"Mo":return ut(i.ordinalNumber(r,{unit:"month"}),s);case"MMM":return i.month(r,{width:"abbreviated",context:"formatting"})||i.month(r,{width:"narrow",context:"formatting"});case"MMMMM":return i.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return i.month(r,{width:"wide",context:"formatting"})||i.month(r,{width:"abbreviated",context:"formatting"})||i.month(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=11}set(r,n,i){return r.setMonth(i,1),r.setHours(0,0,0,0),r}}class aT extends Re{constructor(){super(...arguments);le(this,"priority",110);le(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(r,n,i){const s=a=>a-1;switch(n){case"L":return ut(Ze(ct.month,r),s);case"LL":return ut(st(2,r),s);case"Lo":return ut(i.ordinalNumber(r,{unit:"month"}),s);case"LLL":return i.month(r,{width:"abbreviated",context:"standalone"})||i.month(r,{width:"narrow",context:"standalone"});case"LLLLL":return i.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return i.month(r,{width:"wide",context:"standalone"})||i.month(r,{width:"abbreviated",context:"standalone"})||i.month(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=11}set(r,n,i){return r.setMonth(i,1),r.setHours(0,0,0,0),r}}function oT(e,t,r){const n=pt(e,r==null?void 0:r.in),i=bg(n,r)-t;return n.setDate(n.getDate()-i*7),pt(n,r==null?void 0:r.in)}class lT extends Re{constructor(){super(...arguments);le(this,"priority",100);le(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(r,n,i){switch(n){case"w":return Ze(ct.week,r);case"wo":return i.ordinalNumber(r,{unit:"week"});default:return st(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,i,s){return oi(oT(r,i,s),s)}}function cT(e,t,r){const n=pt(e,r==null?void 0:r.in),i=Cg(n,r)-t;return n.setDate(n.getDate()-i*7),n}class uT extends Re{constructor(){super(...arguments);le(this,"priority",100);le(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(r,n,i){switch(n){case"I":return Ze(ct.week,r);case"Io":return i.ordinalNumber(r,{unit:"week"});default:return st(n.length,r)}}validate(r,n){return n>=1&&n<=53}set(r,n,i){return Ws(cT(r,i))}}const fT=[31,28,31,30,31,30,31,31,30,31,30,31],hT=[31,29,31,30,31,30,31,31,30,31,30,31];class dT extends Re{constructor(){super(...arguments);le(this,"priority",90);le(this,"subPriority",1);le(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(r,n,i){switch(n){case"d":return Ze(ct.date,r);case"do":return i.ordinalNumber(r,{unit:"date"});default:return st(n.length,r)}}validate(r,n){const i=r.getFullYear(),s=Rg(i),a=r.getMonth();return s?n>=1&&n<=hT[a]:n>=1&&n<=fT[a]}set(r,n,i){return r.setDate(i),r.setHours(0,0,0,0),r}}class pT extends Re{constructor(){super(...arguments);le(this,"priority",90);le(this,"subpriority",1);le(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(r,n,i){switch(n){case"D":case"DD":return Ze(ct.dayOfYear,r);case"Do":return i.ordinalNumber(r,{unit:"date"});default:return st(n.length,r)}}validate(r,n){const i=r.getFullYear();return Rg(i)?n>=1&&n<=366:n>=1&&n<=365}set(r,n,i){return r.setMonth(0,i),r.setHours(0,0,0,0),r}}function qf(e,t,r){var h,d,m,g;const n=qs(),i=(r==null?void 0:r.weekStartsOn)??((d=(h=r==null?void 0:r.locale)==null?void 0:h.options)==null?void 0:d.weekStartsOn)??n.weekStartsOn??((g=(m=n.locale)==null?void 0:m.options)==null?void 0:g.weekStartsOn)??0,s=pt(e,r==null?void 0:r.in),a=s.getDay(),l=(t%7+7)%7,c=7-i,u=t<0||t>6?t-(a+c)%7:(l+c)%7-(a+c)%7;return Tg(s,u,r)}class mT extends Re{constructor(){super(...arguments);le(this,"priority",90);le(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(r,n,i){switch(n){case"E":case"EE":case"EEE":return i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"});case"EEEEE":return i.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"});case"EEEE":default:return i.day(r,{width:"wide",context:"formatting"})||i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,i,s){return r=qf(r,i,s),r.setHours(0,0,0,0),r}}class gT extends Re{constructor(){super(...arguments);le(this,"priority",90);le(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(r,n,i,s){const a=o=>{const l=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+l};switch(n){case"e":case"ee":return ut(st(n.length,r),a);case"eo":return ut(i.ordinalNumber(r,{unit:"day"}),a);case"eee":return i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"});case"eeeee":return i.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"});case"eeee":default:return i.day(r,{width:"wide",context:"formatting"})||i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"})}}validate(r,n){return n>=0&&n<=6}set(r,n,i,s){return r=qf(r,i,s),r.setHours(0,0,0,0),r}}class xT extends Re{constructor(){super(...arguments);le(this,"priority",90);le(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(r,n,i,s){const a=o=>{const l=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+l};switch(n){case"c":case"cc":return ut(st(n.length,r),a);case"co":return ut(i.ordinalNumber(r,{unit:"day"}),a);case"ccc":return i.day(r,{width:"abbreviated",context:"standalone"})||i.day(r,{width:"short",context:"standalone"})||i.day(r,{width:"narrow",context:"standalone"});case"ccccc":return i.day(r,{width:"narrow",context:"standalone"});case"cccccc":return i.day(r,{width:"short",context:"standalone"})||i.day(r,{width:"narrow",context:"standalone"});case"cccc":default:return i.day(r,{width:"wide",context:"standalone"})||i.day(r,{width:"abbreviated",context:"standalone"})||i.day(r,{width:"short",context:"standalone"})||i.day(r,{width:"narrow",context:"standalone"})}}validate(r,n){return n>=0&&n<=6}set(r,n,i,s){return r=qf(r,i,s),r.setHours(0,0,0,0),r}}function vT(e,t,r){const n=pt(e,r==null?void 0:r.in),i=G_(n,r),s=t-i;return Tg(n,s,r)}class yT extends Re{constructor(){super(...arguments);le(this,"priority",90);le(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(r,n,i){const s=a=>a===0?7:a;switch(n){case"i":case"ii":return st(n.length,r);case"io":return i.ordinalNumber(r,{unit:"day"});case"iii":return ut(i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"}),s);case"iiiii":return ut(i.day(r,{width:"narrow",context:"formatting"}),s);case"iiiiii":return ut(i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"}),s);case"iiii":default:return ut(i.day(r,{width:"wide",context:"formatting"})||i.day(r,{width:"abbreviated",context:"formatting"})||i.day(r,{width:"short",context:"formatting"})||i.day(r,{width:"narrow",context:"formatting"}),s)}}validate(r,n){return n>=1&&n<=7}set(r,n,i){return r=vT(r,i),r.setHours(0,0,0,0),r}}class wT extends Re{constructor(){super(...arguments);le(this,"priority",80);le(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(r,n,i){switch(n){case"a":case"aa":case"aaa":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaaa":return i.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return i.dayPeriod(r,{width:"wide",context:"formatting"})||i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,i){return r.setHours(Yf(i),0,0,0),r}}class _T extends Re{constructor(){super(...arguments);le(this,"priority",80);le(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(r,n,i){switch(n){case"b":case"bb":case"bbb":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbbb":return i.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return i.dayPeriod(r,{width:"wide",context:"formatting"})||i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,i){return r.setHours(Yf(i),0,0,0),r}}class TT extends Re{constructor(){super(...arguments);le(this,"priority",80);le(this,"incompatibleTokens",["a","b","t","T"])}parse(r,n,i){switch(n){case"B":case"BB":case"BBB":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBBB":return i.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return i.dayPeriod(r,{width:"wide",context:"formatting"})||i.dayPeriod(r,{width:"abbreviated",context:"formatting"})||i.dayPeriod(r,{width:"narrow",context:"formatting"})}}set(r,n,i){return r.setHours(Yf(i),0,0,0),r}}class ET extends Re{constructor(){super(...arguments);le(this,"priority",70);le(this,"incompatibleTokens",["H","K","k","t","T"])}parse(r,n,i){switch(n){case"h":return Ze(ct.hour12h,r);case"ho":return i.ordinalNumber(r,{unit:"hour"});default:return st(n.length,r)}}validate(r,n){return n>=1&&n<=12}set(r,n,i){const s=r.getHours()>=12;return s&&i<12?r.setHours(i+12,0,0,0):!s&&i===12?r.setHours(0,0,0,0):r.setHours(i,0,0,0),r}}class ST extends Re{constructor(){super(...arguments);le(this,"priority",70);le(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(r,n,i){switch(n){case"H":return Ze(ct.hour23h,r);case"Ho":return i.ordinalNumber(r,{unit:"hour"});default:return st(n.length,r)}}validate(r,n){return n>=0&&n<=23}set(r,n,i){return r.setHours(i,0,0,0),r}}class kT extends Re{constructor(){super(...arguments);le(this,"priority",70);le(this,"incompatibleTokens",["h","H","k","t","T"])}parse(r,n,i){switch(n){case"K":return Ze(ct.hour11h,r);case"Ko":return i.ordinalNumber(r,{unit:"hour"});default:return st(n.length,r)}}validate(r,n){return n>=0&&n<=11}set(r,n,i){return r.getHours()>=12&&i<12?r.setHours(i+12,0,0,0):r.setHours(i,0,0,0),r}}class CT extends Re{constructor(){super(...arguments);le(this,"priority",70);le(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(r,n,i){switch(n){case"k":return Ze(ct.hour24h,r);case"ko":return i.ordinalNumber(r,{unit:"hour"});default:return st(n.length,r)}}validate(r,n){return n>=1&&n<=24}set(r,n,i){const s=i<=24?i%24:i;return r.setHours(s,0,0,0),r}}class bT extends Re{constructor(){super(...arguments);le(this,"priority",60);le(this,"incompatibleTokens",["t","T"])}parse(r,n,i){switch(n){case"m":return Ze(ct.minute,r);case"mo":return i.ordinalNumber(r,{unit:"minute"});default:return st(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,i){return r.setMinutes(i,0,0),r}}class NT extends Re{constructor(){super(...arguments);le(this,"priority",50);le(this,"incompatibleTokens",["t","T"])}parse(r,n,i){switch(n){case"s":return Ze(ct.second,r);case"so":return i.ordinalNumber(r,{unit:"second"});default:return st(n.length,r)}}validate(r,n){return n>=0&&n<=59}set(r,n,i){return r.setSeconds(i,0),r}}class AT extends Re{constructor(){super(...arguments);le(this,"priority",30);le(this,"incompatibleTokens",["t","T"])}parse(r,n){const i=s=>Math.trunc(s*Math.pow(10,-n.length+3));return ut(st(n.length,r),i)}set(r,n,i){return r.setMilliseconds(i),r}}class DT extends Re{constructor(){super(...arguments);le(this,"priority",10);le(this,"incompatibleTokens",["t","T","x"])}parse(r,n){switch(n){case"X":return tn(en.basicOptionalMinutes,r);case"XX":return tn(en.basic,r);case"XXXX":return tn(en.basicOptionalSeconds,r);case"XXXXX":return tn(en.extendedOptionalSeconds,r);case"XXX":default:return tn(en.extended,r)}}set(r,n,i){return n.timestampIsSet?r:kt(r,r.getTime()-ec(r)-i)}}class OT extends Re{constructor(){super(...arguments);le(this,"priority",10);le(this,"incompatibleTokens",["t","T","X"])}parse(r,n){switch(n){case"x":return tn(en.basicOptionalMinutes,r);case"xx":return tn(en.basic,r);case"xxxx":return tn(en.basicOptionalSeconds,r);case"xxxxx":return tn(en.extendedOptionalSeconds,r);case"xxx":default:return tn(en.extended,r)}}set(r,n,i){return n.timestampIsSet?r:kt(r,r.getTime()-ec(r)-i)}}class PT extends Re{constructor(){super(...arguments);le(this,"priority",40);le(this,"incompatibleTokens","*")}parse(r){return Pg(r)}set(r,n,i){return[kt(r,i*1e3),{timestampIsSet:!0}]}}class FT extends Re{constructor(){super(...arguments);le(this,"priority",20);le(this,"incompatibleTokens","*")}parse(r){return Pg(r)}set(r,n,i){return[kt(r,i),{timestampIsSet:!0}]}}const RT={G:new J_,y:new Z_,Y:new eT,R:new tT,u:new rT,Q:new nT,q:new iT,M:new sT,L:new aT,w:new lT,I:new uT,d:new dT,D:new pT,E:new mT,e:new gT,c:new xT,i:new yT,a:new wT,b:new _T,B:new TT,h:new ET,H:new ST,K:new kT,k:new CT,m:new bT,s:new NT,S:new AT,X:new DT,x:new OT,t:new PT,T:new FT},jT=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,IT=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,LT=/^'([^]*?)'?$/,MT=/''/g,BT=/\S/,UT=/[a-zA-Z]/;function Vd(e,t,r,n){var v,x,w,y,E,C,R,D;const i=()=>kt((n==null?void 0:n.in)||r,NaN),s=V_(),a=(n==null?void 0:n.locale)??s.locale??kg,o=(n==null?void 0:n.firstWeekContainsDate)??((x=(v=n==null?void 0:n.locale)==null?void 0:v.options)==null?void 0:x.firstWeekContainsDate)??s.firstWeekContainsDate??((y=(w=s.locale)==null?void 0:w.options)==null?void 0:y.firstWeekContainsDate)??1,l=(n==null?void 0:n.weekStartsOn)??((C=(E=n==null?void 0:n.locale)==null?void 0:E.options)==null?void 0:C.weekStartsOn)??s.weekStartsOn??((D=(R=s.locale)==null?void 0:R.options)==null?void 0:D.weekStartsOn)??0;if(!t)return e?i():pt(r,n==null?void 0:n.in);const c={firstWeekContainsDate:o,weekStartsOn:l,locale:a},u=[new Q_(n==null?void 0:n.in,r)],h=t.match(IT).map(F=>{const N=F[0];if(N in I0){const P=I0[N];return P(F,a.formatLong)}return F}).join("").match(jT),d=[];for(let F of h){!(n!=null&&n.useAdditionalWeekYearTokens)&&Dg(F)&&L0(F,t,e),!(n!=null&&n.useAdditionalDayOfYearTokens)&&Ag(F)&&L0(F,t,e);const N=F[0],P=RT[N];if(P){const{incompatibleTokens:W}=P;if(Array.isArray(W)){const Q=d.find(ve=>W.includes(ve.token)||ve.token===N);if(Q)throw new RangeError(`The format string mustn't contain \`${Q.fullToken}\` and \`${F}\` at the same time`)}else if(P.incompatibleTokens==="*"&&d.length>0)throw new RangeError(`The format string mustn't contain \`${F}\` and any other token at the same time`);d.push({token:N,fullToken:F});const G=P.run(e,F,a.match,c);if(!G)return i();u.push(G.setter),e=G.rest}else{if(N.match(UT))throw new RangeError("Format string contains an unescaped latin alphabet character `"+N+"`");if(F==="''"?F="'":N==="'"&&(F=$T(F)),e.indexOf(F)===0)e=e.slice(F.length);else return i()}}if(e.length>0&&BT.test(e))return i();const m=u.map(F=>F.priority).sort((F,N)=>N-F).filter((F,N,P)=>P.indexOf(F)===N).map(F=>u.filter(N=>N.priority===F).sort((N,P)=>P.subPriority-N.subPriority)).map(F=>F[0]);let g=pt(r,n==null?void 0:n.in);if(isNaN(+g))return i();const p={};for(const F of m){if(!F.validate(g,c))return i();const N=F.set(g,p,c);Array.isArray(N)?(g=N[0],Object.assign(p,N[1])):g=N}return g}function $T(e){return e.match(LT)[1].replace(MT,"'")}const HT={lessThanXSeconds:{one:"dưới 1 giây",other:"dưới {{count}} giây"},xSeconds:{one:"1 giây",other:"{{count}} giây"},halfAMinute:"nửa phút",lessThanXMinutes:{one:"dưới 1 phút",other:"dưới {{count}} phút"},xMinutes:{one:"1 phút",other:"{{count}} phút"},aboutXHours:{one:"khoảng 1 giờ",other:"khoảng {{count}} giờ"},xHours:{one:"1 giờ",other:"{{count}} giờ"},xDays:{one:"1 ngày",other:"{{count}} ngày"},aboutXWeeks:{one:"khoảng 1 tuần",other:"khoảng {{count}} tuần"},xWeeks:{one:"1 tuần",other:"{{count}} tuần"},aboutXMonths:{one:"khoảng 1 tháng",other:"khoảng {{count}} tháng"},xMonths:{one:"1 tháng",other:"{{count}} tháng"},aboutXYears:{one:"khoảng 1 năm",other:"khoảng {{count}} năm"},xYears:{one:"1 năm",other:"{{count}} năm"},overXYears:{one:"hơn 1 năm",other:"hơn {{count}} năm"},almostXYears:{one:"gần 1 năm",other:"gần {{count}} năm"}},zT=(e,t,r)=>{let n;const i=HT[e];return typeof i=="string"?n=i:t===1?n=i.one:n=i.other.replace("{{count}}",String(t)),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?n+" nữa":n+" trước":n},WT={full:"EEEE, 'ngày' d MMMM 'năm' y",long:"'ngày' d MMMM 'năm' y",medium:"d MMM 'năm' y",short:"dd/MM/y"},VT={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},GT={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},KT={date:Os({formats:WT,defaultWidth:"full"}),time:Os({formats:VT,defaultWidth:"full"}),dateTime:Os({formats:GT,defaultWidth:"full"})},XT={lastWeek:"eeee 'tuần trước vào lúc' p",yesterday:"'hôm qua vào lúc' p",today:"'hôm nay vào lúc' p",tomorrow:"'ngày mai vào lúc' p",nextWeek:"eeee 'tới vào lúc' p",other:"P"},YT=(e,t,r,n)=>XT[e],qT={narrow:["TCN","SCN"],abbreviated:["trước CN","sau CN"],wide:["trước Công Nguyên","sau Công Nguyên"]},QT={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["Quý 1","Quý 2","Quý 3","Quý 4"]},JT={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["quý I","quý II","quý III","quý IV"]},ZT={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["Thg 1","Thg 2","Thg 3","Thg 4","Thg 5","Thg 6","Thg 7","Thg 8","Thg 9","Thg 10","Thg 11","Thg 12"],wide:["Tháng Một","Tháng Hai","Tháng Ba","Tháng Tư","Tháng Năm","Tháng Sáu","Tháng Bảy","Tháng Tám","Tháng Chín","Tháng Mười","Tháng Mười Một","Tháng Mười Hai"]},eE={narrow:["01","02","03","04","05","06","07","08","09","10","11","12"],abbreviated:["thg 1","thg 2","thg 3","thg 4","thg 5","thg 6","thg 7","thg 8","thg 9","thg 10","thg 11","thg 12"],wide:["tháng 01","tháng 02","tháng 03","tháng 04","tháng 05","tháng 06","tháng 07","tháng 08","tháng 09","tháng 10","tháng 11","tháng 12"]},tE={narrow:["CN","T2","T3","T4","T5","T6","T7"],short:["CN","Th 2","Th 3","Th 4","Th 5","Th 6","Th 7"],abbreviated:["CN","Thứ 2","Thứ 3","Thứ 4","Thứ 5","Thứ 6","Thứ 7"],wide:["Chủ Nhật","Thứ Hai","Thứ Ba","Thứ Tư","Thứ Năm","Thứ Sáu","Thứ Bảy"]},rE={narrow:{am:"am",pm:"pm",midnight:"nửa đêm",noon:"tr",morning:"sg",afternoon:"ch",evening:"tối",night:"đêm"},abbreviated:{am:"AM",pm:"PM",midnight:"nửa đêm",noon:"trưa",morning:"sáng",afternoon:"chiều",evening:"tối",night:"đêm"},wide:{am:"SA",pm:"CH",midnight:"nửa đêm",noon:"trưa",morning:"sáng",afternoon:"chiều",evening:"tối",night:"đêm"}},nE={narrow:{am:"am",pm:"pm",midnight:"nửa đêm",noon:"tr",morning:"sg",afternoon:"ch",evening:"tối",night:"đêm"},abbreviated:{am:"AM",pm:"PM",midnight:"nửa đêm",noon:"trưa",morning:"sáng",afternoon:"chiều",evening:"tối",night:"đêm"},wide:{am:"SA",pm:"CH",midnight:"nửa đêm",noon:"giữa trưa",morning:"vào buổi sáng",afternoon:"vào buổi chiều",evening:"vào buổi tối",night:"vào ban đêm"}},iE=(e,t)=>{const r=Number(e),n=t==null?void 0:t.unit;if(n==="quarter")switch(r){case 1:return"I";case 2:return"II";case 3:return"III";case 4:return"IV"}else if(n==="day")switch(r){case 1:return"thứ 2";case 2:return"thứ 3";case 3:return"thứ 4";case 4:return"thứ 5";case 5:return"thứ 6";case 6:return"thứ 7";case 7:return"chủ nhật"}else{if(n==="week")return r===1?"thứ nhất":"thứ "+r;if(n==="dayOfYear")return r===1?"đầu tiên":"thứ "+r}return String(r)},sE={ordinalNumber:iE,era:Jr({values:qT,defaultWidth:"wide"}),quarter:Jr({values:QT,defaultWidth:"wide",formattingValues:JT,defaultFormattingWidth:"wide",argumentCallback:e=>e-1}),month:Jr({values:ZT,defaultWidth:"wide",formattingValues:eE,defaultFormattingWidth:"wide"}),day:Jr({values:tE,defaultWidth:"wide"}),dayPeriod:Jr({values:rE,defaultWidth:"wide",formattingValues:nE,defaultFormattingWidth:"wide"})},aE=/^(\d+)/i,oE=/\d+/i,lE={narrow:/^(tcn|scn)/i,abbreviated:/^(trước CN|sau CN)/i,wide:/^(trước Công Nguyên|sau Công Nguyên)/i},cE={any:[/^t/i,/^s/i]},uE={narrow:/^([1234]|i{1,3}v?)/i,abbreviated:/^q([1234]|i{1,3}v?)/i,wide:/^quý ([1234]|i{1,3}v?)/i},fE={any:[/(1|i)$/i,/(2|ii)$/i,/(3|iii)$/i,/(4|iv)$/i]},hE={narrow:/^(0?[2-9]|10|11|12|0?1)/i,abbreviated:/^thg[ _]?(0?[1-9](?!\d)|10|11|12)/i,wide:/^tháng ?(Một|Hai|Ba|Tư|Năm|Sáu|Bảy|Tám|Chín|Mười|Mười ?Một|Mười ?Hai|0?[1-9](?!\d)|10|11|12)/i},dE={narrow:[/0?1$/i,/0?2/i,/3/,/4/,/5/,/6/,/7/,/8/,/9/,/10/,/11/,/12/],abbreviated:[/^thg[ _]?0?1(?!\d)/i,/^thg[ _]?0?2/i,/^thg[ _]?0?3/i,/^thg[ _]?0?4/i,/^thg[ _]?0?5/i,/^thg[ _]?0?6/i,/^thg[ _]?0?7/i,/^thg[ _]?0?8/i,/^thg[ _]?0?9/i,/^thg[ _]?10/i,/^thg[ _]?11/i,/^thg[ _]?12/i],wide:[/^tháng ?(Một|0?1(?!\d))/i,/^tháng ?(Hai|0?2)/i,/^tháng ?(Ba|0?3)/i,/^tháng ?(Tư|0?4)/i,/^tháng ?(Năm|0?5)/i,/^tháng ?(Sáu|0?6)/i,/^tháng ?(Bảy|0?7)/i,/^tháng ?(Tám|0?8)/i,/^tháng ?(Chín|0?9)/i,/^tháng ?(Mười|10)/i,/^tháng ?(Mười ?Một|11)/i,/^tháng ?(Mười ?Hai|12)/i]},pE={narrow:/^(CN|T2|T3|T4|T5|T6|T7)/i,short:/^(CN|Th ?2|Th ?3|Th ?4|Th ?5|Th ?6|Th ?7)/i,abbreviated:/^(CN|Th ?2|Th ?3|Th ?4|Th ?5|Th ?6|Th ?7)/i,wide:/^(Chủ ?Nhật|Chúa ?Nhật|thứ ?Hai|thứ ?Ba|thứ ?Tư|thứ ?Năm|thứ ?Sáu|thứ ?Bảy)/i},mE={narrow:[/CN/i,/2/i,/3/i,/4/i,/5/i,/6/i,/7/i],short:[/CN/i,/2/i,/3/i,/4/i,/5/i,/6/i,/7/i],abbreviated:[/CN/i,/2/i,/3/i,/4/i,/5/i,/6/i,/7/i],wide:[/(Chủ|Chúa) ?Nhật/i,/Hai/i,/Ba/i,/Tư/i,/Năm/i,/Sáu/i,/Bảy/i]},gE={narrow:/^(a|p|nửa đêm|trưa|(giờ) (sáng|chiều|tối|đêm))/i,abbreviated:/^(am|pm|nửa đêm|trưa|(giờ) (sáng|chiều|tối|đêm))/i,wide:/^(ch[^i]*|sa|nửa đêm|trưa|(giờ) (sáng|chiều|tối|đêm))/i},xE={any:{am:/^(a|sa)/i,pm:/^(p|ch[^i]*)/i,midnight:/nửa đêm/i,noon:/trưa/i,morning:/sáng/i,afternoon:/chiều/i,evening:/tối/i,night:/^đêm/i}},vE={ordinalNumber:Sg({matchPattern:aE,parsePattern:oE,valueCallback:e=>parseInt(e,10)}),era:Zr({matchPatterns:lE,defaultMatchWidth:"wide",parsePatterns:cE,defaultParseWidth:"any"}),quarter:Zr({matchPatterns:uE,defaultMatchWidth:"wide",parsePatterns:fE,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Zr({matchPatterns:hE,defaultMatchWidth:"wide",parsePatterns:dE,defaultParseWidth:"wide"}),day:Zr({matchPatterns:pE,defaultMatchWidth:"wide",parsePatterns:mE,defaultParseWidth:"wide"}),dayPeriod:Zr({matchPatterns:gE,defaultMatchWidth:"wide",parsePatterns:xE,defaultParseWidth:"any"})},fn={code:"vi",formatDistance:zT,formatLong:KT,formatRelative:YT,localize:sE,match:vE,options:{weekStartsOn:1,firstWeekContainsDate:1}},ir=({label:e,value:t,onChange:r,required:n,className:i,name:s})=>{const[a,o]=ee.useState(""),[l,c]=ee.useState(""),[u,h]=ee.useState(""),[d,m]=ee.useState(null),g=ee.useRef(null),p=ee.useRef(null),v=ee.useRef(null),x=["dd/MM/yyyy","d/M/yyyy","dd-MM-yyyy","d-M/yyyy","dd.MM.yyyy","d.M.yyyy","dd/MM/yy","d/M/yy","dd-MM-yy","d-M-yy","dd.MM.yy","d.M.yy","ddMMyyyy","dMMyyyy","ddMM","dMM"],w=new Date().getFullYear().toString(),y=P=>P.length===1&&P!==""?"0"+P:P,E=P=>P==="00"?"00":P.length===2&&P.startsWith("0")?P.substring(1):P;ee.useEffect(()=>{if(t){const P=Vd(t,"dd/MM/yyyy",new Date,{locale:fn});bl(P)?(o(E(wi(P,"dd",{locale:fn}))),c(E(wi(P,"MM",{locale:fn}))),h(wi(P,"yyyy",{locale:fn})),m(null)):(o(""),c(""),h(w),m("Ngày tháng không hợp lệ từ dữ liệu ban đầu."))}else o(""),c(""),h(w),m(null)},[t,w]);const C=(P,W)=>{let G=P.target.value.replace(/[^0-9]/g,"");W==="day"?(o(G),G.length===2&&p.current&&setTimeout(()=>{var Q;(Q=p.current)==null||Q.focus()},0)):W==="month"?(c(G),G.length===2&&v.current&&setTimeout(()=>{var Q;(Q=v.current)==null||Q.focus()},0)):W==="year"&&h(G)},R=ee.useCallback(()=>{let P=a.trim(),W=l.trim(),G=u.trim();if(m(null),!P&&!W&&!G){r(void 0),o(""),c(""),h(w);return}const Q=parseInt(P,10),ve=parseInt(W,10),ge=parseInt(G,10);let Te=null;P&&(isNaN(Q)||Q<1||Q>31)?Te="Ngày không hợp lệ (1-31).":W&&(isNaN(ve)||ve<1||ve>12)?Te="Tháng không hợp lệ (1-12).":G&&(isNaN(ge)||G.length<2||G.length>4)&&(Te="Năm không hợp lệ.");const Ee=y(P),H=y(W);let q=G,ie=parseInt(q,10);q.length===2&&ie<100?(ie+=2e3,q=ie.toString()):q.length===0&&(q=w);const pe=`${Ee}/${H}/${q}`;let O=null;for(const L of x){const j=Vd(pe,L,new Date,{locale:fn});if(bl(j)){O=j;break}}if(O&&bl(O))o(E(wi(O,"dd",{locale:fn}))),c(E(wi(O,"MM",{locale:fn}))),h(wi(O,"yyyy",{locale:fn})),r(wi(O,"dd/MM/yyyy",{locale:fn})),m(null);else{if(Te)m(Te);else{const L=P.length>0,j=W.length>0,I=G.length>0,X=L&&j&&I&&P.length>=1&&W.length>=1&&G.length>=2||L&&j&&G.length===0&&P.length>=1&&W.length>=1;m(X?"Ngày tháng không hợp lệ. Vui lòng kiểm tra lại.":null)}r(void 0)}},[a,l,u,r,w,x]),D=()=>{R()},F=P=>{},N=P=>{P.key==="Enter"&&(P.preventDefault(),R())};return f.jsxs("div",{className:i,children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[f.jsx(R0,{size:16,className:"inline mr-1"}),e,n&&f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsxs("div",{className:"flex space-x-2",children:[f.jsx("div",{className:"relative w-1/3",children:f.jsx("input",{type:"text",placeholder:"DD",value:a,onChange:P=>C(P,"day"),onBlur:D,onFocus:()=>F(),onKeyDown:N,maxLength:2,ref:g,className:`w-full p-2 border ${d?"border-red-500":"border-gray-300"} rounded-md text-center focus:ring-2 focus:ring-blue-500 focus:border-transparent`,required:n})}),f.jsx("div",{className:"relative w-1/3",children:f.jsx("input",{type:"text",placeholder:"MM",value:l,onChange:P=>C(P,"month"),onBlur:D,onFocus:()=>F(),onKeyDown:N,maxLength:2,ref:p,className:`w-full p-2 border ${d?"border-red-500":"border-gray-300"} rounded-md text-center focus:ring-2 focus:ring-blue-500 focus:border-transparent`,required:n})}),f.jsx("div",{className:"w-1/3",children:f.jsx("input",{type:"text",placeholder:"YYYY",value:u,onChange:P=>C(P,"year"),onBlur:D,onFocus:()=>F(),onKeyDown:N,maxLength:4,ref:v,className:`w-full p-2 border ${d?"border-red-500":"border-gray-300"} rounded-md text-center focus:ring-2 focus:ring-blue-500 focus:border-transparent`,required:n})})]}),d&&f.jsx("p",{className:"mt-1 text-sm text-red-600",children:d})]})},bo=[{article:"1",title:"Nhiệm vụ của Bộ luật hình sự",description:""},{article:"2",title:"Cơ sở của trách nhiệm hình sự",description:""},{article:"3",title:"Nguyên tắc xử lý",description:""},{article:"4",title:"Trách nhiệm phòng ngừa và đấu tranh chống tội phạm",description:""}],li=e=>`Điều ${e.article} - ${e.title}`,yE=({onAddCase:e,prosecutors:t})=>{const[r,n]=ee.useState({name:"",charges:"",investigationDeadline:lt(),prosecutor:"",notes:"",defendants:[{name:"",charges:"",preventiveMeasure:"Tại ngoại"}]}),i=u=>{u.preventDefault();let h={...r};if(!r.name.trim()&&r.defendants.length>0&&r.defendants[0].name.trim()){const d=r.defendants[0],m=`${d.name} - ${d.charges||"Chưa xác định tội danh"}`;h.name=m}if(!r.charges.trim()&&r.defendants.length>0&&r.defendants[0].charges.trim()&&(h.charges=r.defendants[0].charges),!h.name.trim()||!h.charges.trim()||!h.investigationDeadline.trim()||!h.prosecutor.trim()){alert("Vui lòng điền đầy đủ các trường bắt buộc: Tên Vụ Án, Tội danh, Thời hạn Điều tra, và Kiểm sát viên Phụ Trách.");return}e(h),n({name:"",charges:"",investigationDeadline:lt(),prosecutor:"",notes:"",defendants:[{name:"",charges:"",preventiveMeasure:"Tại ngoại"}]})},s=()=>{n({...r,defendants:[...r.defendants,{name:"",charges:"",preventiveMeasure:"Tại ngoại"}]})},a=u=>{n({...r,defendants:r.defendants.filter((h,d)=>d!==u)})},o=(u,h,d)=>{const m=r.defendants.map((g,p)=>{if(p===u){const v={...g,[h]:d};return h==="preventiveMeasure"&&d==="Tại ngoại"&&delete v.detentionDeadline,v}return g});n({...r,defendants:m}),u===0&&h==="charges"&&!r.charges.trim()&&n(g=>({...g,charges:d,defendants:m}))},l=bo.map(u=>({value:li(u),label:li(u),description:u.description})),c=t.map(u=>({value:u.name,label:u.name,description:`${u.title}${u.department?` - ${u.department}`:""}`}));return f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[f.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[f.jsx(si,{className:"text-blue-600",size:24}),"Thêm Vụ Án Mới"]}),f.jsxs("form",{onSubmit:i,className:"space-y-6",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[f.jsx(De,{size:16,className:"inline mr-1"}),"Tên Vụ Án ",f.jsx("span",{className:"text-gray-500 text-xs",children:"(để trống sẽ tự động tạo từ tên bị can đầu tiên)"})]}),f.jsx("input",{type:"text",value:r.name,onChange:u=>n({...r,name:u.target.value}),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nhập tên vụ án hoặc để trống để tự động tạo"})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[f.jsx(ai,{size:16,className:"inline mr-1"}),"Tội Danh Vụ Án (Điều, Khoản) ",f.jsx("span",{className:"text-gray-500 text-xs",children:"(tự động từ bị can số 1)"})]}),f.jsx(sn,{value:r.charges,onChange:u=>n({...r,charges:u}),options:l,placeholder:"Nhập hoặc tìm kiếm tội danh",required:!0,icon:f.jsx(ai,{size:16})})]}),f.jsx(ir,{value:r.investigationDeadline,onChange:u=>n({...r,investigationDeadline:u}),label:"Thời Hạn Điều Tra",required:!0}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[f.jsx(Nn,{size:16,className:"inline mr-1"}),"Kiểm Sát Viên Phụ Trách"]}),f.jsx(sn,{value:r.prosecutor,onChange:u=>n({...r,prosecutor:u}),options:c,placeholder:"Nhập hoặc chọn kiểm sát viên",required:!0,icon:f.jsx(Nn,{size:16})})]}),f.jsxs("div",{className:"md:col-span-2",children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[f.jsx(De,{size:16,className:"inline mr-1"}),"Ghi Chú"]}),f.jsx("textarea",{value:r.notes||"",onChange:u=>n({...r,notes:u.target.value}),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nhập ghi chú (tùy chọn)",rows:3})]})]}),f.jsxs("div",{className:"border-t pt-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Thông Tin Bị Can"}),f.jsxs("button",{type:"button",onClick:s,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[f.jsx(si,{size:16}),"Thêm Bị Can"]})]}),r.defendants.map((u,h)=>f.jsxs("div",{className:"bg-gray-50 p-4 rounded-md mb-4",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsxs("h4",{className:"text-lg font-medium text-gray-700",children:["Bị Can ",h+1," ",h===0&&f.jsx("span",{className:"text-sm text-blue-600",children:"(tội danh sẽ tự động áp dụng cho vụ án)"})]}),r.defendants.length>1&&f.jsxs("button",{type:"button",onClick:()=>a(h),className:"flex items-center gap-1 px-3 py-1 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm",children:[f.jsx(pg,{size:14}),"Xóa Bị Can Này"]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tên Bị Can"}),f.jsx("input",{type:"text",value:u.name,onChange:d=>o(h,"name",d.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tội Danh Bị Can (Điều, Khoản)"}),f.jsx(sn,{value:u.charges,onChange:d=>o(h,"charges",d),options:l,placeholder:"Nhập hoặc tìm kiếm tội danh",required:!0,className:"p-2"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Biện Pháp Ngăn Chặn"}),f.jsxs("select",{value:u.preventiveMeasure,onChange:d=>o(h,"preventiveMeasure",d.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[f.jsx("option",{value:"Tại ngoại",children:"Tại ngoại"}),f.jsx("option",{value:"Tạm giam",children:"Tạm giam"})]})]}),u.preventiveMeasure==="Tạm giam"&&f.jsx(ir,{value:u.detentionDeadline||"",onChange:d=>o(h,"detentionDeadline",d),label:"Thời Hạn Tạm Giam",required:!0,className:"col-span-1"})]})]},h))]}),f.jsx("div",{className:"flex justify-end",children:f.jsx("button",{type:"submit",className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors font-medium",children:"Thêm Vụ Án"})})]})]})},jg=[],wE=({case:e,onSave:t,onClose:r})=>{const[n,i]=ee.useState({...e}),[s,a]=ee.useState(!1),[o,l]=ee.useState(!1),c=x=>{x.preventDefault();let w=!0,y="";if(n.investigationDeadline||(w=!1,y="Vui lòng nhập Thời Hạn Điều Tra."),n.stage==="Truy tố"&&!n.prosecutionTransferDate&&(w=!1,y=(y?y+`
`:"")+"Vui lòng nhập Ngày Chuyển Truy Tố."),n.stage==="Xét xử"&&!n.trialTransferDate&&(w=!1,y=(y?y+`
`:"")+"Vui lòng nhập Ngày Chuyển Xét Xử."),n.defendants.every(C=>C.preventiveMeasure!=="Tạm giam"||C.detentionDeadline)||(w=!1,y=(y?y+`
`:"")+"Vui lòng nhập đầy đủ Thời Hạn Tạm Giam cho tất cả bị can bị tạm giam."),!w){alert(y||"Vui lòng nhập đầy đủ các trường ngày bắt buộc.");return}s?l(!0):r()},u=()=>{t(n),r()},h=x=>{i(w=>{const y={...w,...x};return"stage"in x&&x.stage!==w.stage&&(x.stage!=="Truy tố"&&(y.prosecutionTransferDate=void 0),x.stage!=="Xét xử"&&(y.trialTransferDate=void 0)),y}),a(!0)},d=()=>{const x={id:Date.now().toString()+Math.random().toString(36).substr(2,9),name:"",charges:"",preventiveMeasure:"Tại ngoại"};h({defendants:[...n.defendants,x]})},m=x=>{h({defendants:n.defendants.filter((w,y)=>y!==x)})},g=(x,w,y)=>{const E=n.defendants.map((C,R)=>{if(R===x){let D={...C,[w]:y};return w==="preventiveMeasure"&&(y==="Tạm giam"?D.detentionDeadline=C.detentionDeadline||n.investigationDeadline:D.detentionDeadline=void 0),D}return C});i({...n,defendants:E}),a(!0)},p=bo.map(x=>({value:li(x),label:li(x),description:x.description})),v=jg.map(x=>({value:x.name,label:x.name,description:`${x.title}${x.department?` - ${x.department}`:""}`}));return f.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:[f.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[f.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Chỉnh Sửa Vụ Án"}),f.jsx("button",{onClick:r,className:"text-gray-500 hover:text-gray-700",children:f.jsx(zs,{size:24})})]}),f.jsxs("form",{onSubmit:c,className:"p-6 space-y-6",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[f.jsx(De,{size:16,className:"inline mr-1"}),"Tên Vụ Án"]}),f.jsx("input",{type:"text",value:n.name,onChange:x=>h({name:x.target.value}),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[f.jsx(ai,{size:16,className:"inline mr-1"}),"Tội Danh Vụ Án (Điều, Khoản)"]}),f.jsx(sn,{value:n.charges,onChange:x=>h({charges:x}),options:p,placeholder:"Nhập hoặc tìm kiếm tội danh",required:!0,icon:f.jsx(ai,{size:16})})]}),n.stage==="Điều tra"&&f.jsx(ir,{value:n.investigationDeadline,onChange:x=>h({investigationDeadline:x||""}),label:"Thời Hạn Điều Tra",required:!0}),n.stage==="Truy tố"&&f.jsx(ir,{value:n.prosecutionTransferDate,onChange:x=>h({prosecutionTransferDate:x||""}),label:"Ngày Chuyển Truy Tố",required:!0}),n.stage==="Xét xử"&&f.jsx(ir,{value:n.trialTransferDate,onChange:x=>h({trialTransferDate:x||""}),label:"Ngày Chuyển Xét Xử",required:!0}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[f.jsx(Nn,{size:16,className:"inline mr-1"}),"Kiểm Sát Viên Phụ Trách"]}),f.jsx(sn,{value:n.prosecutor,onChange:x=>h({prosecutor:x}),options:v,placeholder:"Nhập hoặc chọn kiểm sát viên",required:!0,icon:f.jsx(Nn,{size:16})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Giai Đoạn"}),f.jsxs("select",{value:n.stage,onChange:x=>h({stage:x.target.value}),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[f.jsx("option",{value:"Điều tra",children:"Điều tra"}),f.jsx("option",{value:"Truy tố",children:"Truy tố"}),f.jsx("option",{value:"Xét xử",children:"Xét xử"}),f.jsx("option",{value:"Hoàn thành",children:"Hoàn thành"}),f.jsx("option",{value:"Tạm đình chỉ",children:"Tạm đình chỉ"}),f.jsx("option",{value:"Đình chỉ",children:"Đình chỉ"}),f.jsx("option",{value:"Chuyển đi",children:"Chuyển đi"})]})]}),f.jsxs("div",{className:"md:col-span-2",children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[f.jsx(De,{size:16,className:"inline mr-1"}),"Ghi Chú"]}),f.jsx("textarea",{value:n.notes||"",onChange:x=>h({notes:x.target.value}),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nhập ghi chú (tùy chọn)",rows:3})]})]}),f.jsxs("div",{className:"border-t pt-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Thông Tin Bị Can"}),f.jsxs("button",{type:"button",onClick:d,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[f.jsx(si,{size:16}),"Thêm Bị Can"]})]}),n.defendants.map((x,w)=>f.jsxs("div",{className:"bg-gray-50 p-4 rounded-md mb-4",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsxs("h4",{className:"text-lg font-medium text-gray-700",children:["Bị Can ",w+1]}),n.defendants.length>1&&f.jsxs("button",{type:"button",onClick:()=>m(w),className:"flex items-center gap-1 px-3 py-1 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm",children:[f.jsx(pg,{size:14}),"Xóa"]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tên Bị Can"}),f.jsx("input",{type:"text",value:x.name,onChange:y=>g(w,"name",y.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tội Danh Bị Can (Điều, Khoản)"}),f.jsx(sn,{value:x.charges,onChange:y=>g(w,"charges",y),options:p,placeholder:"Nhập hoặc tìm kiếm tội danh",required:!0,className:"p-2"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Biện Pháp Ngăn Chặn"}),f.jsxs("select",{value:x.preventiveMeasure,onChange:y=>g(w,"preventiveMeasure",y.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[f.jsx("option",{value:"Tại ngoại",children:"Tại ngoại"}),f.jsx("option",{value:"Tạm giam",children:"Tạm giam"})]})]}),x.preventiveMeasure==="Tạm giam"&&f.jsx(ir,{value:x.detentionDeadline,onChange:y=>g(w,"detentionDeadline",y),label:"Thời Hạn Tạm Giam",required:!0,className:"col-span-1"})]})]},x.id))]}),f.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t",children:[f.jsx("button",{type:"button",onClick:r,className:"px-6 py-3 text-gray-600 hover:text-gray-800 transition-colors",children:"Hủy"}),f.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors font-medium",children:[f.jsx(ho,{size:16}),s?"Lưu Thay Đổi":"Đóng"]})]})]})]}),o&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-60",children:f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl max-w-sm w-full mx-4",children:[f.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center gap-2",children:[f.jsx(Vf,{className:"text-blue-600",size:20}),"Xác nhận lưu thay đổi"]}),f.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Bạn có muốn lưu các thay đổi đã thực hiện không?"}),f.jsxs("div",{className:"flex justify-end gap-3",children:[f.jsx("button",{onClick:()=>l(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Hủy"}),f.jsx("button",{onClick:()=>r(),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:"Không lưu"}),f.jsx("button",{onClick:u,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Lưu thay đổi"})]})]})})]})},_E=({case:e,onSave:t,onClose:r})=>{const[n,i]=ee.useState(e.notes||""),s=a=>{a.preventDefault();const o={...e,notes:n};t(o),r()};return f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full",children:[f.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[f.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[f.jsx(dg,{className:"text-blue-600",size:20}),"Ghi Chú - ",e.name]}),f.jsx("button",{onClick:r,className:"text-gray-500 hover:text-gray-700",children:f.jsx(zs,{size:24})})]}),f.jsxs("form",{onSubmit:s,className:"p-6",children:[f.jsxs("div",{className:"mb-4",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nội dung ghi chú"}),f.jsx("textarea",{value:n,onChange:a=>i(a.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nhập ghi chú cho vụ án...",rows:8})]}),f.jsxs("div",{className:"flex justify-end gap-3",children:[f.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Hủy"}),f.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[f.jsx(ho,{size:16}),"Lưu Ghi Chú"]})]})]})]})})},TE=({case:e,type:t,defendant:r,onSave:n,onClose:i})=>{const[s,a]=ee.useState(1),[o,l]=ee.useState(t==="investigation"?"months":"days"),c=()=>t==="investigation"?e.investigationDeadline:r&&r.detentionDeadline||"",u=()=>{const p=c();if(!p)return"";const v=qt(p),x=new Date(v);return o==="months"?x.setMonth(x.getMonth()+s):x.setDate(x.getDate()+s),Kf(x)},h=p=>{p.preventDefault();const v=u();if(t==="investigation"){const x={...e,investigationDeadline:v};n(x)}else if(r){const x=e.defendants.map(y=>y.id===r.id?{...y,detentionDeadline:v}:y),w={...e,defendants:x};n(w)}i()},d=t==="investigation"?"Gia Hạn Điều Tra":`Gia Hạn Tạm Giam - ${r==null?void 0:r.name}`,m=c(),g=u();return f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[f.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[f.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[f.jsx(fo,{className:"text-blue-600",size:20}),d]}),f.jsx("button",{onClick:i,className:"text-gray-500 hover:text-gray-700",children:f.jsx(zs,{size:24})})]}),f.jsxs("form",{onSubmit:h,className:"p-6",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[f.jsx("h3",{className:"font-medium text-gray-700 mb-2",children:"Thông tin hiện tại"}),f.jsxs("p",{className:"text-sm text-gray-600",children:[f.jsx(R0,{size:14,className:"inline mr-1"}),"Hạn hiện tại: ",f.jsx("span",{className:"font-medium",children:m})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Thời gian gia hạn"}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx("input",{type:"number",min:"1",max:t==="investigation"?12:365,value:s,onChange:p=>a(parseInt(p.target.value)||1),className:"flex-1 p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),f.jsx("select",{value:o,onChange:p=>l(p.target.value),className:"p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:t==="investigation",children:t==="investigation"?f.jsx("option",{value:"months",children:"Tháng"}):f.jsxs(f.Fragment,{children:[f.jsx("option",{value:"days",children:"Ngày"}),f.jsx("option",{value:"months",children:"Tháng"})]})})]})]}),g&&f.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[f.jsx("h3",{className:"font-medium text-blue-700 mb-2",children:"Hạn mới sau gia hạn"}),f.jsxs("p",{className:"text-sm text-blue-600",children:[f.jsx(R0,{size:14,className:"inline mr-1"}),"Hạn mới: ",f.jsx("span",{className:"font-medium",children:g})]})]})]}),f.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[f.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Hủy"}),f.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[f.jsx(fo,{size:16}),"Gia Hạn"]})]})]})]})})},EE=({cases:e,columns:t,onDeleteCase:r,onTransferStage:n,onUpdateCase:i,showWarnings:s=!1})=>{const[a,o]=ee.useState(new Set),[l,c]=ee.useState(null),[u,h]=ee.useState(null),[d,m]=ee.useState(new Set),[g,p]=ee.useState(null),[v,x]=ee.useState(null),w=N=>{const P=new Set(a);P.has(N)?P.delete(N):P.add(N),o(P)},y=N=>{const P=new Set(d);P.has(N)?P.delete(N):P.add(N),m(P)},E=N=>{const P=[];switch(N.stage){case"Điều tra":P.push(f.jsxs("button",{onClick:()=>n(N.id,"Truy tố"),className:"flex items-center gap-1 px-2 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-700 transition-colors whitespace-nowrap",children:[f.jsx(F0,{size:12}),"Chuyển TT"]},"prosecution"));break;case"Truy tố":P.push(f.jsxs("button",{onClick:()=>n(N.id,"Xét xử"),className:"flex items-center gap-1 px-2 py-1 bg-purple-600 text-white rounded text-xs hover:bg-purple-700 transition-colors whitespace-nowrap",children:[f.jsx(F0,{size:12}),"Chuyển XX"]},"trial"));break;case"Xét xử":P.push(f.jsxs("button",{onClick:()=>n(N.id,"Hoàn thành"),className:"flex items-center gap-1 px-2 py-1 bg-green-600 text-white rounded text-xs hover:bg-green-700 transition-colors whitespace-nowrap",children:[f.jsx(Vf,{size:12}),"Hoàn thành"]},"complete"));break}return["Hoàn thành","Đình chỉ","Chuyển đi"].includes(N.stage)||(P.push(f.jsxs("button",{onClick:()=>n(N.id,"Chuyển đi"),className:"flex items-center gap-1 px-2 py-1 bg-cyan-600 text-white rounded text-xs hover:bg-cyan-700 transition-colors whitespace-nowrap",children:[f.jsx(vg,{size:12}),"Chuyển đi"]},"transfer")),P.push(f.jsxs("button",{onClick:()=>n(N.id,"Tạm đình chỉ"),className:"flex items-center gap-1 px-2 py-1 bg-amber-600 text-white rounded text-xs hover:bg-amber-700 transition-colors whitespace-nowrap",children:[f.jsx(gg,{size:12}),"Tạm ĐC"]},"suspend")),P.push(f.jsxs("button",{onClick:()=>n(N.id,"Đình chỉ"),className:"flex items-center gap-1 px-2 py-1 bg-red-600 text-white rounded text-xs hover:bg-red-700 transition-colors whitespace-nowrap",children:[f.jsx(H2,{size:12}),"Đình chỉ"]},"discontinue"))),P},C=N=>f.jsxs("div",{className:"max-w-xs",children:[f.jsx("div",{className:"font-medium text-gray-900 truncate",title:N.name,children:N.name}),f.jsx("div",{className:"text-sm text-gray-500 truncate",title:N.charges,children:N.charges})]}),R=N=>f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("button",{onClick:()=>p(N),className:"flex items-center gap-1 px-2 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-700 transition-colors",title:"Xem/Sửa ghi chú",children:[f.jsx(dg,{size:12}),"Ghi chú"]}),N.notes&&f.jsx("div",{className:"max-w-xs",children:f.jsx("div",{className:"text-sm text-gray-600 truncate",title:N.notes,children:N.notes})})]}),D=(N,P)=>{switch(P.key){case"name":return C(N);case"totalDefendants":return`${N.defendants.length} bị can`;case"shortestDetention":const W=N.defendants.filter(H=>H.preventiveMeasure==="Tạm giam"&&H.detentionDeadline);return W.length===0?"Không có":`${Math.min(...W.map(H=>Gn(H.detentionDeadline)))} ngày`;case"investigationRemaining":return`${Gn(N.investigationDeadline)} ngày`;case"shortestDetentionRemaining":const ve=N.defendants.filter(H=>H.preventiveMeasure==="Tạm giam"&&H.detentionDeadline);return ve.length===0?"Không có":`${Math.min(...ve.map(H=>Gn(H.detentionDeadline)))} ngày`;case"notes":return R(N);case"actions":const Te=E(N),Ee=d.has(N.id);return f.jsxs("div",{className:"relative",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs("button",{onClick:()=>h(N),className:"flex items-center gap-1 px-2 py-1 bg-yellow-600 text-white rounded text-xs hover:bg-yellow-700 transition-colors whitespace-nowrap",children:[f.jsx(Jl,{size:12}),"Sửa"]}),N.stage==="Điều tra"&&f.jsxs("button",{onClick:()=>x({case:N,type:"investigation"}),className:"flex items-center gap-1 px-2 py-1 bg-orange-600 text-white rounded text-xs hover:bg-orange-700 transition-colors whitespace-nowrap",children:[f.jsx(fo,{size:12}),"Gia hạn ĐT"]}),Te.length>0&&Te[0],Te.length>1&&f.jsx("button",{onClick:()=>y(N.id),className:"flex items-center gap-1 px-2 py-1 bg-gray-600 text-white rounded text-xs hover:bg-gray-700 transition-colors",children:f.jsx(mg,{size:12})})]}),Ee&&Te.length>1&&f.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded shadow-lg z-10 min-w-max",children:f.jsxs("div",{className:"p-2 space-y-1",children:[Te.slice(1).map((H,q)=>f.jsx("div",{className:"block",children:H},q)),f.jsxs("button",{onClick:()=>c(N.id),className:"flex items-center gap-1 px-2 py-1 bg-red-600 text-white rounded text-xs hover:bg-red-700 transition-colors whitespace-nowrap w-full",children:[f.jsx(Zl,{size:12}),"Xóa"]})]})})]});default:return P.render?P.render(N):N[P.key]}},F=N=>s?N.stage==="Điều tra"&&Su(N.investigationDeadline)?!0:N.defendants.filter(W=>W.preventiveMeasure==="Tạm giam"&&W.detentionDeadline).some(W=>Su(W.detentionDeadline)):!1;return f.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mở rộng"}),t.map(N=>f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:N.label},N.key))]})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(N=>f.jsxs(l1.Fragment,{children:[f.jsxs("tr",{className:`${F(N)?"bg-yellow-50":"hover:bg-gray-50"}`,children:[f.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f.jsx("button",{onClick:()=>w(N.id),className:"text-gray-500 hover:text-gray-700",children:a.has(N.id)?f.jsx(Gf,{size:20}):f.jsx(hg,{size:20})})}),t.map(P=>f.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:D(N,P)},P.key))]}),a.has(N.id)&&f.jsx("tr",{children:f.jsx("td",{colSpan:t.length+1,className:"px-6 py-4 bg-gray-50",children:f.jsxs("div",{className:"space-y-2",children:[f.jsx("h4",{className:"font-medium text-gray-900",children:"Chi tiết Bị Can:"}),N.defendants.map((P,W)=>f.jsx("div",{className:"bg-white p-3 rounded border",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 text-sm",children:[f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Tên:"})," ",P.name]}),f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Tội danh:"})," ",P.charges]}),f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Biện pháp:"})," ",P.preventiveMeasure]}),P.preventiveMeasure==="Tạm giam"&&P.detentionDeadline&&f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Hạn tạm giam:"})," ",P.detentionDeadline,f.jsxs("span",{className:`ml-2 ${Su(P.detentionDeadline)?"text-red-600 font-medium":"text-gray-600"}`,children:["(",Gn(P.detentionDeadline)," ngày)"]})]}),f.jsxs("button",{onClick:()=>x({case:N,type:"detention",defendant:P}),className:"flex items-center gap-1 px-2 py-1 bg-orange-600 text-white rounded text-xs hover:bg-orange-700 transition-colors",children:[f.jsx(fo,{size:12}),"Gia hạn"]})]})]})},W))]})})})]},N.id))})]})}),e.length===0&&f.jsx("div",{className:"text-center py-8 text-gray-500",children:"Không có vụ án nào"}),u&&f.jsx(wE,{case:u,onSave:i,onClose:()=>h(null)}),g&&f.jsx(_E,{case:g,onSave:i,onClose:()=>p(null)}),v&&f.jsx(TE,{case:v.case,type:v.type,defendant:v.defendant,onSave:i,onClose:()=>x(null)}),l&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl max-w-sm w-full mx-4",children:[f.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Xác nhận xóa"}),f.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Bạn có chắc chắn muốn xóa vụ án này không? Hành động này không thể hoàn tác."}),f.jsxs("div",{className:"flex justify-end gap-3",children:[f.jsx("button",{onClick:()=>c(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Hủy"}),f.jsx("button",{onClick:()=>{r(l),c(null)},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Xóa"})]})]})})]})};class SE{constructor(){this.dbName="LegalCaseManagement",this.version=1,this.db=null}async init(){return new Promise((t,r)=>{const n=indexedDB.open(this.dbName,this.version);n.onerror=()=>r(n.error),n.onsuccess=()=>{this.db=n.result,t()},n.onupgradeneeded=i=>{const s=i.target.result;s.objectStoreNames.contains("cases")||s.createObjectStore("cases",{keyPath:"id"}),s.objectStoreNames.contains("reports")||s.createObjectStore("reports",{keyPath:"id"}),s.objectStoreNames.contains("criminalCode")||s.createObjectStore("criminalCode",{keyPath:"article"}),s.objectStoreNames.contains("prosecutors")||s.createObjectStore("prosecutors",{keyPath:"id"}),s.objectStoreNames.contains("userData")||s.createObjectStore("userData",{keyPath:"key"})}})}async saveData(t,r){if(!this.db)throw new Error("Database not initialized");const i=this.db.transaction([t],"readwrite").objectStore(t);await new Promise((s,a)=>{const o=i.clear();o.onsuccess=()=>s(),o.onerror=()=>a(o.error)});for(const s of r)await new Promise((a,o)=>{const l=i.add(s);l.onsuccess=()=>a(),l.onerror=()=>o(l.error)})}async loadData(t){if(!this.db)throw new Error("Database not initialized");return new Promise((r,n)=>{const a=this.db.transaction([t],"readonly").objectStore(t).getAll();a.onsuccess=()=>r(a.result),a.onerror=()=>n(a.error)})}async saveUserData(t,r){if(!this.db)throw new Error("Database not initialized");const i=this.db.transaction(["userData"],"readwrite").objectStore("userData");return new Promise((s,a)=>{const o=i.put({key:t,data:r});o.onsuccess=()=>s(),o.onerror=()=>a(o.error)})}async loadUserData(t){if(!this.db)throw new Error("Database not initialized");return new Promise((r,n)=>{const a=this.db.transaction(["userData"],"readonly").objectStore("userData").get(t);a.onsuccess=()=>{var o;return r((o=a.result)==null?void 0:o.data)},a.onerror=()=>n(a.error)})}async exportAllData(){const[t,r,n,i]=await Promise.all([this.loadData("cases"),this.loadData("reports"),this.loadData("criminalCode"),this.loadData("prosecutors")]);return{cases:t,reports:r,criminalCode:n,prosecutors:i}}async importAllData(t){await Promise.all([this.saveData("cases",t.cases||[]),this.saveData("reports",t.reports||[]),this.saveData("criminalCode",t.criminalCode||[]),this.saveData("prosecutors",t.prosecutors||[])])}}const wn=new SE,Ig=()=>{const[e,t]=ee.useState(!1);return ee.useEffect(()=>{(async()=>{try{await wn.init(),t(!0)}catch(s){console.error("Failed to initialize IndexedDB:",s)}})()},[]),{isInitialized:e,exportData:async()=>{try{const i=await wn.exportAllData(),s=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),a=URL.createObjectURL(s),o=document.createElement("a");return o.href=a,o.download=`legal-system-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a),!0}catch(i){return console.error("Export failed:",i),!1}},importData:async i=>{try{const s=await i.text(),a=JSON.parse(s);return await wn.importAllData(a),!0}catch(s){return console.error("Import failed:",s),!1}}}},kE="modulepreload",CE=function(e,t){return new URL(e,t).href},Gd={},No=function(t,r,n){let i=Promise.resolve();if(r&&r.length>0){const a=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(r.map(c=>{if(c=CE(c,n),c in Gd)return;Gd[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(!!n)for(let g=a.length-1;g>=0;g--){const p=a[g];if(p.href===c&&(!u||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${h}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":kE,u||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),u)return new Promise((g,p)=>{m.addEventListener("load",g),m.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},bE=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>No(async()=>{const{default:n}=await Promise.resolve().then(()=>Qs);return{default:n}},void 0,import.meta.url).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class Qf extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class NE extends Qf{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Kd extends Qf{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Xd extends Qf{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var M0;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(M0||(M0={}));var AE=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(h){a(h)}}function l(u){try{c(n.throw(u))}catch(h){a(h)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class DE{constructor(t,{headers:r={},customFetch:n,region:i=M0.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=bE(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return AE(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:a}=r;let o={},{region:l}=r;l||(l=this.region);const c=new URL(`${this.url}/${t}`);l&&l!=="any"&&(o["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=a):typeof a=="string"?(o["Content-Type"]="text/plain",u=a):typeof FormData<"u"&&a instanceof FormData?u=a:(o["Content-Type"]="application/json",u=JSON.stringify(a)));const h=yield this.fetch(c.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),i),body:u}).catch(p=>{throw new NE(p)}),d=h.headers.get("x-relay-error");if(d&&d==="true")throw new Kd(h);if(!h.ok)throw new Xd(h);let m=((n=h.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),g;return m==="application/json"?g=yield h.json():m==="application/octet-stream"?g=yield h.blob():m==="text/event-stream"?g=h:m==="multipart/form-data"?g=yield h.formData():g=yield h.text(),{data:g,error:null,response:h}}catch(i){return{data:null,error:i,response:i instanceof Xd||i instanceof Kd?i.context:void 0}}})}}var rr={},Jf={},Rc={},Ao={},jc={},Ic={},OE=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Vs=OE();const PE=Vs.fetch,Lg=Vs.fetch.bind(Vs),Mg=Vs.Headers,FE=Vs.Request,RE=Vs.Response,Qs=Object.freeze(Object.defineProperty({__proto__:null,Headers:Mg,Request:FE,Response:RE,default:Lg,fetch:PE},Symbol.toStringTag,{value:"Module"})),jE=ay(Qs);var Lc={};Object.defineProperty(Lc,"__esModule",{value:!0});let IE=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Lc.default=IE;var Bg=Dt&&Dt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ic,"__esModule",{value:!0});const LE=Bg(jE),ME=Bg(Lc);let BE=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=LE.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var a,o,l;let c=null,u=null,h=null,d=s.status,m=s.statusText;if(s.ok){if(this.method!=="HEAD"){const x=await s.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=x:u=JSON.parse(x))}const p=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),v=(o=s.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");p&&v&&v.length>1&&(h=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,d=406,m="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const p=await s.text();try{c=JSON.parse(p),Array.isArray(c)&&s.status===404&&(u=[],c=null,d=200,m="OK")}catch{s.status===404&&p===""?(d=204,m="No Content"):c={message:p}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,d=200,m="OK"),c&&this.shouldThrowOnError)throw new ME.default(c)}return{error:c,data:u,count:h,status:d,statusText:m}});return this.shouldThrowOnError||(i=i.catch(s=>{var a,o,l;return{error:{message:`${(a=s==null?void 0:s.name)!==null&&a!==void 0?a:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(t,r)}returns(){return this}overrideTypes(){return this}};Ic.default=BE;var UE=Dt&&Dt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(jc,"__esModule",{value:!0});const $E=UE(Ic);let HE=class extends $E.default{select(t){let r=!1;const n=(t??"*").split("").map(i=>/\s/.test(i)&&!r?"":(i==='"'&&(r=!r),i)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:i,referencedTable:s=i}={}){const a=s?`${s}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:i=n}={}){const s=typeof i>"u"?"offset":`${i}.offset`,a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(a,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:i=!1,wal:s=!1,format:a="text"}={}){var o;const l=[t?"analyze":null,r?"verbose":null,n?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${c}"; options=${l};`,a==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};jc.default=HE;var zE=Dt&&Dt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ao,"__esModule",{value:!0});const WE=zE(jc);let VE=class extends WE.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const a=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${a}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const i=n?`${n}.or`:"or";return this.url.searchParams.append(i,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};Ao.default=VE;var GE=Dt&&Dt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Rc,"__esModule",{value:!0});const va=GE(Ao);let KE=class{constructor(t,{headers:r={},schema:n,fetch:i}){this.url=t,this.headers=r,this.schema=n,this.fetch=i}select(t,{head:r=!1,count:n}={}){const i=r?"HEAD":"GET";let s=!1;const a=(t??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",a),n&&(this.headers.Prefer=`count=${n}`),new va.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const i="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),n||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(t)){const a=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new va.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:i,defaultToNull:s=!0}={}){const a="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),i&&o.push(`count=${i}`),s||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const l=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new va.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),this.headers.Prefer=i.join(","),new va.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new va.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Rc.default=KE;var Mc={},Bc={};Object.defineProperty(Bc,"__esModule",{value:!0});Bc.version=void 0;Bc.version="0.0.0-automated";Object.defineProperty(Mc,"__esModule",{value:!0});Mc.DEFAULT_HEADERS=void 0;const XE=Bc;Mc.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${XE.version}`};var Ug=Dt&&Dt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Jf,"__esModule",{value:!0});const YE=Ug(Rc),qE=Ug(Ao),QE=Mc;let JE=class $g{constructor(t,{headers:r={},schema:n,fetch:i}={}){this.url=t,this.headers=Object.assign(Object.assign({},QE.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=i}from(t){const r=new URL(`${this.url}/${t}`);return new YE.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new $g(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:i=!1,count:s}={}){let a;const o=new URL(`${this.url}/rpc/${t}`);let l;n||i?(a=n?"HEAD":"GET",Object.entries(r).filter(([u,h])=>h!==void 0).map(([u,h])=>[u,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([u,h])=>{o.searchParams.append(u,h)})):(a="POST",l=r);const c=Object.assign({},this.headers);return s&&(c.Prefer=`count=${s}`),new qE.default({method:a,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};Jf.default=JE;var Js=Dt&&Dt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(rr,"__esModule",{value:!0});rr.PostgrestError=rr.PostgrestBuilder=rr.PostgrestTransformBuilder=rr.PostgrestFilterBuilder=rr.PostgrestQueryBuilder=rr.PostgrestClient=void 0;const Hg=Js(Jf);rr.PostgrestClient=Hg.default;const zg=Js(Rc);rr.PostgrestQueryBuilder=zg.default;const Wg=Js(Ao);rr.PostgrestFilterBuilder=Wg.default;const Vg=Js(jc);rr.PostgrestTransformBuilder=Vg.default;const Gg=Js(Ic);rr.PostgrestBuilder=Gg.default;const Kg=Js(Lc);rr.PostgrestError=Kg.default;var ZE=rr.default={PostgrestClient:Hg.default,PostgrestQueryBuilder:zg.default,PostgrestFilterBuilder:Wg.default,PostgrestTransformBuilder:Vg.default,PostgrestBuilder:Gg.default,PostgrestError:Kg.default};const{PostgrestClient:eS,PostgrestQueryBuilder:JD,PostgrestFilterBuilder:ZD,PostgrestTransformBuilder:eO,PostgrestBuilder:tO,PostgrestError:rO}=ZE;function tS(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const rS=tS(),nS="2.11.15",iS=`realtime-js/${nS}`,sS="1.0.0",Xg=1e4,aS=1e3;var Ma;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Ma||(Ma={}));var Ut;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Ut||(Ut={}));var Br;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Br||(Br={}));var B0;(function(e){e.websocket="websocket"})(B0||(B0={}));var bi;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(bi||(bi={}));class oS{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const i=r.getUint8(1),s=r.getUint8(2);let a=this.HEADER_LENGTH+2;const o=n.decode(t.slice(a,a+i));a=a+i;const l=n.decode(t.slice(a,a+s));a=a+s;const c=JSON.parse(n.decode(t.slice(a,t.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class Yg{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ze;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ze||(ze={}));const Yd=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((s,a)=>(s[a]=lS(a,e,t,i),s),{})},lS=(e,t,r,n)=>{const i=t.find(o=>o.name===e),s=i==null?void 0:i.type,a=r[e];return s&&!n.includes(s)?qg(s,a):U0(a)},qg=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return hS(t,r)}switch(e){case ze.bool:return cS(t);case ze.float4:case ze.float8:case ze.int2:case ze.int4:case ze.int8:case ze.numeric:case ze.oid:return uS(t);case ze.json:case ze.jsonb:return fS(t);case ze.timestamp:return dS(t);case ze.abstime:case ze.date:case ze.daterange:case ze.int4range:case ze.int8range:case ze.money:case ze.reltime:case ze.text:case ze.time:case ze.timestamptz:case ze.timetz:case ze.tsrange:case ze.tstzrange:return U0(t);default:return U0(t)}},U0=e=>e,cS=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},uS=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},fS=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},hS=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const a=e.slice(1,r);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(o=>qg(t,o))}return e},dS=e=>typeof e=="string"?e.replace(" ","T"):e,Qg=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Cu{constructor(t,r,n={},i=Xg){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var qd;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(qd||(qd={}));class Ba{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ba.syncState(this.state,i,s,a),this.pendingDiffs.forEach(l=>{this.state=Ba.syncDiff(this.state,l,s,a)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Ba.syncDiff(this.state,i,s,a),o())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const s=this.cloneDeep(t),a=this.transformState(r),o={},l={};return this.map(s,(c,u)=>{a[c]||(l[c]=u)}),this.map(a,(c,u)=>{const h=s[c];if(h){const d=u.map(v=>v.presence_ref),m=h.map(v=>v.presence_ref),g=u.filter(v=>m.indexOf(v.presence_ref)<0),p=h.filter(v=>d.indexOf(v.presence_ref)<0);g.length>0&&(o[c]=g),p.length>0&&(l[c]=p)}else o[c]=u}),this.syncDiff(s,{joins:o,leaves:l},n,i)}static syncDiff(t,r,n,i){const{joins:s,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(o,l)=>{var c;const u=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),u.length>0){const h=t[o].map(m=>m.presence_ref),d=u.filter(m=>h.indexOf(m.presence_ref)<0);t[o].unshift(...d)}n(o,u,l)}),this.map(a,(o,l)=>{let c=t[o];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),t[o]=c,i(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Qd;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Qd||(Qd={}));var Jd;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Jd||(Jd={}));var pn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(pn||(pn={}));class Zf{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Ut.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Cu(this,Br.join,this.params,this.timeout),this.rejoinTimer=new Yg(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ut.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ut.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Ut.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ut.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Br.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new Ba(this),this.broadcastEndpointURL=Qg(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Ut.closed){const{config:{broadcast:s,presence:a,private:o}}=this.params;this._onError(u=>t==null?void 0:t(pn.CHANNEL_ERROR,u)),this._onClose(()=>t==null?void 0:t(pn.CLOSED));const l={},c={broadcast:s,presence:a,postgres_changes:(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&i!==void 0?i:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var h;if(this.socket.setAuth(),u===void 0){t==null||t(pn.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,m=(h=d==null?void 0:d.length)!==null&&h!==void 0?h:0,g=[];for(let p=0;p<m;p++){const v=d[p],{filter:{event:x,schema:w,table:y,filter:E}}=v,C=u&&u[p];if(C&&C.event===x&&C.schema===w&&C.table===y&&C.filter===E)g.push(Object.assign(Object.assign({},v),{id:C.id}));else{this.unsubscribe(),this.state=Ut.errored,t==null||t(pn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,t&&t(pn.SUBSCRIBED);return}}).receive("error",u=>{this.state=Ut.errored,t==null||t(pn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(pn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:a}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Ut.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Br.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new Cu(this,Br.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),a=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),a}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Cu(this,t,r,n);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,s;const a=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=Br;if(n&&[o,l,c,u].indexOf(a)>=0&&n!==this._joinRef())return;let d=this._onMessage(a,r,n);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(m=>{var g,p,v;return((g=m.filter)===null||g===void 0?void 0:g.event)==="*"||((v=(p=m.filter)===null||p===void 0?void 0:p.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===a}).map(m=>m.callback(d,n)):(s=this.bindings[a])===null||s===void 0||s.filter(m=>{var g,p,v,x,w,y;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in m){const E=m.id,C=(g=m.filter)===null||g===void 0?void 0:g.event;return E&&((p=r.ids)===null||p===void 0?void 0:p.includes(E))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((v=r.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const E=(w=(x=m==null?void 0:m.filter)===null||x===void 0?void 0:x.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return E==="*"||E===((y=r==null?void 0:r.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===a}).map(m=>{if(typeof d=="object"&&"ids"in d){const g=d.data,{schema:p,table:v,commit_timestamp:x,type:w,errors:y}=g;d=Object.assign(Object.assign({},{schema:p,table:v,commit_timestamp:x,eventType:w,new:{},old:{},errors:y}),this._getPayloadRecords(g))}m.callback(d,n)})}_isClosed(){return this.state===Ut.closed}_isJoined(){return this.state===Ut.joined}_isJoining(){return this.state===Ut.joining}_isLeaving(){return this.state===Ut.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&Zf.isEqual(i.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Br.close,{},t)}_onError(t){this._on(Br.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ut.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Yd(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Yd(t.columns,t.old_record)),r}}const Zd=()=>{},pS=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class mS{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Xg,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Zd,this.ref=0,this.logger=Zd,this.conn=null,this.sendBuffer=[],this.serializer=new oS,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let a;return s?a=s:typeof fetch>"u"?a=(...o)=>No(async()=>{const{default:l}=await Promise.resolve().then(()=>Qs);return{default:l}},void 0,import.meta.url).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${t}/${B0.websocket}`,this.httpEndpoint=Qg(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const i=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(s,a)=>a(JSON.stringify(s)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Yg(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=rS),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:sS}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Ma.connecting:return bi.Connecting;case Ma.open:return bi.Open;case Ma.closing:return bi.Closing;default:return bi.Closed}}isConnected(){return this.connectionState()===bi.Open}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new Zf(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:i,ref:s}=t,a=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:iS};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(Br.access_token,{access_token:r})}))}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close(aS,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:i,payload:s,ref:a}=r;n==="phoenix"&&i==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${n} ${i} ${a&&"("+a+")"||""}`,s),Array.from(this.channels).filter(o=>o._isMember(n)).forEach(o=>o._trigger(i,s,a)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(t=>t())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",`${t}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(Br.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([pS],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class eh extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function yt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class gS extends eh{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class $0 extends eh{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var xS=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(h){a(h)}}function l(u){try{c(n.throw(u))}catch(h){a(h)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const Jg=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>No(async()=>{const{default:n}=await Promise.resolve().then(()=>Qs);return{default:n}},void 0,import.meta.url).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},vS=()=>xS(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield No(()=>Promise.resolve().then(()=>Qs),void 0,import.meta.url)).Response:Response}),H0=e=>{if(Array.isArray(e))return e.map(r=>H0(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[i]=H0(n)}),t};var Ki=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(h){a(h)}}function l(u){try{c(n.throw(u))}catch(h){a(h)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const bu=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),yS=(e,t,r)=>Ki(void 0,void 0,void 0,function*(){const n=yield vS();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(i=>{t(new gS(bu(i),e.status||500))}).catch(i=>{t(new $0(bu(i),i))}):t(new $0(bu(e),e))}),wS=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(i.body=JSON.stringify(n)),Object.assign(Object.assign({},i),r))};function Do(e,t,r,n,i,s){return Ki(this,void 0,void 0,function*(){return new Promise((a,o)=>{e(r,wS(t,n,i,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>yS(l,o,n))})})}function rc(e,t,r,n){return Ki(this,void 0,void 0,function*(){return Do(e,"GET",t,r,n)})}function Un(e,t,r,n,i){return Ki(this,void 0,void 0,function*(){return Do(e,"POST",t,n,i,r)})}function _S(e,t,r,n,i){return Ki(this,void 0,void 0,function*(){return Do(e,"PUT",t,n,i,r)})}function TS(e,t,r,n){return Ki(this,void 0,void 0,function*(){return Do(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function Zg(e,t,r,n,i){return Ki(this,void 0,void 0,function*(){return Do(e,"DELETE",t,n,i,r)})}var er=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(h){a(h)}}function l(u){try{c(n.throw(u))}catch(h){a(h)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const ES={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ep={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class SS{constructor(t,r={},n,i){this.url=t,this.headers=r,this.bucketId=n,this.fetch=Jg(i)}uploadOrUpdate(t,r,n,i){return er(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},ep),i);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(o=Object.assign(Object.assign({},o),i.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:t,body:s,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{})),d=yield h.json();return h.ok?{data:{path:c,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(s){if(yt(s))return{data:null,error:s};throw s}})}upload(t,r,n){return er(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,i){return er(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),a=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:ep.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:u}),d=yield h.json();return h.ok?{data:{path:s,fullPath:d.Key},error:null}:{data:null,error:d}}catch(l){if(yt(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return er(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const s=yield Un(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),a=new URL(this.url+s.url),o=a.searchParams.get("token");if(!o)throw new eh("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:o},error:null}}catch(n){if(yt(n))return{data:null,error:n};throw n}})}update(t,r,n){return er(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return er(this,void 0,void 0,function*(){try{return{data:yield Un(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(yt(i))return{data:null,error:i};throw i}})}copy(t,r,n){return er(this,void 0,void 0,function*(){try{return{data:{path:(yield Un(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(yt(i))return{data:null,error:i};throw i}})}createSignedUrl(t,r,n){return er(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),s=yield Un(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(yt(i))return{data:null,error:i};throw i}})}createSignedUrls(t,r,n){return er(this,void 0,void 0,function*(){try{const i=yield Un(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(yt(i))return{data:null,error:i};throw i}})}download(t,r){return er(this,void 0,void 0,function*(){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=s?`?${s}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield rc(this.fetch,`${this.url}/${i}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(yt(o))return{data:null,error:o};throw o}})}info(t){return er(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield rc(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:H0(n),error:null}}catch(n){if(yt(n))return{data:null,error:n};throw n}})}exists(t){return er(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield TS(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(yt(n)&&n instanceof $0){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),i=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&i.push(s);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&i.push(l);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return er(this,void 0,void 0,function*(){try{return{data:yield Zg(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(yt(r))return{data:null,error:r};throw r}})}list(t,r,n){return er(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},ES),r),{prefix:t||""});return{data:yield Un(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(yt(i))return{data:null,error:i};throw i}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const kS="2.7.1",CS={"X-Client-Info":`storage-js/${kS}`};var ns=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(h){a(h)}}function l(u){try{c(n.throw(u))}catch(h){a(h)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class bS{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},CS),r),this.fetch=Jg(n)}listBuckets(){return ns(this,void 0,void 0,function*(){try{return{data:yield rc(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(yt(t))return{data:null,error:t};throw t}})}getBucket(t){return ns(this,void 0,void 0,function*(){try{return{data:yield rc(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(yt(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return ns(this,void 0,void 0,function*(){try{return{data:yield Un(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(yt(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return ns(this,void 0,void 0,function*(){try{return{data:yield _S(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(yt(n))return{data:null,error:n};throw n}})}emptyBucket(t){return ns(this,void 0,void 0,function*(){try{return{data:yield Un(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(yt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return ns(this,void 0,void 0,function*(){try{return{data:yield Zg(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(yt(r))return{data:null,error:r};throw r}})}}class NS extends bS{constructor(t,r={},n){super(t,r,n)}from(t){return new SS(this.url,this.headers,t,this.fetch)}}const AS="2.50.3";let ka="";typeof Deno<"u"?ka="deno":typeof document<"u"?ka="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ka="react-native":ka="node";const DS={"X-Client-Info":`supabase-js-${ka}/${AS}`},OS={headers:DS},PS={schema:"public"},FS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},RS={};var jS=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(h){a(h)}}function l(u){try{c(n.throw(u))}catch(h){a(h)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const IS=e=>{let t;return e?t=e:typeof fetch>"u"?t=Lg:t=fetch,(...r)=>t(...r)},LS=()=>typeof Headers>"u"?Mg:Headers,MS=(e,t,r)=>{const n=IS(r),i=LS();return(s,a)=>jS(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let c=new i(a==null?void 0:a.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},a),{headers:c}))})};var BS=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(h){a(h)}}function l(u){try{c(n.throw(u))}catch(h){a(h)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};function US(e){return e.endsWith("/")?e:e+"/"}function $S(e,t){var r,n;const{db:i,auth:s,realtime:a,global:o}=e,{db:l,auth:c,realtime:u,global:h}=t,d={db:Object.assign(Object.assign({},l),i),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},u),a),global:Object.assign(Object.assign(Object.assign({},h),o),{headers:Object.assign(Object.assign({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>BS(this,void 0,void 0,function*(){return""})};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}const ex="2.70.0",us=30*1e3,z0=3,Nu=z0*us,HS="http://localhost:9999",zS="supabase.auth.token",WS={"X-Client-Info":`gotrue-js/${ex}`},W0="X-Supabase-Api-Version",tx={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},VS=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,GS=6e5;class th extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function we(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class KS extends th{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function XS(e){return we(e)&&e.name==="AuthApiError"}class rx extends th{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class mi extends th{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class Ln extends mi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function YS(e){return we(e)&&e.name==="AuthSessionMissingError"}class tl extends mi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class rl extends mi{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class nl extends mi{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function qS(e){return we(e)&&e.name==="AuthImplicitGrantRedirectError"}class tp extends mi{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class V0 extends mi{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Au(e){return we(e)&&e.name==="AuthRetryableFetchError"}class rp extends mi{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Ua extends mi{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const nc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),np=` 	
\r=`.split(""),QS=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<np.length;t+=1)e[np[t].charCodeAt(0)]=-2;for(let t=0;t<nc.length;t+=1)e[nc[t].charCodeAt(0)]=t;return e})();function ip(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(nc[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(nc[n]),t.queuedBits-=6}}function nx(e,t,r){const n=QS[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function sp(e){const t=[],r=a=>{t.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=a=>{ek(a,n,r)};for(let a=0;a<e.length;a+=1)nx(e.charCodeAt(a),i,s);return t.join("")}function JS(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function ZS(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}JS(n,t)}}function ek(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function tk(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)nx(e.charCodeAt(i),r,n);return new Uint8Array(t)}function rk(e){const t=[];return ZS(e,r=>t.push(r)),new Uint8Array(t)}function nk(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>ip(i,r,n)),ip(null,r,n),t.join("")}function ik(e){return Math.round(Date.now()/1e3)+e}function sk(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Ir=()=>typeof window<"u"&&typeof document<"u",_i={tested:!1,writable:!1},$a=()=>{if(!Ir())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(_i.tested)return _i.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),_i.tested=!0,_i.writable=!0}catch{_i.tested=!0,_i.writable=!1}return _i.writable};function ak(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{t[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const ix=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>No(async()=>{const{default:n}=await Promise.resolve().then(()=>Qs);return{default:n}},void 0,import.meta.url).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},ok=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",sx=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},il=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},sl=async(e,t)=>{await e.removeItem(t)};class Uc{constructor(){this.promise=new Uc.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Uc.promiseConstructor=Promise;function Du(e){const t=e.split(".");if(t.length!==3)throw new Ua("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!VS.test(t[n]))throw new Ua("JWT not in base64url format");return{header:JSON.parse(sp(t[0])),payload:JSON.parse(sp(t[1])),signature:tk(t[2]),raw:{header:t[0],payload:t[1]}}}async function lk(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function ck(e,t){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await e(s);if(!t(s,null,a)){n(a);return}}catch(a){if(!t(s,a)){i(a);return}}})()})}function uk(e){return("0"+e.toString(16)).substr(-2)}function fk(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,uk).join("")}async function hk(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function dk(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await hk(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function is(e,t,r=!1){const n=fk();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await sx(e,`${t}-code-verifier`,i);const s=await dk(n);return[s,n===s?"plain":"s256"]}const pk=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function mk(e){const t=e.headers.get(W0);if(!t||!t.match(pk))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function gk(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function xk(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const vk=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ss(e){if(!vk.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var yk=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};const ki=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),wk=[502,503,504];async function ap(e){var t;if(!ok(e))throw new V0(ki(e),0);if(wk.includes(e.status))throw new V0(ki(e),e.status);let r;try{r=await e.json()}catch(s){throw new rx(ki(s),s)}let n;const i=mk(e);if(i&&i.getTime()>=tx["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new rp(ki(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Ln}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new rp(ki(r),e.status,r.weak_password.reasons);throw new KS(ki(r),e.status||500,n)}const _k=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function Ce(e,t,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[W0]||(s[W0]=tx["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const a=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await Tk(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function Tk(e,t,r,n,i,s){const a=_k(t,n,i,s);let o;try{o=await e(r,Object.assign({},a))}catch(l){throw console.error(l),new V0(ki(l),0)}if(o.ok||await ap(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await ap(l)}}function hn(e){var t;let r=null;Ck(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=ik(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function op(e){const t=hn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function zn(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Ek(e){return{data:e,error:null}}function Sk(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=e,a=yk(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function kk(e){return e}function Ck(e){return e.access_token&&e.refresh_token&&e.expires_in}const Ou=["global","local","others"];var bk=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};class Nk{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=ix(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=Ou[0]){if(Ou.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Ou.join(", ")}`);try{return await Ce(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(we(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ce(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:zn})}catch(n){if(we(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=bk(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await Ce(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:Sk,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(we(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ce(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:zn})}catch(r){if(we(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,s,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Ce(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:kk});if(u.error)throw u.error;const h=await u.json(),d=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,m=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return m.length>0&&(m.forEach(g=>{const p=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(g.split(";")[1].split("=")[1]);c[`${v}Page`]=p}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(we(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){ss(t);try{return await Ce(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:zn})}catch(r){if(we(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){ss(t);try{return await Ce(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:zn})}catch(n){if(we(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){ss(t);try{return await Ce(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:zn})}catch(n){if(we(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){ss(t.userId);try{const{data:r,error:n}=await Ce(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(we(r))return{data:null,error:r};throw r}}async _deleteFactor(t){ss(t.userId),ss(t.id);try{return{data:await Ce(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(we(r))return{data:null,error:r};throw r}}}const Ak={getItem:e=>$a()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{$a()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{$a()&&globalThis.localStorage.removeItem(e)}};function lp(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function Dk(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const as={debug:!!(globalThis&&$a()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ax extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Ok extends ax{}async function Pk(e,t,r){as.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),as.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){as.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{as.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw as.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Ok(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(as.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}Dk();const Fk={url:HS,storageKey:zS,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:WS,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function cp(e,t,r){return await r()}class po{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=po.nextInstanceID,po.nextInstanceID+=1,this.instanceID>0&&Ir()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},Fk),t);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Nk({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=ix(i.fetch),this.lock=i.lock||cp,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:Ir()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=Pk:this.lock=cp,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:$a()?this.storage=Ak:(this.memoryStorage={},this.storage=lp(this.memoryStorage)):(this.memoryStorage={},this.storage=lp(this.memoryStorage)),Ir()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ex}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=ak(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Ir()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),qS(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:a,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return we(r)?{error:r}:{error:new rx("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const s=await Ce(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:hn}),{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(we(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,i;try{let s;if("email"in t){const{email:u,password:h,options:d}=t;let m=null,g=null;this.flowType==="pkce"&&([m,g]=await is(this.storage,this.storageKey)),s=await Ce(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:u,password:h,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:m,code_challenge_method:g},xform:hn})}else if("phone"in t){const{phone:u,password:h,options:d}=t;s=await Ce(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},channel:(i=d==null?void 0:d.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:hn})}else throw new rl("You must provide either an email or phone number and a password");const{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(we(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:a,options:o}=t;r=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:op})}else if("phone"in t){const{phone:s,password:a,options:o}=t;r=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:op})}else throw new rl("You must provide either an email or phone number and a password");const{data:n,error:i}=r;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new tl}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(we(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,i,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,i,s,a,o,l,c,u,h,d,m;let g,p;if("message"in t)g=t.message,p=t.signature;else{const{chain:v,wallet:x,statement:w,options:y}=t;let E;if(Ir())if(typeof x=="object")E=x;else{const R=window;if("solana"in R&&typeof R.solana=="object"&&("signIn"in R.solana&&typeof R.solana.signIn=="function"||"signMessage"in R.solana&&typeof R.solana.signMessage=="function"))E=R.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=x}const C=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in E&&E.signIn){const R=await E.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y==null?void 0:y.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),w?{statement:w}:null));let D;if(Array.isArray(R)&&R[0]&&typeof R[0]=="object")D=R[0];else if(R&&typeof R=="object"&&"signedMessage"in R&&"signature"in R)D=R;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in D&&"signature"in D&&(typeof D.signedMessage=="string"||D.signedMessage instanceof Uint8Array)&&D.signature instanceof Uint8Array)g=typeof D.signedMessage=="string"?D.signedMessage:new TextDecoder().decode(D.signedMessage),p=D.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in E)||typeof E.signMessage!="function"||!("publicKey"in E)||typeof E!="object"||!E.publicKey||!("toBase58"in E.publicKey)||typeof E.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${C.host} wants you to sign in with your Solana account:`,E.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(i=(n=y==null?void 0:y.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=y==null?void 0:y.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((a=y==null?void 0:y.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((o=y==null?void 0:y.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((l=y==null?void 0:y.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((c=y==null?void 0:y.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((h=(u=y==null?void 0:y.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...y.signInWithSolana.resources.map(D=>`- ${D}`)]:[]].join(`
`);const R=await E.signMessage(new TextEncoder().encode(g),"utf8");if(!R||!(R instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=R}}try{const{data:v,error:x}=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:nk(p)},!((d=t.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(m=t.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:hn});if(x)throw x;return!v||!v.session||!v.user?{data:{user:null,session:null},error:new tl}:(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),{data:Object.assign({},v),error:x})}catch(v){if(we(v))return{data:{user:null,session:null},error:v};throw v}}async _exchangeCodeForSession(t){const r=await il(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:s,error:a}=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:hn});if(await sl(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new tl}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:a})}catch(s){if(we(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:s,nonce:a}=t,o=await Ce(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:hn}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new tl}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(we(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,i,s,a;try{if("email"in t){const{email:o,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await is(this.storage,this.storageKey));const{error:h}=await Ce(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:u}=await Ce(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new rl("You must provide either an email or phone number.")}catch(o){if(we(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let i,s;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:o}=await Ce(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:hn});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(we(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(t){var r,n,i;try{let s=null,a=null;return this.flowType==="pkce"&&([s,a]=await is(this.storage,this.storageKey)),await Ce(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:a}),headers:this.headers,xform:Ek})}catch(s){if(we(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Ln;const{error:i}=await Ce(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:i}})}catch(t){if(we(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:s}=t,{error:a}=await Ce(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in t){const{phone:n,type:i,options:s}=t,{data:a,error:o}=await Ce(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new rl("You must provide either an email or phone number and a type")}catch(r){if(we(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await il(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Nu:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let a=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,c,u)=>(!a&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:t},error:null}}const{session:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Ce(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:zn}):await this._useSession(async r=>{var n,i,s;const{data:a,error:o}=r;if(o)throw o;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ln}:await Ce(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:zn})})}catch(r){if(we(r))return YS(r)&&(await this._removeSession(),await sl(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new Ln;const a=i.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await is(this.storage,this.storageKey));const{data:c,error:u}=await Ce(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:zn});if(u)throw u;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(n){if(we(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Ln;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:a}=Du(t.access_token);if(a.exp&&(n=a.exp,i=n<=r),i){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(we(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:a,error:o}=r;if(o)throw o;t=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Ln;const{session:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(we(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Ir())throw new nl("No browser detected.");if(t.error||t.error_description||t.error_code)throw new nl(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new tp("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new nl("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new tp("No code detected.");const{data:w,error:y}=await this._exchangeCodeForSession(t.code);if(y)throw y;const E=new URL(window.location.href);return E.searchParams.delete("code"),window.history.replaceState(window.history.state,"",E.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=t;if(!s||!o||!a||!c)throw new nl("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(o);let d=u+h;l&&(d=parseInt(l));const m=d-u;m*1e3<=us&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${h}s`);const g=d-h;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,d,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,d,u);const{data:p,error:v}=await this._getUser(s);if(v)throw v;const x={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:h,expires_at:d,refresh_token:a,token_type:c,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:t.type},error:null}}catch(n){if(we(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await il(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return{error:s};const a=(n=i.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:o}=await this.admin.signOut(a,t);if(o&&!(XS(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await sl(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=sk(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await is(this.storage,this.storageKey,!0));try{return await Ce(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(we(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(we(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var a,o,l,c,u;const{data:h,error:d}=s;if(d)throw d;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Ce(this.fetch,"GET",m,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return Ir()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(we(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)throw a;return await Ce(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(we(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await ck(async i=>(i>0&&await lk(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await Ce(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:hn})),(i,s)=>{const a=200*Math.pow(2,i);return s&&Au(s)&&Date.now()+a-n<us})}catch(n){if(this._debug(r,"error",n),we(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Ir()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await il(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const i=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Nu;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${Nu}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:s}=await this._callRefreshToken(n.refresh_token);s&&(console.error(s),Au(s)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Ln;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Uc;const{data:s,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!s.session)throw new Ln;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),we(s)){const a={session:null,error:s};return Au(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){s.push(l)}});if(await Promise.all(a),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await sx(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await sl(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Ir()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),us);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/us);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${us}ms, refresh threshold is ${z0} ticks`),i<=z0&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof ax)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ir()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,a]=await is(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?{data:null,error:s}:await Ce(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(we(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:c}=await Ce(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(we(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return{data:null,error:s};const{data:a,error:o}=await Ce(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(r){if(we(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?{data:null,error:s}:await Ce(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(we(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],i=n.filter(a=>a.factor_type==="totp"&&a.status==="verified"),s=n.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:n,totp:i,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:i},error:s}=t;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Du(i.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((n=(r=i.user.factors)===null||r===void 0?void 0:r.filter(h=>h.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(a=>a.kid===t);if(n||(n=this.jwks.keys.find(a=>a.kid===t),n&&this.jwks_cached_at+GS>Date.now()))return n;const{data:i,error:s}=await Ce(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!i.keys||i.keys.length===0)throw new Ua("JWKS is empty");if(this.jwks=i,this.jwks_cached_at=Date.now(),n=i.keys.find(a=>a.kid===t),!n)throw new Ua("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:m,error:g}=await this.getSession();if(g||!m.session)return{data:null,error:g};n=m.session.access_token}const{header:i,payload:s,signature:a,raw:{header:o,payload:l}}=Du(n);if(gk(s.exp),!i.kid||i.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:m}=await this.getUser(n);if(m)throw m;return{data:{claims:s,header:i,signature:a},error:null}}const c=xk(i.alg),u=await this.fetchJwk(i.kid,r),h=await crypto.subtle.importKey("jwk",u,c,!0,["verify"]);if(!await crypto.subtle.verify(c,h,a,rk(`${o}.${l}`)))throw new Ua("Invalid JWT signature");return{data:{claims:s,header:i,signature:a},error:null}}catch(n){if(we(n))return{data:null,error:n};throw n}}}po.nextInstanceID=0;const Rk=po;class jk extends Rk{constructor(t){super(t)}}var Ik=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(h){a(h)}}function l(u){try{c(n.throw(u))}catch(h){a(h)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class Lk{constructor(t,r,n){var i,s,a;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=US(t),l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:PS,realtime:RS,auth:Object.assign(Object.assign({},FS),{storageKey:c}),global:OS},h=$S(n??{},u);this.storageKey=(i=h.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=h.global.headers)!==null&&s!==void 0?s:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(d,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=h.auth)!==null&&a!==void 0?a:{},this.headers,h.global.fetch),this.fetch=MS(r,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new eS(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new DE(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new NS(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return Ik(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,storageKey:s,flowType:a,lock:o,debug:l},c,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new jk({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),c),storageKey:s,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,flowType:a,lock:o,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new mS(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Mk=(e,t,r)=>new Lk(e,t,r),Bk="https://hnsnmdflyvblcijgobuj.supabase.co",Uk="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imhuc25tZGZseXZibGNpamdvYnVqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE4OTc5OTAsImV4cCI6MjA2NzQ3Mzk5MH0.hcOzwwuJUlWDMToG4PJXeGXuSQs2IYzTjSvyxypkGF8",gn=Mk(Bk,Uk),ya={async signUp(e,t){const{data:r,error:n}=await gn.auth.signUp({email:e,password:t,options:{data:{role:"user"}}});return{data:r,error:n}},async signIn(e,t){const{data:r,error:n}=await gn.auth.signInWithPassword({email:e,password:t});return{data:r,error:n}},async signOut(){const{error:e}=await gn.auth.signOut();return{error:e}},async getCurrentUser(){const{data:{user:e}}=await gn.auth.getUser();return e},async updatePassword(e){const{data:t,error:r}=await gn.auth.updateUser({password:e});return{data:t,error:r}}},Ca=async()=>{const{data:e,error:t}=await gn.from("prosecutors").select("*").order("name",{ascending:!0});return t?(console.error("Error fetching prosecutors:",t),[]):e||[]},$k=async e=>{const{data:t,error:r}=await gn.from("prosecutors").insert([e]).select();return r?(console.error("Error adding prosecutor:",r),{success:!1,error:r}):(console.log("New prosecutor added:",t),{success:!0,data:t[0]})},Hk=async(e,t)=>{const{data:r,error:n}=await gn.from("prosecutors").update(t).eq("id",e).select();return n?(console.error("Error updating prosecutor:",n),{success:!1,error:n}):(console.log("Prosecutor updated:",r),{success:!0,data:r[0]})},zk=async e=>{const{error:t}=await gn.from("prosecutors").delete().eq("id",e);return t?(console.error("Error deleting prosecutor:",t),{success:!1,error:t}):(console.log("Prosecutor deleted successfully."),{success:!0})},rh=()=>{const[e,t]=ee.useState(null),[r,n]=ee.useState(!0);return ee.useEffect(()=>{(async()=>{const c=await ya.getCurrentUser();t(c),n(!1)})()},[]),{user:e,loading:r,signIn:async(l,c)=>{n(!0);const{data:u,error:h}=await ya.signIn(l,c);return u.user&&t(u.user),n(!1),{success:!h,error:h}},signUp:async(l,c)=>{n(!0);const{data:u,error:h}=await ya.signUp(l,c);return u.user&&t(u.user),n(!1),{success:!h,error:h}},signOut:async()=>{n(!0),await ya.signOut(),t(null),n(!1)},updatePassword:async l=>{const{error:c}=await ya.updatePassword(l);return{success:!c,error:c}},isAuthenticated:!!e}},up=({onUpdateCriminalCode:e,onUpdateProsecutors:t,currentUserId:r})=>{const{user:n,loading:i}=rh(),[s,a]=ee.useState("criminal"),[o,l]=ee.useState(bo),[c,u]=ee.useState([]),[h,d]=ee.useState(null),[m,g]=ee.useState(null),[p,v]=ee.useState(""),[x,w]=ee.useState(!1),[y,E]=ee.useState(!0),{exportData:C,importData:R}=Ig();ee.useEffect(()=>{(async()=>{try{const q=await wn.loadData("criminalCode");q.length>0&&l(q)}catch(q){console.error("Failed to load criminal code data from IndexedDB:",q)}})()},[]),ee.useEffect(()=>{(async()=>{try{await wn.saveData("criminalCode",o)}catch(q){console.error("Failed to save criminal code data to IndexedDB:",q)}})()},[o]),ee.useEffect(()=>{(async()=>{if(!i){if(E(!0),n&&r){const q=await Ca();u(q)}else u([]),console.log("No user logged in or currentUserId is missing, cannot fetch prosecutors data from Supabase.");E(!1)}})()},[n,i,r]);const D=()=>{const H=p.split(`
`).filter(ie=>ie.trim()),q=[];if(H.forEach(ie=>{const pe=ie.trim();if(pe){const O=pe.split(";");if(O.length>=2){const L=O[0].trim(),j=O[1].trim();o.some(X=>X.article===L)||q.push({article:L,title:j,description:""})}}}),q.length>0){const ie=[...o,...q];l(ie),e(ie),v(""),w(!1),alert(`Đã thêm ${q.length} điều luật mới vào IndexedDB!`)}else alert("Không có dữ liệu hợp lệ để thêm hoặc tất cả đã tồn tại.")},F=()=>{g({article:"",title:"",description:""})},N=(H,q=!1)=>{if(q){const ie=[...o,H];l(ie),e(ie),g(null)}else{const ie=o.map(pe=>pe.article===H.article?H:pe);l(ie),e(ie),d(null)}},P=H=>{const q=o.filter(ie=>ie.article!==H);l(q),e(q)},W=()=>{if(!n||!r){alert("Vui lòng đăng nhập để thêm Kiểm sát viên.");return}g({name:"",title:"Kiểm sát viên",department:""})},G=async(H,q=!1)=>{if(!n||!r){alert("Bạn cần đăng nhập để thực hiện thao tác này.");return}if(q)if(await $k(H)){alert("Thêm Kiểm sát viên thành công!"),g(null),d(null);const pe=await Ca();u(pe),t(pe)}else alert("Lỗi khi thêm Kiểm sát viên.");else{if(!H.id){alert("Không tìm thấy ID Kiểm sát viên để cập nhật.");return}if(await Hk(H.id,{name:H.name,title:H.title,department:H.department})){alert("Cập nhật Kiểm sát viên thành công!"),d(null);const pe=await Ca();u(pe),t(pe)}else alert("Lỗi khi cập nhật Kiểm sát viên.")}},Q=async H=>{if(!n||!r){alert("Vui lòng đăng nhập để thực hiện thao tác này.");return}if(window.confirm("Bạn có chắc chắn muốn xóa Kiểm sát viên này?"))if(await zk(H)){alert("Xóa Kiểm sát viên thành công!");const ie=await Ca();u(ie),t(ie)}else alert("Lỗi khi xóa Kiểm sát viên.")},ve=async()=>{const H=await C();alert(H?"Dữ liệu đã được xuất thành công!":"Có lỗi xảy ra khi xuất dữ liệu.")},ge=async H=>{var pe;const q=(pe=H.target.files)==null?void 0:pe[0];if(!q)return;await R(q)?(alert("Dữ liệu đã được nhập thành công! Vui lòng tải lại trang."),window.location.reload()):alert("Có lỗi xảy ra khi nhập dữ liệu. Vui lòng kiểm tra định dạng file."),H.target.value=""},Te=({item:H,onSave:q,onCancel:ie})=>{const[pe,O]=ee.useState(H);return f.jsxs("tr",{className:"bg-blue-50",children:[f.jsx("td",{className:"px-4 py-2",children:f.jsx("input",{type:"text",value:pe.article,onChange:L=>O({...pe,article:L.target.value}),className:"w-full p-2 border rounded",placeholder:"Số điều"})}),f.jsx("td",{className:"px-4 py-2",children:f.jsx("input",{type:"text",value:pe.title,onChange:L=>O({...pe,title:L.target.value}),className:"w-full p-2 border rounded",placeholder:"Tên tội danh"})}),f.jsx("td",{className:"px-4 py-2",children:f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("button",{onClick:()=>q(pe),className:"flex items-center gap-1 px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700",children:[f.jsx(ho,{size:14}),"Lưu"]}),f.jsxs("button",{onClick:ie,className:"flex items-center gap-1 px-3 py-1 bg-gray-600 text-white rounded hover:bg-gray-700",children:[f.jsx(zs,{size:14}),"Hủy"]})]})})]})},Ee=({item:H,onSave:q,onCancel:ie,isNew:pe})=>{const[O,L]=ee.useState(H);return f.jsxs("tr",{className:"bg-blue-50",children:[f.jsx("td",{className:"px-4 py-2",children:f.jsx("input",{type:"text",value:O.name,onChange:j=>L({...O,name:j.target.value}),className:"w-full p-2 border rounded",placeholder:"Họ tên"})}),f.jsx("td",{className:"px-4 py-2",children:f.jsxs("select",{value:O.title,onChange:j=>L({...O,title:j.target.value}),className:"w-full p-2 border rounded",children:[f.jsx("option",{value:"Kiểm sát viên sơ cấp",children:"Kiểm sát viên sơ cấp"}),f.jsx("option",{value:"Kiểm sát viên trung cấp",children:"Kiểm sát viên trung cấp"}),f.jsx("option",{value:"Kiểm tra viên",children:"Kiểm tra viên"}),f.jsx("option",{value:"Cán bộ",children:"Cán bộ"})]})}),f.jsx("td",{className:"px-4 py-2",children:f.jsxs("select",{value:O.department||"",onChange:j=>L({...O,department:j.target.value}),className:"w-full p-2 border rounded",children:[f.jsx("option",{value:"",children:"Chọn phòng ban"}),f.jsx("option",{value:"Phòng Hình sự",children:"Phòng Hình sự"}),f.jsx("option",{value:"Phòng Dân sự",children:"Phòng Dân sự"}),f.jsx("option",{value:"Văn phòng",children:"Văn phòng"})]})}),f.jsx("td",{className:"px-4 py-2",children:f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("button",{onClick:()=>q(O,pe),className:"flex items-center gap-1 px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700",children:[f.jsx(ho,{size:14}),"Lưu"]}),f.jsxs("button",{onClick:ie,className:"flex items-center gap-1 px-3 py-1 bg-gray-600 text-white rounded hover:bg-gray-700",children:[f.jsx(zs,{size:14}),"Hủy"]})]})})]})};return f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Quản Lý Dữ Liệu Hệ Thống"}),f.jsxs("div",{className:"flex mb-6 border-b",children:[f.jsxs("button",{onClick:()=>a("criminal"),className:`flex items-center gap-2 px-4 py-2 border-b-2 font-medium ${s==="criminal"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[f.jsx(j2,{size:18}),"Bộ Luật Hình Sự"]}),f.jsxs("button",{onClick:()=>a("prosecutors"),className:`flex items-center gap-2 px-4 py-2 border-b-2 font-medium ${s==="prosecutors"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[f.jsx(j0,{size:18}),"Kiểm Sát Viên"]}),f.jsxs("button",{onClick:()=>a("backup"),className:`flex items-center gap-2 px-4 py-2 border-b-2 font-medium ${s==="backup"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[f.jsx(Ci,{size:18}),"Sao Lưu & Khôi Phục"]})]}),s==="backup"&&f.jsxs("div",{children:[f.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Sao Lưu & Khôi Phục Dữ Liệu"}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[f.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Xuất Dữ Liệu"}),f.jsx("p",{className:"text-sm text-blue-600 mb-3",children:"Xuất toàn bộ dữ liệu (vụ án, tin báo, điều luật, kiểm sát viên) thành file JSON để sao lưu."}),f.jsxs("button",{onClick:ve,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:[f.jsx(Ci,{size:16}),"Xuất Dữ Liệu"]})]}),f.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[f.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"Nhập Dữ Liệu"}),f.jsxs("p",{className:"text-sm text-green-600 mb-3",children:["Khôi phục dữ liệu từ file JSON đã xuất trước đó. ",f.jsx("strong",{children:"Lưu ý:"})," Thao tác này sẽ ghi đè lên dữ liệu hiện tại."]}),f.jsx("input",{type:"file",accept:".json",onChange:ge,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100"})]}),f.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[f.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:"Lưu Ý Quan Trọng"}),f.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[f.jsx("li",{children:"• Dữ liệu được lưu trữ cục bộ trên máy tính của bạn"}),f.jsx("li",{children:"• Thường xuyên sao lưu dữ liệu để tránh mất mát"}),f.jsx("li",{children:"• Khi chuyển máy tính, hãy xuất dữ liệu và nhập lại trên máy mới"}),f.jsx("li",{children:"• File sao lưu chứa toàn bộ thông tin nhạy cảm, hãy bảo mật cẩn thận"})]})]})]})]}),s==="criminal"&&f.jsxs("div",{children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsx("h3",{className:"text-xl font-semibold",children:"Danh Sách Điều Luật"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("button",{onClick:()=>w(!x),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:[f.jsx(wg,{size:16}),"Import Hàng Loạt"]}),f.jsxs("button",{onClick:F,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:[f.jsx(si,{size:16}),"Thêm Điều Luật"]})]})]}),x&&f.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg border",children:[f.jsx("h4",{className:"text-lg font-medium mb-3",children:"Import Hàng Loạt Điều Luật"}),f.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:["Nhập dữ liệu theo định dạng: ",f.jsx("strong",{children:"Số điều ; Tên tội danh"})," (mỗi dòng một điều luật)"]}),f.jsxs("p",{className:"text-sm text-gray-500 mb-3",children:["Ví dụ:",f.jsx("br",{}),"165 ; Tội làm, tàng trữ, lưu hành tiền giả",f.jsx("br",{}),"166 ; Tội lừa đảo chiếm đoạt tài sản"]}),f.jsx("textarea",{value:p,onChange:H=>v(H.target.value),className:"w-full p-3 border rounded-md h-32 mb-3",placeholder:`165 ; Tội làm, tàng trữ, lưu hành tiền giả
166 ; Tội lừa đảo chiếm đoạt tài sản
167 ; Tội khác...`}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:D,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Xử Lý Import"}),f.jsx("button",{onClick:()=>{w(!1),v("")},className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Hủy"})]})]}),f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full border border-gray-200",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py-2 text-left",children:"Điều"}),f.jsx("th",{className:"px-4 py-2 text-left",children:"Tên Tội Danh"}),f.jsx("th",{className:"px-4 py-2 text-left",children:"Hành Động"})]})}),f.jsxs("tbody",{children:[m&&s==="criminal"&&f.jsx(Te,{item:m,onSave:H=>N(H,!0),onCancel:()=>g(null)}),o.map(H=>h===H.article?f.jsx(Te,{item:H,onSave:q=>N(q),onCancel:()=>d(null)},H.article):f.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[f.jsx("td",{className:"px-4 py-2 font-medium",children:H.article}),f.jsx("td",{className:"px-4 py-2",children:H.title}),f.jsx("td",{className:"px-4 py-2",children:f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("button",{onClick:()=>d(H.article),className:"flex items-center gap-1 px-2 py-1 bg-yellow-600 text-white rounded hover:bg-yellow-700 text-sm",children:[f.jsx(Jl,{size:12}),"Sửa"]}),f.jsxs("button",{onClick:()=>P(H.article),className:"flex items-center gap-1 px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-sm",children:[f.jsx(Zl,{size:12}),"Xóa"]})]})})]},H.article))]})]})})]}),s==="prosecutors"&&f.jsxs("div",{children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsx("h3",{className:"text-xl font-semibold",children:"Danh Sách Kiểm Sát Viên"}),f.jsxs("button",{onClick:W,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:[f.jsx(si,{size:16}),"Thêm Kiểm Sát Viên"]})]}),y?f.jsx("div",{children:"Đang tải danh sách Kiểm sát viên..."}):n?f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full border border-gray-200",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py-2 text-left",children:"Họ Tên"}),f.jsx("th",{className:"px-4 py-2 text-left",children:"Chức Vụ"}),f.jsx("th",{className:"px-4 py-2 text-left",children:"Phòng Ban"}),f.jsx("th",{className:"px-4 py-2 text-left",children:"Hành Động"})]})}),f.jsxs("tbody",{children:[m&&s==="prosecutors"&&f.jsx(Ee,{item:m,onSave:H=>G(H,!0),onCancel:()=>g(null),isNew:!0}),c.map(H=>h===H.id?f.jsx(Ee,{item:H,onSave:q=>G(q,!1),onCancel:()=>d(null),isNew:!1},H.id):f.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[f.jsx("td",{className:"px-4 py-2 font-medium",children:H.name}),f.jsx("td",{className:"px-4 py-2",children:H.title}),f.jsx("td",{className:"px-4 py-2",children:H.department||"-"}),f.jsx("td",{className:"px-4 py-2",children:f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("button",{onClick:()=>d(H.id||null),className:"flex items-center gap-1 px-2 py-1 bg-yellow-600 text-white rounded hover:bg-yellow-700 text-sm",children:[f.jsx(Jl,{size:12}),"Sửa"]}),f.jsxs("button",{onClick:()=>Q(H.id),className:"flex items-center gap-1 px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-sm",children:[f.jsx(Zl,{size:12}),"Xóa"]})]})})]},H.id))]})]})}):f.jsx("div",{children:"Vui lòng đăng nhập để xem và quản lý danh sách Kiểm sát viên của bạn."})]})]})},Wk=({cases:e})=>{const[t,r]=ee.useState(lt()),[n,i]=ee.useState(lt()),a=(()=>{const g=qt(t),p=qt(n);return e.filter(v=>{const x=qt(v.createdAt);return x>=g&&x<=p})})(),o=()=>{const g=a.length,p=a.reduce((v,x)=>v+x.defendants.length,0);return{cases:g,defendants:p}},l=()=>{const g=a.filter(v=>["Hoàn thành","Tạm đình chỉ","Đình chỉ","Chuyển đi"].includes(v.stage));return{completed:g.filter(v=>v.stage==="Hoàn thành").length,suspended:g.filter(v=>v.stage==="Tạm đình chỉ").length,discontinued:g.filter(v=>v.stage==="Đình chỉ").length,transferred:g.filter(v=>v.stage==="Chuyển đi").length,totalCases:g.length,totalDefendants:g.reduce((v,x)=>v+x.defendants.length,0)}},c=()=>({investigation:a.filter(g=>g.stage==="Điều tra").length,prosecution:a.filter(g=>g.stage==="Truy tố").length,trial:a.filter(g=>g.stage==="Xét xử").length,completed:a.filter(g=>g.stage==="Hoàn thành").length,suspended:a.filter(g=>g.stage==="Tạm đình chỉ").length,discontinued:a.filter(g=>g.stage==="Đình chỉ").length,transferred:a.filter(g=>g.stage==="Chuyển đi").length}),u=o(),h=l(),d=c(),m=({title:g,value:p,icon:v,color:x,subtitle:w})=>f.jsx("div",{className:`${x} p-6 rounded-lg shadow-md text-white`,children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm opacity-90",children:g}),f.jsx("p",{className:"text-3xl font-bold",children:p}),w&&f.jsx("p",{className:"text-sm opacity-75 mt-1",children:w})]}),f.jsx("div",{className:"text-white opacity-80",children:v})]})});return f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[f.jsx("div",{className:"flex justify-between items-center mb-6",children:f.jsxs("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[f.jsx(ji,{className:"text-blue-600",size:24}),"Thống Kê Dữ Liệu"]})}),f.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[f.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Khoảng Thời Gian Thống Kê"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(ir,{value:t,onChange:r,label:"Thống kê từ ngày",required:!0}),f.jsx(ir,{value:n,onChange:i,label:"Thống kê đến ngày",required:!0})]}),f.jsxs("div",{className:"mt-3 text-sm text-gray-600",children:["Thống kê từ ",t," đến ",n," (",a.length," vụ án)"]})]}),f.jsxs("div",{className:"mb-8",children:[f.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[f.jsx(yg,{size:20,className:"text-green-600"}),"Vụ Án / Bị Can Mới Nhận"]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(m,{title:"Số Vụ Án Mới",value:u.cases,icon:f.jsx(De,{size:32}),color:"bg-green-600"}),f.jsx(m,{title:"Số Bị Can Mới",value:u.defendants,icon:f.jsx(j0,{size:32}),color:"bg-blue-600"})]})]}),f.jsxs("div",{className:"mb-8",children:[f.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[f.jsx(F0,{size:20,className:"text-purple-600"}),"Vụ Án / Bị Can Đã Xử Lý"]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[f.jsx(m,{title:"Tổng Vụ Án Đã Xử Lý",value:h.totalCases,icon:f.jsx(De,{size:32}),color:"bg-purple-600"}),f.jsx(m,{title:"Tổng Bị Can Đã Xử Lý",value:h.totalDefendants,icon:f.jsx(j0,{size:32}),color:"bg-indigo-600"})]}),f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[f.jsx(m,{title:"Hoàn Thành",value:h.completed,icon:f.jsx(De,{size:24}),color:"bg-green-500",subtitle:"(đã xét xử)"}),f.jsx(m,{title:"Tạm Đình Chỉ",value:h.suspended,icon:f.jsx(De,{size:24}),color:"bg-yellow-500",subtitle:"vụ án"}),f.jsx(m,{title:"Đình Chỉ",value:h.discontinued,icon:f.jsx(De,{size:24}),color:"bg-red-500",subtitle:"vụ án"}),f.jsx(m,{title:"Chuyển Đi",value:h.transferred,icon:f.jsx(De,{size:24}),color:"bg-gray-500",subtitle:"vụ án"})]})]}),f.jsxs("div",{children:[f.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[f.jsx(ji,{size:20,className:"text-blue-600"}),"Phân Bố Theo Giai Đoạn"]}),f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-3",children:[f.jsx(m,{title:"Điều Tra",value:d.investigation,icon:f.jsx(De,{size:24}),color:"bg-orange-600",subtitle:"vụ án"}),f.jsx(m,{title:"Truy Tố",value:d.prosecution,icon:f.jsx(De,{size:24}),color:"bg-purple-600",subtitle:"vụ án"}),f.jsx(m,{title:"Xét Xử",value:d.trial,icon:f.jsx(De,{size:24}),color:"bg-indigo-600",subtitle:"vụ án"}),f.jsx(m,{title:"Hoàn Thành",value:d.completed,icon:f.jsx(De,{size:24}),color:"bg-green-600",subtitle:"vụ án"}),f.jsx(m,{title:"Tạm Đình Chỉ",value:d.suspended,icon:f.jsx(De,{size:24}),color:"bg-yellow-600",subtitle:"vụ án"}),f.jsx(m,{title:"Đình Chỉ",value:d.discontinued,icon:f.jsx(De,{size:24}),color:"bg-red-600",subtitle:"vụ án"}),f.jsx(m,{title:"Chuyển Đi",value:d.transferred,icon:f.jsx(De,{size:24}),color:"bg-gray-600",subtitle:"vụ án"})]})]}),f.jsxs("div",{className:"mt-8 overflow-x-auto",children:[f.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Bảng Tổng Hợp"}),f.jsxs("table",{className:"w-full border border-gray-200 rounded-lg",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-700",children:"Chỉ Tiêu"}),f.jsx("th",{className:"px-4 py-3 text-center font-medium text-gray-700",children:"Số Vụ Án"}),f.jsx("th",{className:"px-4 py-3 text-center font-medium text-gray-700",children:"Số Bị Can"})]})}),f.jsxs("tbody",{className:"divide-y divide-gray-200",children:[f.jsxs("tr",{className:"bg-green-50",children:[f.jsx("td",{className:"px-4 py-3 font-medium",children:"Mới nhận trong kỳ"}),f.jsx("td",{className:"px-4 py-3 text-center font-bold text-green-600",children:u.cases}),f.jsx("td",{className:"px-4 py-3 text-center font-bold text-green-600",children:u.defendants})]}),f.jsxs("tr",{className:"bg-purple-50",children:[f.jsx("td",{className:"px-4 py-3 font-medium",children:"Đã xử lý trong kỳ"}),f.jsx("td",{className:"px-4 py-3 text-center font-bold text-purple-600",children:h.totalCases}),f.jsx("td",{className:"px-4 py-3 text-center font-bold text-purple-600",children:h.totalDefendants})]}),f.jsxs("tr",{children:[f.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 pl-8",children:"- Hoàn thành (đã xét xử)"}),f.jsx("td",{className:"px-4 py-3 text-center text-green-600",children:h.completed}),f.jsx("td",{className:"px-4 py-3 text-center text-green-600",children:a.filter(g=>g.stage==="Hoàn thành").reduce((g,p)=>g+p.defendants.length,0)})]}),f.jsxs("tr",{children:[f.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 pl-8",children:"- Tạm đình chỉ"}),f.jsx("td",{className:"px-4 py-3 text-center text-yellow-600",children:h.suspended}),f.jsx("td",{className:"px-4 py-3 text-center text-yellow-600",children:a.filter(g=>g.stage==="Tạm đình chỉ").reduce((g,p)=>g+p.defendants.length,0)})]}),f.jsxs("tr",{children:[f.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 pl-8",children:"- Đình chỉ"}),f.jsx("td",{className:"px-4 py-3 text-center text-red-600",children:h.discontinued}),f.jsx("td",{className:"px-4 py-3 text-center text-red-600",children:a.filter(g=>g.stage==="Đình chỉ").reduce((g,p)=>g+p.defendants.length,0)})]}),f.jsxs("tr",{children:[f.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 pl-8",children:"- Chuyển đi"}),f.jsx("td",{className:"px-4 py-3 text-center text-gray-600",children:h.transferred}),f.jsx("td",{className:"px-4 py-3 text-center text-gray-600",children:a.filter(g=>g.stage==="Chuyển đi").reduce((g,p)=>g+p.defendants.length,0)})]})]})]})]})]})},fp=({searchTerm:e,onSearchChange:t,selectedProsecutor:r,onProsecutorChange:n,prosecutors:i})=>f.jsx("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[f.jsx(xg,{size:16,className:"inline mr-1"}),"Tìm kiếm vụ án"]}),f.jsx("input",{type:"text",value:e,onChange:s=>t(s.target.value),placeholder:"Tìm theo tên vụ án, tội danh, tên bị can...",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[f.jsx(L2,{size:16,className:"inline mr-1"}),"Lọc theo Kiểm sát viên"]}),f.jsxs("select",{value:r,onChange:s=>n(s.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[f.jsx("option",{value:"",children:"Tất cả Kiểm sát viên"}),i.map(s=>f.jsxs("option",{value:s.name,children:[s.name," - ",s.title]},s.id))]})]})]})}),Vk=({onAddReport:e,onTransferToCase:t,prosecutors:r})=>{const[n,i]=ee.useState({name:"",charges:"",resolutionDeadline:ku(lt(),30),prosecutor:"",notes:""}),s=c=>{if(c.preventDefault(),!n.name.trim()||!n.charges.trim()||!n.resolutionDeadline.trim()||!n.prosecutor.trim()){alert("Vui lòng điền đầy đủ các trường bắt buộc: Tên Tin Báo, Tội danh, Ngày Hết Hạn Giải Quyết, và Kiểm sát viên Phụ Trách.");return}e(n),i({name:"",charges:"",resolutionDeadline:ku(lt(),30),prosecutor:"",notes:""})},a=()=>{if(!n.name.trim()||!n.charges.trim()||!n.prosecutor.trim()){alert("Vui lòng điền đầy đủ Tên Tin Báo, Tội danh, và Kiểm sát viên Phụ Trách trước khi khởi tố.");return}const c={name:n.name,charges:n.charges,investigationDeadline:lt(),prosecutor:n.prosecutor,notes:n.notes,defendants:[]};t(c),i({name:"",charges:"",resolutionDeadline:ku(lt(),30),prosecutor:"",notes:""}),alert("Tin báo đã được khởi tố và chuyển sang hệ thống quản lý vụ án!")},o=bo.map(c=>({value:li(c),label:li(c),description:c.description})),l=r.map(c=>({value:c.name,label:c.name,description:`${c.title}${c.department?` - ${c.department}`:""}`}));return f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[f.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[f.jsx(si,{className:"text-blue-600",size:24}),"Thêm Tin Báo Mới"]}),f.jsxs("form",{onSubmit:s,className:"space-y-6",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[f.jsx(De,{size:16,className:"inline mr-1"}),"Tên Tin Báo"]}),f.jsx("input",{type:"text",value:n.name,onChange:c=>i({...n,name:c.target.value}),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nhập tên tin báo",required:!0})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[f.jsx(ai,{size:16,className:"inline mr-1"}),"Tội Danh (Điều, Khoản)"]}),f.jsx(sn,{value:n.charges,onChange:c=>i({...n,charges:c}),options:o,placeholder:"Nhập hoặc tìm kiếm tội danh",required:!0,icon:f.jsx(ai,{size:16})})]}),f.jsx(ir,{value:n.resolutionDeadline,onChange:c=>i({...n,resolutionDeadline:c}),label:"Ngày Hết Hạn Giải Quyết",required:!0}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[f.jsx(Nn,{size:16,className:"inline mr-1"}),"Kiểm Sát Viên Phụ Trách"]}),f.jsx(sn,{value:n.prosecutor,onChange:c=>i({...n,prosecutor:c}),options:l,placeholder:"Nhập hoặc chọn kiểm sát viên",required:!0,icon:f.jsx(Nn,{size:16})})]}),f.jsxs("div",{className:"md:col-span-2",children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[f.jsx(De,{size:16,className:"inline mr-1"}),"Ghi Chú"]}),f.jsx("textarea",{value:n.notes||"",onChange:c=>i({...n,notes:c.target.value}),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nhập ghi chú (tùy chọn)",rows:3})]})]}),f.jsxs("div",{className:"flex justify-end gap-3",children:[f.jsx("button",{type:"button",onClick:a,className:"px-6 py-3 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors font-medium",disabled:!n.name.trim()||!n.charges.trim()||!n.prosecutor.trim(),children:"Khởi Tố Ngay"}),f.jsx("button",{type:"submit",className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors font-medium",children:"Thêm Tin Báo"})]})]})]})},Gk=({report:e,onSave:t,onClose:r})=>{const[n,i]=ee.useState({...e}),s=l=>{l.preventDefault(),t(n),r()},a=bo.map(l=>({value:li(l),label:li(l),description:l.description})),o=jg.map(l=>({value:l.name,label:l.name,description:`${l.title}${l.department?` - ${l.department}`:""}`}));return f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[f.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Chỉnh Sửa Tin Báo"}),f.jsx("button",{onClick:r,className:"text-gray-500 hover:text-gray-700",children:f.jsx(zs,{size:24})})]}),f.jsxs("form",{onSubmit:s,className:"p-6 space-y-6",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[f.jsx(De,{size:16,className:"inline mr-1"}),"Tên Tin Báo"]}),f.jsx("input",{type:"text",value:n.name,onChange:l=>i({...n,name:l.target.value}),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[f.jsx(ai,{size:16,className:"inline mr-1"}),"Tội Danh (Điều, Khoản)"]}),f.jsx(sn,{value:n.charges,onChange:l=>i({...n,charges:l}),options:a,placeholder:"Nhập hoặc tìm kiếm tội danh",required:!0,icon:f.jsx(ai,{size:16})})]}),f.jsx(ir,{value:n.resolutionDeadline,onChange:l=>i({...n,resolutionDeadline:l}),label:"Ngày Hết Hạn Giải Quyết",required:!0}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[f.jsx(Nn,{size:16,className:"inline mr-1"}),"Kiểm Sát Viên Phụ Trách"]}),f.jsx(sn,{value:n.prosecutor,onChange:l=>i({...n,prosecutor:l}),options:o,placeholder:"Nhập hoặc chọn kiểm sát viên",required:!0,icon:f.jsx(Nn,{size:16})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trạng Thái"}),f.jsxs("select",{value:n.stage,onChange:l=>i({...n,stage:l.target.value}),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[f.jsx("option",{value:"Đang xử lý",children:"Đang xử lý"}),f.jsx("option",{value:"Khởi tố",children:"Khởi tố"}),f.jsx("option",{value:"Không khởi tố",children:"Không khởi tố"}),f.jsx("option",{value:"Tạm đình chỉ",children:"Tạm đình chỉ"})]})]}),n.stage==="Khởi tố"&&f.jsx(ir,{value:n.prosecutionDate||"",onChange:l=>i({...n,prosecutionDate:l}),label:"Ngày Khởi Tố"}),(n.stage==="Không khởi tố"||n.stage==="Tạm đình chỉ")&&f.jsx(ir,{value:n.resolutionDate||"",onChange:l=>i({...n,resolutionDate:l}),label:n.stage==="Không khởi tố"?"Ngày Quyết Định":"Ngày Tạm Đình Chỉ"}),f.jsxs("div",{className:"md:col-span-2",children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[f.jsx(De,{size:16,className:"inline mr-1"}),"Ghi Chú"]}),f.jsx("textarea",{value:n.notes||"",onChange:l=>i({...n,notes:l.target.value}),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nhập ghi chú (tùy chọn)",rows:3})]})]}),f.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t",children:[f.jsx("button",{type:"button",onClick:r,className:"px-6 py-3 text-gray-600 hover:text-gray-800 transition-colors",children:"Hủy"}),f.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors font-medium",children:[f.jsx(ho,{size:16}),"Lưu Thay Đổi"]})]})]})]})})},Kk=({reports:e,columns:t,onDeleteReport:r,onTransferStage:n,onUpdateReport:i,onTransferToCase:s})=>{const[a,o]=ee.useState(new Set),[l,c]=ee.useState(null),[u,h]=ee.useState(null),[d,m]=ee.useState(new Set),g=C=>{const R=new Set(a);R.has(C)?R.delete(C):R.add(C),o(R)},p=C=>{const R=new Set(d);R.has(C)?R.delete(C):R.add(C),m(R)},v=C=>{const R={name:C.name,charges:C.charges,investigationDeadline:lt(),prosecutor:C.prosecutor,notes:C.notes,defendants:[]};s(R),n(C.id,"Khởi tố"),alert("Tin báo đã được khởi tố và chuyển sang hệ thống quản lý vụ án!")},x=C=>{const R=[];return C.stage==="Đang xử lý"&&(R.push(f.jsxs("button",{onClick:()=>v(C),className:"flex items-center gap-1 px-2 py-1 bg-green-600 text-white rounded text-xs hover:bg-green-700 transition-colors whitespace-nowrap",children:[f.jsx(Vf,{size:12}),"Khởi tố"]},"prosecute")),R.push(f.jsxs("button",{onClick:()=>n(C.id,"Không khởi tố"),className:"flex items-center gap-1 px-2 py-1 bg-red-600 text-white rounded text-xs hover:bg-red-700 transition-colors whitespace-nowrap",children:[f.jsx(z2,{size:12}),"Không KT"]},"not-prosecute")),R.push(f.jsxs("button",{onClick:()=>n(C.id,"Tạm đình chỉ"),className:"flex items-center gap-1 px-2 py-1 bg-orange-600 text-white rounded text-xs hover:bg-orange-700 transition-colors whitespace-nowrap",children:[f.jsx(gg,{size:12}),"Tạm ĐC"]},"suspend")),R.push(f.jsxs("button",{onClick:()=>n(C.id,"Chuyển đi"),className:"flex items-center gap-1 px-2 py-1 bg-cyan-600 text-white rounded text-xs hover:bg-cyan-700 transition-colors whitespace-nowrap",children:[f.jsx(vg,{size:12}),"Chuyển đi"]},"transfer"))),R},w=C=>f.jsxs("div",{className:"max-w-xs",children:[f.jsx("div",{className:"font-medium text-gray-900 truncate",title:C.name,children:C.name}),f.jsx("div",{className:"text-sm text-gray-500 truncate",title:C.charges,children:C.charges})]}),y=C=>C.notes?f.jsx("div",{className:"max-w-xs",children:f.jsx("div",{className:"text-sm text-gray-900 truncate",title:C.notes,children:C.notes})}):"-",E=(C,R)=>{switch(R.key){case"name":return w(C);case"notes":return y(C);case"resolutionDeadline":const D=Gn(C.resolutionDeadline),F=D<=15;return f.jsxs("div",{className:F?"text-red-600 font-medium":"",children:[C.resolutionDeadline,F&&f.jsxs("div",{className:"text-xs",children:["(còn ",D," ngày)"]})]});case"actions":const N=x(C),P=d.has(C.id);return f.jsxs("div",{className:"relative",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs("button",{onClick:()=>h(C),className:"flex items-center gap-1 px-2 py-1 bg-yellow-600 text-white rounded text-xs hover:bg-yellow-700 transition-colors whitespace-nowrap",children:[f.jsx(Jl,{size:12}),"Sửa"]}),N.length>0&&N[0],N.length>1&&f.jsx("button",{onClick:()=>p(C.id),className:"flex items-center gap-1 px-2 py-1 bg-gray-600 text-white rounded text-xs hover:bg-gray-700 transition-colors",children:f.jsx(mg,{size:12})})]}),P&&N.length>1&&f.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded shadow-lg z-10 min-w-max",children:f.jsxs("div",{className:"p-2 space-y-1",children:[N.slice(1).map((W,G)=>f.jsx("div",{className:"block",children:W},G)),f.jsxs("button",{onClick:()=>c(C.id),className:"flex items-center gap-1 px-2 py-1 bg-red-600 text-white rounded text-xs hover:bg-red-700 transition-colors whitespace-nowrap w-full",children:[f.jsx(Zl,{size:12}),"Xóa"]})]})})]});default:return R.render?R.render(C):C[R.key]}};return f.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mở rộng"}),t.map(C=>f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:C.label},C.key))]})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(C=>f.jsxs(l1.Fragment,{children:[f.jsxs("tr",{className:"hover:bg-gray-50",children:[f.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f.jsx("button",{onClick:()=>g(C.id),className:"text-gray-500 hover:text-gray-700",children:a.has(C.id)?f.jsx(Gf,{size:20}):f.jsx(hg,{size:20})})}),t.map(R=>f.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:E(C,R)},R.key))]}),a.has(C.id)&&f.jsx("tr",{children:f.jsx("td",{colSpan:t.length+1,className:"px-6 py-4 bg-gray-50",children:f.jsxs("div",{className:"space-y-2",children:[f.jsx("h4",{className:"font-medium text-gray-900",children:"Chi tiết Tin báo:"}),f.jsx("div",{className:"bg-white p-3 rounded border",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm",children:[f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Tên tin báo:"})," ",C.name]}),f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Tội danh:"})," ",C.charges]}),f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Hạn giải quyết:"})," ",C.resolutionDeadline]}),f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"KSV phụ trách:"})," ",C.prosecutor]}),f.jsxs("div",{children:[f.jsx("span",{className:"font-medium",children:"Trạng thái:"})," ",C.stage]}),C.notes&&f.jsxs("div",{className:"md:col-span-3",children:[f.jsx("span",{className:"font-medium",children:"Ghi chú:"})," ",C.notes]})]})})]})})})]},C.id))})]})}),e.length===0&&f.jsx("div",{className:"text-center py-8 text-gray-500",children:"Không có tin báo nào"}),u&&f.jsx(Gk,{report:u,onSave:i,onClose:()=>h(null)}),l&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl max-w-sm w-full mx-4",children:[f.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Xác nhận xóa"}),f.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Bạn có chắc chắn muốn xóa tin báo này không? Hành động này không thể hoàn tác."}),f.jsxs("div",{className:"flex justify-end gap-3",children:[f.jsx("button",{onClick:()=>c(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Hủy"}),f.jsx("button",{onClick:()=>{r(l),c(null)},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Xóa"})]})]})})]})},Xk=({reports:e})=>{const[t,r]=ee.useState(lt()),[n,i]=ee.useState(lt()),a=(()=>{const g=qt(t),p=qt(n);return e.filter(v=>{const x=qt(v.createdAt);return x>=g&&x<=p})})(),o=()=>a.length,l=()=>{const g=a.filter(p=>["Khởi tố","Không khởi tố","Tạm đình chỉ","Chuyển đi"].includes(p.stage));return{prosecuted:g.filter(p=>p.stage==="Khởi tố").length,notProsecuted:g.filter(p=>p.stage==="Không khởi tố").length,suspended:g.filter(p=>p.stage==="Tạm đình chỉ").length,transferred:g.filter(p=>p.stage==="Chuyển đi").length,total:g.length}},c=()=>({pending:a.filter(g=>g.stage==="Đang xử lý").length,prosecuted:a.filter(g=>g.stage==="Khởi tố").length,notProsecuted:a.filter(g=>g.stage==="Không khởi tố").length,suspended:a.filter(g=>g.stage==="Tạm đình chỉ").length,transferred:a.filter(g=>g.stage==="Chuyển đi").length}),u=o(),h=l(),d=c(),m=({title:g,value:p,icon:v,color:x,subtitle:w})=>f.jsx("div",{className:`${x} p-6 rounded-lg shadow-md text-white`,children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm opacity-90",children:g}),f.jsx("p",{className:"text-3xl font-bold",children:p}),w&&f.jsx("p",{className:"text-sm opacity-75 mt-1",children:w})]}),f.jsx("div",{className:"text-white opacity-80",children:v})]})});return f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[f.jsx("div",{className:"flex justify-between items-center mb-6",children:f.jsxs("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[f.jsx(ji,{className:"text-blue-600",size:24}),"Thống Kê Tin Báo"]})}),f.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[f.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Khoảng Thời Gian Thống Kê"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(ir,{value:t,onChange:r,label:"Thống kê từ ngày",required:!0}),f.jsx(ir,{value:n,onChange:i,label:"Thống kê đến ngày",required:!0})]}),f.jsxs("div",{className:"mt-3 text-sm text-gray-600",children:["Thống kê từ ",t," đến ",n," (",a.length," tin báo)"]})]}),f.jsxs("div",{className:"mb-8",children:[f.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[f.jsx(yg,{size:20,className:"text-green-600"}),"Tin Báo Mới Tiếp Nhận"]}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-4",children:f.jsx(m,{title:"Số Tin Báo Mới",value:u,icon:f.jsx(De,{size:32}),color:"bg-green-600"})})]}),f.jsxs("div",{className:"mb-8",children:[f.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[f.jsx(ji,{size:20,className:"text-purple-600"}),"Tin Báo Đã Xử Lý"]}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-4 mb-4",children:f.jsx(m,{title:"Tổng Tin Báo Đã Xử Lý",value:h.total,icon:f.jsx(De,{size:32}),color:"bg-purple-600"})}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[f.jsx(m,{title:"Khởi Tố",value:h.prosecuted,icon:f.jsx(De,{size:24}),color:"bg-green-500",subtitle:"tin báo"}),f.jsx(m,{title:"Không Khởi Tố",value:h.notProsecuted,icon:f.jsx(De,{size:24}),color:"bg-red-500",subtitle:"tin báo"}),f.jsx(m,{title:"Tạm Đình Chỉ",value:h.suspended,icon:f.jsx(De,{size:24}),color:"bg-yellow-500",subtitle:"tin báo"}),f.jsx(m,{title:"Chuyển Đi",value:h.transferred,icon:f.jsx(De,{size:24}),color:"bg-cyan-500",subtitle:"tin báo"})]})]}),f.jsxs("div",{children:[f.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[f.jsx(ji,{size:20,className:"text-blue-600"}),"Phân Bố Theo Trạng Thái"]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[f.jsx(m,{title:"Đang Xử Lý",value:d.pending,icon:f.jsx(De,{size:24}),color:"bg-yellow-600",subtitle:"tin báo"}),f.jsx(m,{title:"Khởi Tố",value:d.prosecuted,icon:f.jsx(De,{size:24}),color:"bg-green-600",subtitle:"tin báo"}),f.jsx(m,{title:"Không Khởi Tố",value:d.notProsecuted,icon:f.jsx(De,{size:24}),color:"bg-red-600",subtitle:"tin báo"}),f.jsx(m,{title:"Tạm Đình Chỉ",value:d.suspended,icon:f.jsx(De,{size:24}),color:"bg-orange-600",subtitle:"tin báo"}),f.jsx(m,{title:"Chuyển Đi",value:d.transferred,icon:f.jsx(De,{size:24}),color:"bg-cyan-600",subtitle:"tin báo"})]})]}),f.jsxs("div",{className:"mt-8 overflow-x-auto",children:[f.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Bảng Tổng Hợp"}),f.jsxs("table",{className:"w-full border border-gray-200 rounded-lg",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-700",children:"Chỉ Tiêu"}),f.jsx("th",{className:"px-4 py-3 text-center font-medium text-gray-700",children:"Số Tin Báo"})]})}),f.jsxs("tbody",{className:"divide-y divide-gray-200",children:[f.jsxs("tr",{className:"bg-green-50",children:[f.jsx("td",{className:"px-4 py-3 font-medium",children:"Mới tiếp nhận trong kỳ"}),f.jsx("td",{className:"px-4 py-3 text-center font-bold text-green-600",children:u})]}),f.jsxs("tr",{className:"bg-purple-50",children:[f.jsx("td",{className:"px-4 py-3 font-medium",children:"Đã xử lý trong kỳ"}),f.jsx("td",{className:"px-4 py-3 text-center font-bold text-purple-600",children:h.total})]}),f.jsxs("tr",{children:[f.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 pl-8",children:"- Khởi tố"}),f.jsx("td",{className:"px-4 py-3 text-center text-green-600",children:h.prosecuted})]}),f.jsxs("tr",{children:[f.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 pl-8",children:"- Không khởi tố"}),f.jsx("td",{className:"px-4 py-3 text-center text-red-600",children:h.notProsecuted})]}),f.jsxs("tr",{children:[f.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 pl-8",children:"- Tạm đình chỉ"}),f.jsx("td",{className:"px-4 py-3 text-center text-yellow-600",children:h.suspended})]}),f.jsxs("tr",{children:[f.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 pl-8",children:"- Chuyển đi"}),f.jsx("td",{className:"px-4 py-3 text-center text-cyan-600",children:h.transferred})]})]})]})]})]})},Yk=({onLogin:e})=>{const[t,r]=ee.useState(""),[n,i]=ee.useState(""),[s,a]=ee.useState(""),[o,l]=ee.useState(!1),c=async u=>{if(u.preventDefault(),a(""),l(!0),!t.trim()||!n.trim()){a("Vui lòng nhập đầy đủ thông tin"),l(!1);return}(await e(t,n)).success||a("Email hoặc mật khẩu không đúng. Vui lòng thử lại."),l(!1)};return f.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-8",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx("div",{className:"flex justify-center mb-4",children:f.jsx(La,{className:"text-blue-600",size:48})}),f.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Hệ Thống Quản Lý"}),f.jsx("p",{className:"text-gray-600 mt-2",children:"Vụ Án & Tin Báo"})]}),f.jsxs("form",{onSubmit:c,className:"space-y-6",children:[f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[f.jsx(Nn,{size:16,className:"inline mr-1"}),"Email"]}),f.jsx("input",{type:"email",value:t,onChange:u=>r(u.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nhập địa chỉ email của bạn",required:!0,disabled:o})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[f.jsx(B2,{size:16,className:"inline mr-1"}),"Mật khẩu"]}),f.jsx("input",{type:"password",value:n,onChange:u=>i(u.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nhập mật khẩu",required:!0,disabled:o})]}),s&&f.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:s}),f.jsxs("button",{type:"submit",disabled:o,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:[f.jsx(U2,{size:16}),o?"Đang đăng nhập...":"Đăng Nhập"]})]}),f.jsx("div",{className:"mt-6 text-center text-sm text-gray-500",children:f.jsx("p",{children:"Liên hệ quản trị viên để được cấp tài khoản"})})]})})},qk=(e,t)=>{const[r,n]=ee.useState([]),[i,s]=ee.useState(!0);return ee.useEffect(()=>{if(!t)return;(async()=>{try{const m=await wn.loadData("cases");n(m)}catch(m){console.error("Failed to load cases:",m);const g=localStorage.getItem(`legalCases_${e}`);g&&n(JSON.parse(g))}finally{s(!1)}})()},[e,t]),ee.useEffect(()=>{if(!t||i||r.length<0)return;(async()=>{try{await wn.saveData("cases",r),localStorage.setItem(`legalCases_${e}`,JSON.stringify(r))}catch(m){console.error("Failed to save cases:",m),localStorage.setItem(`legalCases_${e}`,JSON.stringify(r))}})()},[r,e,i,t]),{cases:r,addCase:d=>{const m={id:Date.now().toString(),...d,stage:"Điều tra",defendants:d.defendants.map(g=>({...g,id:Date.now().toString()+Math.random().toString(36).substr(2,9)})),createdAt:lt()};n(g=>[...g,m])},updateCase:d=>{n(m=>m.map(g=>g.id===d.id?d:g))},deleteCase:d=>{n(m=>m.filter(g=>g.id!==d))},transferStage:(d,m)=>{n(g=>g.map(p=>{if(p.id===d){const v={...p,stage:m};return m==="Truy tố"&&!p.prosecutionTransferDate?v.prosecutionTransferDate=lt():m==="Xét xử"&&!p.trialTransferDate&&(v.trialTransferDate=lt()),v}return p}))},getCasesByStage:d=>r.filter(m=>m.stage===d),getExpiringSoonCases:()=>r.filter(d=>{if(d.stage!=="Điều tra")return!1;const m=new Date,p=new Date(d.investigationDeadline.split("/").reverse().join("-")).getTime()-m.getTime();return Math.ceil(p/(1e3*60*60*24))<=15?!0:d.defendants.filter(w=>w.preventiveMeasure==="Tạm giam"&&w.detentionDeadline).some(w=>{const E=new Date(w.detentionDeadline.split("/").reverse().join("-")).getTime()-m.getTime();return Math.ceil(E/(1e3*60*60*24))<=15})}),isLoading:i}},Qk=(e,t)=>{const[r,n]=ee.useState([]),[i,s]=ee.useState(!0);return ee.useEffect(()=>{if(!t)return;(async()=>{try{const m=await wn.loadData("reports");n(m)}catch(m){console.error("Failed to load reports:",m);const g=localStorage.getItem(`legalReports_${e}`);g&&n(JSON.parse(g))}finally{s(!1)}})()},[e,t]),ee.useEffect(()=>{if(!t||i||r.length<0)return;(async()=>{try{await wn.saveData("reports",r),localStorage.setItem(`legalReports_${e}`,JSON.stringify(r))}catch(m){console.error("Failed to save reports:",m),localStorage.setItem(`legalReports_${e}`,JSON.stringify(r))}})()},[r,e,i,t]),{reports:r,addReport:d=>{const m={id:Date.now().toString(),...d,stage:"Đang xử lý",createdAt:lt()};n(g=>[...g,m])},updateReport:d=>{n(m=>m.map(g=>g.id===d.id?d:g))},deleteReport:d=>{n(m=>m.filter(g=>g.id!==d))},transferReportStage:(d,m)=>{n(g=>g.map(p=>{if(p.id===d){const v={...p,stage:m};return m==="Khởi tố"&&!p.prosecutionDate?v.prosecutionDate=lt():(m==="Không khởi tố"||m==="Tạm đình chỉ"||m==="Chuyển đi")&&!p.resolutionDate&&(v.resolutionDate=lt()),v}return p}))},getReportsByStage:d=>r.filter(m=>m.stage===d),getExpiringSoonReports:()=>r.filter(d=>{if(d.stage!=="Đang xử lý")return!1;const m=new Date,p=new Date(d.resolutionDeadline.split("/").reverse().join("-")).getTime()-m.getTime();return Math.ceil(p/(1e3*60*60*24))<=15}),isLoading:i}},Jk=()=>{const{user:e,isAuthenticated:t,loading:r}=rh(),[n,i]=ee.useState([]),[s,a]=ee.useState(!0),[o,l]=ee.useState(null),c=ee.useCallback(async()=>{if(!r){if(a(!0),l(null),t&&e)try{const u=await Ca();i(u)}catch(u){console.error("Failed to load prosecutors:",u),l("Không thể tải danh sách Kiểm sát viên: "+u.message),i([])}else i([]),console.log("Người dùng chưa xác thực hoặc không có, xóa dữ liệu Kiểm sát viên.");a(!1)}},[t,e,r]);return ee.useEffect(()=>{c()},[c]),{prosecutors:n,loading:s,error:o,setProsecutors:i}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ic={};ic.version="0.18.5";var ox=1252,Zk=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],lx=function(e){Zk.indexOf(e)!=-1&&(ox=e)};function e4(){lx(1252)}var mo=function(e){lx(e)};function t4(){mo(1200),e4()}var al=function(t){return String.fromCharCode(t)},hp=function(t){return String.fromCharCode(t)},Ni,Kn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function go(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),a=(r&3)<<4|n>>4,i=e.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),t+=Kn.charAt(s)+Kn.charAt(a)+Kn.charAt(o)+Kn.charAt(l);return t}function An(e){var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=Kn.indexOf(e.charAt(c++)),a=Kn.indexOf(e.charAt(c++)),r=s<<2|a>>4,t+=String.fromCharCode(r),o=Kn.indexOf(e.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Kn.indexOf(e.charAt(c++)),i=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var Fe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Pn=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Hi(e){return Fe?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function dp(e){return Fe?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var $r=function(t){return Fe?Pn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function $c(e){if(typeof ArrayBuffer>"u")return $r(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Oo(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function r4(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Ot=Fe?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Pn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function n4(e){for(var t=[],r=0,n=e.length+250,i=Hi(e.length+255),s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Hi(65535),n=65530)}return t.push(i.slice(0,r)),Ot(t)}var Ha=/\u0000/g,ol=/[\u0001-\u0006]/g;function Ps(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Hr(e,t){var r=""+e;return r.length>=t?r:nt("0",t-r.length)+r}function nh(e,t){var r=""+e;return r.length>=t?r:nt(" ",t-r.length)+r}function sc(e,t){var r=""+e;return r.length>=t?r:r+nt(" ",t-r.length)}function i4(e,t){var r=""+Math.round(e);return r.length>=t?r:nt("0",t-r.length)+r}function s4(e,t){var r=""+e;return r.length>=t?r:nt("0",t-r.length)+r}var pp=Math.pow(2,32);function os(e,t){if(e>pp||e<-pp)return i4(e,t);var r=Math.round(e);return s4(r,t)}function ac(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var mp=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Pu=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function a4(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var it={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},gp={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},o4={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function oc(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,a=1,o=0,l=1,c=0,u=0,h=Math.floor(i);c<t&&(h=Math.floor(i),o=h*a+s,u=h*c+l,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=s):(u=c,o=a)),!r)return[0,n*o,u];var d=Math.floor(n*o/u);return[d,n*o-d*u,u]}function ll(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,a=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=p4(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var cx=new Date(1899,11,31,0,0,0),l4=cx.getTime(),c4=new Date(1900,2,1,0,0,0);function ux(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=c4&&(r+=24*60*60*1e3),(r-(l4+(e.getTimezoneOffset()-cx.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function ih(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function u4(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function f4(e){var t=e<0?12:11,r=ih(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function h4(e){var t=ih(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function d4(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=f4(e):t===10?r=e.toFixed(10).substr(0,12):r=h4(e),ih(u4(r.toUpperCase()))}function G0(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):d4(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ci(14,ux(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function p4(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function m4(e,t,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return Pu[r.m-1][1];case 5:return Pu[r.m-1][0];default:return Pu[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return mp[r.q][0];default:return mp[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Hr(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(i=Hr(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?Hr(l,c):"";return u}function Xn(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var fx=/%/g;function g4(e,t,r){var n=t.replace(fx,""),i=t.length-n.length;return _n(e,n,r*Math.pow(10,2*i))+nt("%",i)}function x4(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return _n(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function hx(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+hx(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var dx=/# (\?+)( ?)\/( ?)(\d+)/;function v4(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?nt(" ",e[1].length+1+e[4].length):nh(a,e[1].length)+e[2]+"/"+e[3]+Hr(o,e[4].length))}function y4(e,t,r){return r+(t===0?"":""+t)+nt(" ",e[1].length+2+e[4].length)}var px=/^#*0*\.([0#]+)/,mx=/\).*[0#]/,gx=/\(###\) ###\\?-####/;function Kt(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function xp(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function vp(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function w4(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function _4(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Sr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(mx)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Sr("n",n,r):"("+Sr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return x4(e,t,r);if(t.indexOf("%")!==-1)return g4(e,t,r);if(t.indexOf("E")!==-1)return hx(t,r);if(t.charCodeAt(0)===36)return"$"+Sr(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+os(l,t.length);if(t.match(/^[#?]+$/))return i=os(r,0),i==="0"&&(i=""),i.length>t.length?i:Kt(t.substr(0,t.length-i.length))+i;if(s=t.match(dx))return v4(s,l,c);if(t.match(/^#+0+$/))return c+os(l,t.length-t.indexOf("0"));if(s=t.match(px))return i=xp(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Kt(s[1])).replace(/\.$/,"."+Kt(s[1])).replace(/\.(\d*)$/,function(g,p){return"."+p+nt("0",Kt(s[1]).length-p.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+xp(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Xn(os(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Sr(e,t,-r):Xn(""+(Math.floor(r)+w4(r,s[1].length)))+"."+Hr(vp(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Sr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ps(Sr(e,t.replace(/[\\-]/g,""),r)),a=0,Ps(Ps(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(t.match(gx))return i=Sr(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=oc(l,Math.pow(10,a)-1,!1),i=""+c,u=_n("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=sc(o[2],a),u.length<s[4].length&&(u=Kt(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=oc(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?nh(o[1],a)+s[2]+"/"+s[3]+sc(o[2],a):nt(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=os(r,0),t.length<=i.length?i:Kt(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=t.indexOf(".")-a,d=t.length-i.length-h;return Kt(t.substr(0,h)+i+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=vp(r,s[1].length),r<0?"-"+Sr(e,t,-r):Xn(_4(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Hr(0,3-g.length):"")+g})+"."+Hr(a,s[1].length);switch(t){case"###,##0.00":return Sr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Xn(os(l,0));return m!=="0"?c+m:"";case"###,###.00":return Sr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Sr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function T4(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return _n(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function E4(e,t,r){var n=t.replace(fx,""),i=t.length-n.length;return _n(e,n,r*Math.pow(10,2*i))+nt("%",i)}function xx(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+xx(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Xr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(mx)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Xr("n",n,r):"("+Xr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return T4(e,t,r);if(t.indexOf("%")!==-1)return E4(e,t,r);if(t.indexOf("E")!==-1)return xx(t,r);if(t.charCodeAt(0)===36)return"$"+Xr(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Hr(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Kt(t.substr(0,t.length-i.length))+i;if(s=t.match(dx))return y4(s,l,c);if(t.match(/^#+0+$/))return c+Hr(l,t.length-t.indexOf("0"));if(s=t.match(px))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Kt(s[1])).replace(/\.$/,"."+Kt(s[1])),i=i.replace(/\.(\d*)$/,function(g,p){return"."+p+nt("0",Kt(s[1]).length-p.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Xn(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Xr(e,t,-r):Xn(""+r)+"."+nt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Xr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ps(Xr(e,t.replace(/[\\-]/g,""),r)),a=0,Ps(Ps(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<i.length?i.charAt(a++):g==="0"?"0":""}));if(t.match(gx))return i=Xr(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=oc(l,Math.pow(10,a)-1,!1),i=""+c,u=_n("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=sc(o[2],a),u.length<s[4].length&&(u=Kt(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=oc(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?nh(o[1],a)+s[2]+"/"+s[3]+sc(o[2],a):nt(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Kt(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=t.indexOf(".")-a,d=t.length-i.length-h;return Kt(t.substr(0,h)+i+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Xr(e,t,-r):Xn(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Hr(0,3-g.length):"")+g})+"."+Hr(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=Xn(""+l);return m!=="0"?c+m:"";default:if(t.match(/\.[0#?]*$/))return Xr(e,t.slice(0,t.lastIndexOf(".")),r)+Kt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function _n(e,t,r){return(r|0)===r?Xr(e,t,r):Sr(e,t,r)}function S4(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var vx=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function yx(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":ac(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(vx))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function k4(e,t,r,n){for(var i=[],s="",a=0,o="",l="t",c,u,h,d="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!ac(e,a))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=e.charCodeAt(++a))!==34&&a<e.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var m=e.charAt(++a),g=m==="("||m===")"?m:"t";i[i.length]={t:g,v:m},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(c==null&&(c=ll(t,r,e.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=ll(t,r),c==null))return"";for(s=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"上":var p={t:o,v:o};if(c==null&&(c=ll(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(p.v=c.H>=12?"P":"A"),p.t="T",d="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(p.v=c.H>=12?"PM":"AM"),p.t="T",a+=5,d="h"):e.substr(a,5).toUpperCase()==="上午/下午"?(c!=null&&(p.v=c.H>=12?"下午":"上午"),p.t="T",a+=5,d="h"):(p.t="t",++a),c==null&&p.t==="T")return"";i[i.length]=p,l=o;break;case"[":for(s=o;e.charAt(a++)!=="]"&&a<e.length;)s+=e.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(vx)){if(c==null&&(c=ll(t,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",yx(e)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<e.length&&(o=e.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)s+=e.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++a;break}var v=0,x=0,w;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=d,l="h",v<1&&(v=1);break;case"s":(w=i[a].v.match(/\.0+$/))&&(x=Math.max(x,w[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&i[a].v.match(/[Hh]/)&&(v=1),v<2&&i[a].v.match(/[Mm]/)&&(v=2),v<3&&i[a].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",E;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=m4(i[a].t.charCodeAt(0),i[a].v,c,x),i[a].t="t";break;case"n":case"?":for(E=a+1;i[E]!=null&&((o=i[E].t)==="?"||o==="D"||(o===" "||o==="t")&&i[E+1]!=null&&(i[E+1].t==="?"||i[E+1].t==="t"&&i[E+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[E].v==="/"||i[E].v===" "&&i[E+1]!=null&&i[E+1].t=="?"));)i[a].v+=i[E].v,i[E]={v:"",t:";"},++E;y+=i[a].v,a=E-1;break;case"G":i[a].t="t",i[a].v=G0(t,r);break}var C="",R,D;if(y.length>0){y.charCodeAt(0)==40?(R=t<0&&y.charCodeAt(0)===45?-t:t,D=_n("n",y,R)):(R=t<0&&n>1?-t:t,D=_n("n",y,R),R<0&&i[0]&&i[0].t=="t"&&(D=D.substr(1),i[0].v="-"+i[0].v)),E=D.length-1;var F=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){F=a;break}var N=i.length;if(F===i.length&&D.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(E>=i[a].v.length-1?(E-=i[a].v.length,i[a].v=D.substr(E+1,i[a].v.length)):E<0?i[a].v="":(i[a].v=D.substr(0,E+1),E=-1),i[a].t="t",N=a);E>=0&&N<i.length&&(i[N].v=D.substr(0,E+1)+i[N].v)}else if(F!==i.length&&D.indexOf("E")===-1){for(E=D.indexOf(".")-1,a=F;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(u=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")-1:i[a].v.length-1,C=i[a].v.substr(u+1);u>=0;--u)E>=0&&(i[a].v.charAt(u)==="0"||i[a].v.charAt(u)==="#")&&(C=D.charAt(E--)+C);i[a].v=C,i[a].t="t",N=a}for(E>=0&&N<i.length&&(i[N].v=D.substr(0,E+1)+i[N].v),E=D.indexOf(".")+1,a=F;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==F)){for(u=i[a].v.indexOf(".")>-1&&a===F?i[a].v.indexOf(".")+1:0,C=i[a].v.substr(0,u);u<i[a].v.length;++u)E<D.length&&(C+=D.charAt(E++));i[a].v=C,i[a].t="t",N=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(R=n>1&&t<0&&a>0&&i[a-1].v==="-"?-t:t,i[a].v=_n(i[a].t,i[a].v,R),i[a].t="t");var P="";for(a=0;a!==i.length;++a)i[a]!=null&&(P+=i[a].v);return P}var yp=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function wp(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function C4(e,t){var r=S4(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(yp),o=r[1].match(yp);return wp(t,a)?[n,r[0]]:wp(t,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function ci(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:it)[e],n==null&&(n=r.table&&r.table[gp[e]]||it[gp[e]]),n==null&&(n=o4[e]||"General");break}if(ac(n,0))return G0(t,r);t instanceof Date&&(t=ux(t,r.date1904));var i=C4(n,t);if(ac(i[1]))return G0(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return k4(i[1],t,r,i[0])}function wx(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(it[r]==null){t<0&&(t=r);continue}if(it[r]==e){t=r;break}}t<0&&(t=391)}return it[t]=e,t}function Hc(e){for(var t=0;t!=392;++t)e[t]!==void 0&&wx(e[t],t)}function zc(){it=a4()}var _x=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function b4(e){var t=typeof e=="number"?it[e]:e;return t=t.replace(_x,"(\\d+)"),new RegExp("^"+t+"$")}function N4(e,t,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(t.match(_x)||[]).forEach(function(h,d){var m=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=m;break;case"d":s=m;break;case"h":a=m;break;case"s":l=m;break;case"m":a>=0?o=m:i=m;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?u:c+"T"+u}var A4=function(){var e={};e.version="1.2.0";function t(){for(var D=0,F=new Array(256),N=0;N!=256;++N)D=N,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,F[N]=D;return typeof Int32Array<"u"?new Int32Array(F):F}var r=t();function n(D){var F=0,N=0,P=0,W=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(P=0;P!=256;++P)W[P]=D[P];for(P=0;P!=256;++P)for(N=D[P],F=256+P;F<4096;F+=256)N=W[F]=N>>>8^D[N&255];var G=[];for(P=1;P!=16;++P)G[P-1]=typeof Int32Array<"u"?W.subarray(P*256,P*256+256):W.slice(P*256,P*256+256);return G}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],u=i[5],h=i[6],d=i[7],m=i[8],g=i[9],p=i[10],v=i[11],x=i[12],w=i[13],y=i[14];function E(D,F){for(var N=F^-1,P=0,W=D.length;P<W;)N=N>>>8^r[(N^D.charCodeAt(P++))&255];return~N}function C(D,F){for(var N=F^-1,P=D.length-15,W=0;W<P;)N=y[D[W++]^N&255]^w[D[W++]^N>>8&255]^x[D[W++]^N>>16&255]^v[D[W++]^N>>>24]^p[D[W++]]^g[D[W++]]^m[D[W++]]^d[D[W++]]^h[D[W++]]^u[D[W++]]^c[D[W++]]^l[D[W++]]^o[D[W++]]^a[D[W++]]^s[D[W++]]^r[D[W++]];for(P+=15;W<P;)N=N>>>8^r[(N^D[W++])&255];return~N}function R(D,F){for(var N=F^-1,P=0,W=D.length,G=0,Q=0;P<W;)G=D.charCodeAt(P++),G<128?N=N>>>8^r[(N^G)&255]:G<2048?(N=N>>>8^r[(N^(192|G>>6&31))&255],N=N>>>8^r[(N^(128|G&63))&255]):G>=55296&&G<57344?(G=(G&1023)+64,Q=D.charCodeAt(P++)&1023,N=N>>>8^r[(N^(240|G>>8&7))&255],N=N>>>8^r[(N^(128|G>>2&63))&255],N=N>>>8^r[(N^(128|Q>>6&15|(G&3)<<4))&255],N=N>>>8^r[(N^(128|Q&63))&255]):(N=N>>>8^r[(N^(224|G>>12&15))&255],N=N>>>8^r[(N^(128|G>>6&63))&255],N=N>>>8^r[(N^(128|G&63))&255]);return~N}return e.table=r,e.bstr=E,e.buf=C,e.str=R,e}(),He=function(){var t={};t.version="1.2.1";function r(_,k){for(var T=_.split("/"),S=k.split("/"),b=0,A=0,B=Math.min(T.length,S.length);b<B;++b){if(A=T[b].length-S[b].length)return A;if(T[b]!=S[b])return T[b]<S[b]?-1:1}return T.length-S.length}function n(_){if(_.charAt(_.length-1)=="/")return _.slice(0,-1).indexOf("/")===-1?_:n(_.slice(0,-1));var k=_.lastIndexOf("/");return k===-1?_:_.slice(0,k+1)}function i(_){if(_.charAt(_.length-1)=="/")return i(_.slice(0,-1));var k=_.lastIndexOf("/");return k===-1?_:_.slice(k+1)}function s(_,k){typeof k=="string"&&(k=new Date(k));var T=k.getHours();T=T<<6|k.getMinutes(),T=T<<5|k.getSeconds()>>>1,_.write_shift(2,T);var S=k.getFullYear()-1980;S=S<<4|k.getMonth()+1,S=S<<5|k.getDate(),_.write_shift(2,S)}function a(_){var k=_.read_shift(2)&65535,T=_.read_shift(2)&65535,S=new Date,b=T&31;T>>>=5;var A=T&15;T>>>=4,S.setMilliseconds(0),S.setFullYear(T+1980),S.setMonth(A-1),S.setDate(b);var B=k&31;k>>>=5;var K=k&63;return k>>>=6,S.setHours(k),S.setMinutes(K),S.setSeconds(B<<1),S}function o(_){dr(_,0);for(var k={},T=0;_.l<=_.length-4;){var S=_.read_shift(2),b=_.read_shift(2),A=_.l+b,B={};switch(S){case 21589:T=_.read_shift(1),T&1&&(B.mtime=_.read_shift(4)),b>5&&(T&2&&(B.atime=_.read_shift(4)),T&4&&(B.ctime=_.read_shift(4))),B.mtime&&(B.mt=new Date(B.mtime*1e3));break}_.l=A,k[S]=B}return k}var l;function c(){return l||(l={})}function u(_,k){if(_[0]==80&&_[1]==75)return Ch(_,k);if((_[0]|32)==109&&(_[1]|32)==105)return Qv(_,k);if(_.length<512)throw new Error("CFB file size "+_.length+" < 512");var T=3,S=512,b=0,A=0,B=0,K=0,M=0,U=[],z=_.slice(0,512);dr(z,0);var J=h(z);switch(T=J[0],T){case 3:S=512;break;case 4:S=4096;break;case 0:if(J[1]==0)return Ch(_,k);default:throw new Error("Major Version: Expected 3 or 4 saw "+T)}S!==512&&(z=_.slice(0,S),dr(z,28));var se=_.slice(0,S);d(z,T);var ue=z.read_shift(4,"i");if(T===3&&ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ue);z.l+=4,B=z.read_shift(4,"i"),z.l+=4,z.chk("00100000","Mini Stream Cutoff Size: "),K=z.read_shift(4,"i"),b=z.read_shift(4,"i"),M=z.read_shift(4,"i"),A=z.read_shift(4,"i");for(var te=-1,oe=0;oe<109&&(te=z.read_shift(4,"i"),!(te<0));++oe)U[oe]=te;var ye=m(_,S);v(M,A,ye,S,U);var qe=w(ye,B,U,S);qe[B].name="!Directory",b>0&&K!==Q&&(qe[K].name="!MiniFAT"),qe[U[0]].name="!FAT",qe.fat_addrs=U,qe.ssz=S;var Qe={},Lt=[],oa=[],la=[];y(B,qe,ye,Lt,b,Qe,oa,K),g(oa,la,Lt),Lt.shift();var ca={FileIndex:oa,FullPaths:la};return k&&k.raw&&(ca.raw={header:se,sectors:ye}),ca}function h(_){if(_[_.l]==80&&_[_.l+1]==75)return[0,0];_.chk(ve,"Header Signature: "),_.l+=16;var k=_.read_shift(2,"u");return[_.read_shift(2,"u"),k]}function d(_,k){var T=9;switch(_.l+=2,T=_.read_shift(2)){case 9:if(k!=3)throw new Error("Sector Shift: Expected 9 saw "+T);break;case 12:if(k!=4)throw new Error("Sector Shift: Expected 12 saw "+T);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+T)}_.chk("0600","Mini Sector Shift: "),_.chk("000000000000","Reserved: ")}function m(_,k){for(var T=Math.ceil(_.length/k)-1,S=[],b=1;b<T;++b)S[b-1]=_.slice(b*k,(b+1)*k);return S[T-1]=_.slice(T*k),S}function g(_,k,T){for(var S=0,b=0,A=0,B=0,K=0,M=T.length,U=[],z=[];S<M;++S)U[S]=z[S]=S,k[S]=T[S];for(;K<z.length;++K)S=z[K],b=_[S].L,A=_[S].R,B=_[S].C,U[S]===S&&(b!==-1&&U[b]!==b&&(U[S]=U[b]),A!==-1&&U[A]!==A&&(U[S]=U[A])),B!==-1&&(U[B]=S),b!==-1&&S!=U[S]&&(U[b]=U[S],z.lastIndexOf(b)<K&&z.push(b)),A!==-1&&S!=U[S]&&(U[A]=U[S],z.lastIndexOf(A)<K&&z.push(A));for(S=1;S<M;++S)U[S]===S&&(A!==-1&&U[A]!==A?U[S]=U[A]:b!==-1&&U[b]!==b&&(U[S]=U[b]));for(S=1;S<M;++S)if(_[S].type!==0){if(K=S,K!=U[K])do K=U[K],k[S]=k[K]+"/"+k[S];while(K!==0&&U[K]!==-1&&K!=U[K]);U[S]=-1}for(k[0]+="/",S=1;S<M;++S)_[S].type!==2&&(k[S]+="/")}function p(_,k,T){for(var S=_.start,b=_.size,A=[],B=S;T&&b>0&&B>=0;)A.push(k.slice(B*G,B*G+G)),b-=G,B=Ai(T,B*4);return A.length===0?V(0):Ot(A).slice(0,_.size)}function v(_,k,T,S,b){var A=Q;if(_===Q){if(k!==0)throw new Error("DIFAT chain shorter than expected")}else if(_!==-1){var B=T[_],K=(S>>>2)-1;if(!B)return;for(var M=0;M<K&&(A=Ai(B,M*4))!==Q;++M)b.push(A);v(Ai(B,S-4),k-1,T,S,b)}}function x(_,k,T,S,b){var A=[],B=[];b||(b=[]);var K=S-1,M=0,U=0;for(M=k;M>=0;){b[M]=!0,A[A.length]=M,B.push(_[M]);var z=T[Math.floor(M*4/S)];if(U=M*4&K,S<4+U)throw new Error("FAT boundary crossed: "+M+" 4 "+S);if(!_[z])break;M=Ai(_[z],U)}return{nodes:A,data:Np([B])}}function w(_,k,T,S){var b=_.length,A=[],B=[],K=[],M=[],U=S-1,z=0,J=0,se=0,ue=0;for(z=0;z<b;++z)if(K=[],se=z+k,se>=b&&(se-=b),!B[se]){M=[];var te=[];for(J=se;J>=0;){te[J]=!0,B[J]=!0,K[K.length]=J,M.push(_[J]);var oe=T[Math.floor(J*4/S)];if(ue=J*4&U,S<4+ue)throw new Error("FAT boundary crossed: "+J+" 4 "+S);if(!_[oe]||(J=Ai(_[oe],ue),te[J]))break}A[se]={nodes:K,data:Np([M])}}return A}function y(_,k,T,S,b,A,B,K){for(var M=0,U=S.length?2:0,z=k[_].data,J=0,se=0,ue;J<z.length;J+=128){var te=z.slice(J,J+128);dr(te,64),se=te.read_shift(2),ue=ch(te,0,se-U),S.push(ue);var oe={name:ue,type:te.read_shift(1),color:te.read_shift(1),L:te.read_shift(4,"i"),R:te.read_shift(4,"i"),C:te.read_shift(4,"i"),clsid:te.read_shift(16),state:te.read_shift(4,"i"),start:0,size:0},ye=te.read_shift(2)+te.read_shift(2)+te.read_shift(2)+te.read_shift(2);ye!==0&&(oe.ct=E(te,te.l-8));var qe=te.read_shift(2)+te.read_shift(2)+te.read_shift(2)+te.read_shift(2);qe!==0&&(oe.mt=E(te,te.l-8)),oe.start=te.read_shift(4,"i"),oe.size=te.read_shift(4,"i"),oe.size<0&&oe.start<0&&(oe.size=oe.type=0,oe.start=Q,oe.name=""),oe.type===5?(M=oe.start,b>0&&M!==Q&&(k[M].name="!StreamData")):oe.size>=4096?(oe.storage="fat",k[oe.start]===void 0&&(k[oe.start]=x(T,oe.start,k.fat_addrs,k.ssz)),k[oe.start].name=oe.name,oe.content=k[oe.start].data.slice(0,oe.size)):(oe.storage="minifat",oe.size<0?oe.size=0:M!==Q&&oe.start!==Q&&k[M]&&(oe.content=p(oe,k[M].data,(k[K]||{}).data))),oe.content&&dr(oe.content,0),A[ue]=oe,B.push(oe)}}function E(_,k){return new Date((mr(_,k+4)/1e7*Math.pow(2,32)+mr(_,k)/1e7-11644473600)*1e3)}function C(_,k){return c(),u(l.readFileSync(_),k)}function R(_,k){var T=k&&k.type;switch(T||Fe&&Buffer.isBuffer(_)&&(T="buffer"),T||"base64"){case"file":return C(_,k);case"base64":return u($r(An(_)),k);case"binary":return u($r(_),k)}return u(_,k)}function D(_,k){var T=k||{},S=T.root||"Root Entry";if(_.FullPaths||(_.FullPaths=[]),_.FileIndex||(_.FileIndex=[]),_.FullPaths.length!==_.FileIndex.length)throw new Error("inconsistent CFB structure");_.FullPaths.length===0&&(_.FullPaths[0]=S+"/",_.FileIndex[0]={name:S,type:5}),T.CLSID&&(_.FileIndex[0].clsid=T.CLSID),F(_)}function F(_){var k="Sh33tJ5";if(!He.find(_,"/"+k)){var T=V(4);T[0]=55,T[1]=T[3]=50,T[2]=54,_.FileIndex.push({name:k,type:2,content:T,size:4,L:69,R:69,C:69}),_.FullPaths.push(_.FullPaths[0]+k),N(_)}}function N(_,k){D(_);for(var T=!1,S=!1,b=_.FullPaths.length-1;b>=0;--b){var A=_.FileIndex[b];switch(A.type){case 0:S?T=!0:(_.FileIndex.pop(),_.FullPaths.pop());break;case 1:case 2:case 5:S=!0,isNaN(A.R*A.L*A.C)&&(T=!0),A.R>-1&&A.L>-1&&A.R==A.L&&(T=!0);break;default:T=!0;break}}if(!(!T&&!k)){var B=new Date(1987,1,19),K=0,M=Object.create?Object.create(null):{},U=[];for(b=0;b<_.FullPaths.length;++b)M[_.FullPaths[b]]=!0,_.FileIndex[b].type!==0&&U.push([_.FullPaths[b],_.FileIndex[b]]);for(b=0;b<U.length;++b){var z=n(U[b][0]);S=M[z],S||(U.push([z,{name:i(z).replace("/",""),type:1,clsid:Te,ct:B,mt:B,content:null}]),M[z]=!0)}for(U.sort(function(ue,te){return r(ue[0],te[0])}),_.FullPaths=[],_.FileIndex=[],b=0;b<U.length;++b)_.FullPaths[b]=U[b][0],_.FileIndex[b]=U[b][1];for(b=0;b<U.length;++b){var J=_.FileIndex[b],se=_.FullPaths[b];if(J.name=i(se).replace("/",""),J.L=J.R=J.C=-(J.color=1),J.size=J.content?J.content.length:0,J.start=0,J.clsid=J.clsid||Te,b===0)J.C=U.length>1?1:-1,J.size=0,J.type=5;else if(se.slice(-1)=="/"){for(K=b+1;K<U.length&&n(_.FullPaths[K])!=se;++K);for(J.C=K>=U.length?-1:K,K=b+1;K<U.length&&n(_.FullPaths[K])!=n(se);++K);J.R=K>=U.length?-1:K,J.type=1}else n(_.FullPaths[b+1]||"")==n(se)&&(J.R=b+1),J.type=2}}}function P(_,k){var T=k||{};if(T.fileType=="mad")return Jv(_,T);switch(N(_),T.fileType){case"zip":return Vv(_,T)}var S=function(ue){for(var te=0,oe=0,ye=0;ye<ue.FileIndex.length;++ye){var qe=ue.FileIndex[ye];if(qe.content){var Qe=qe.content.length;Qe>0&&(Qe<4096?te+=Qe+63>>6:oe+=Qe+511>>9)}}for(var Lt=ue.FullPaths.length+3>>2,oa=te+7>>3,la=te+127>>7,ca=oa+oe+Lt+la,yi=ca+127>>7,Qc=yi<=109?0:Math.ceil((yi-109)/127);ca+yi+Qc+127>>7>yi;)Qc=++yi<=109?0:Math.ceil((yi-109)/127);var un=[1,Qc,yi,la,Lt,oe,te,0];return ue.FileIndex[0].size=te<<6,un[7]=(ue.FileIndex[0].start=un[0]+un[1]+un[2]+un[3]+un[4]+un[5])+(un[6]+7>>3),un}(_),b=V(S[7]<<9),A=0,B=0;{for(A=0;A<8;++A)b.write_shift(1,ge[A]);for(A=0;A<8;++A)b.write_shift(2,0);for(b.write_shift(2,62),b.write_shift(2,3),b.write_shift(2,65534),b.write_shift(2,9),b.write_shift(2,6),A=0;A<3;++A)b.write_shift(2,0);for(b.write_shift(4,0),b.write_shift(4,S[2]),b.write_shift(4,S[0]+S[1]+S[2]+S[3]-1),b.write_shift(4,0),b.write_shift(4,4096),b.write_shift(4,S[3]?S[0]+S[1]+S[2]-1:Q),b.write_shift(4,S[3]),b.write_shift(-4,S[1]?S[0]-1:Q),b.write_shift(4,S[1]),A=0;A<109;++A)b.write_shift(-4,A<S[2]?S[1]+A:-1)}if(S[1])for(B=0;B<S[1];++B){for(;A<236+B*127;++A)b.write_shift(-4,A<S[2]?S[1]+A:-1);b.write_shift(-4,B===S[1]-1?Q:B+1)}var K=function(ue){for(B+=ue;A<B-1;++A)b.write_shift(-4,A+1);ue&&(++A,b.write_shift(-4,Q))};for(B=A=0,B+=S[1];A<B;++A)b.write_shift(-4,Ee.DIFSECT);for(B+=S[2];A<B;++A)b.write_shift(-4,Ee.FATSECT);K(S[3]),K(S[4]);for(var M=0,U=0,z=_.FileIndex[0];M<_.FileIndex.length;++M)z=_.FileIndex[M],z.content&&(U=z.content.length,!(U<4096)&&(z.start=B,K(U+511>>9)));for(K(S[6]+7>>3);b.l&511;)b.write_shift(-4,Ee.ENDOFCHAIN);for(B=A=0,M=0;M<_.FileIndex.length;++M)z=_.FileIndex[M],z.content&&(U=z.content.length,!(!U||U>=4096)&&(z.start=B,K(U+63>>6)));for(;b.l&511;)b.write_shift(-4,Ee.ENDOFCHAIN);for(A=0;A<S[4]<<2;++A){var J=_.FullPaths[A];if(!J||J.length===0){for(M=0;M<17;++M)b.write_shift(4,0);for(M=0;M<3;++M)b.write_shift(4,-1);for(M=0;M<12;++M)b.write_shift(4,0);continue}z=_.FileIndex[A],A===0&&(z.start=z.size?z.start-1:Q);var se=A===0&&T.root||z.name;if(U=2*(se.length+1),b.write_shift(64,se,"utf16le"),b.write_shift(2,U),b.write_shift(1,z.type),b.write_shift(1,z.color),b.write_shift(-4,z.L),b.write_shift(-4,z.R),b.write_shift(-4,z.C),z.clsid)b.write_shift(16,z.clsid,"hex");else for(M=0;M<4;++M)b.write_shift(4,0);b.write_shift(4,z.state||0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,0),b.write_shift(4,z.start),b.write_shift(4,z.size),b.write_shift(4,0)}for(A=1;A<_.FileIndex.length;++A)if(z=_.FileIndex[A],z.size>=4096)if(b.l=z.start+1<<9,Fe&&Buffer.isBuffer(z.content))z.content.copy(b,b.l,0,z.size),b.l+=z.size+511&-512;else{for(M=0;M<z.size;++M)b.write_shift(1,z.content[M]);for(;M&511;++M)b.write_shift(1,0)}for(A=1;A<_.FileIndex.length;++A)if(z=_.FileIndex[A],z.size>0&&z.size<4096)if(Fe&&Buffer.isBuffer(z.content))z.content.copy(b,b.l,0,z.size),b.l+=z.size+63&-64;else{for(M=0;M<z.size;++M)b.write_shift(1,z.content[M]);for(;M&63;++M)b.write_shift(1,0)}if(Fe)b.l=b.length;else for(;b.l<b.length;)b.write_shift(1,0);return b}function W(_,k){var T=_.FullPaths.map(function(M){return M.toUpperCase()}),S=T.map(function(M){var U=M.split("/");return U[U.length-(M.slice(-1)=="/"?2:1)]}),b=!1;k.charCodeAt(0)===47?(b=!0,k=T[0].slice(0,-1)+k):b=k.indexOf("/")!==-1;var A=k.toUpperCase(),B=b===!0?T.indexOf(A):S.indexOf(A);if(B!==-1)return _.FileIndex[B];var K=!A.match(ol);for(A=A.replace(Ha,""),K&&(A=A.replace(ol,"!")),B=0;B<T.length;++B)if((K?T[B].replace(ol,"!"):T[B]).replace(Ha,"")==A||(K?S[B].replace(ol,"!"):S[B]).replace(Ha,"")==A)return _.FileIndex[B];return null}var G=64,Q=-2,ve="d0cf11e0a1b11ae1",ge=[208,207,17,224,161,177,26,225],Te="00000000000000000000000000000000",Ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Q,FREESECT:-1,HEADER_SIGNATURE:ve,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Te,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function H(_,k,T){c();var S=P(_,T);l.writeFileSync(k,S)}function q(_){for(var k=new Array(_.length),T=0;T<_.length;++T)k[T]=String.fromCharCode(_[T]);return k.join("")}function ie(_,k){var T=P(_,k);switch(k&&k.type||"buffer"){case"file":return c(),l.writeFileSync(k.filename,T),T;case"binary":return typeof T=="string"?T:q(T);case"base64":return go(typeof T=="string"?T:q(T));case"buffer":if(Fe)return Buffer.isBuffer(T)?T:Pn(T);case"array":return typeof T=="string"?$r(T):T}return T}var pe;function O(_){try{var k=_.InflateRaw,T=new k;if(T._processChunk(new Uint8Array([3,0]),T._finishFlushFlag),T.bytesRead)pe=_;else throw new Error("zlib does not expose bytesRead")}catch(S){console.error("cannot use native zlib: "+(S.message||S))}}function L(_,k){if(!pe)return Sh(_,k);var T=pe.InflateRaw,S=new T,b=S._processChunk(_.slice(_.l),S._finishFlushFlag);return _.l+=S.bytesRead,b}function j(_){return pe?pe.deflateRawSync(_):sa(_)}var I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ce=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function me(_){var k=(_<<1|_<<11)&139536|(_<<5|_<<15)&558144;return(k>>16|k>>8|k)&255}for(var de=typeof Uint8Array<"u",ae=de?new Uint8Array(256):[],je=0;je<256;++je)ae[je]=me(je);function ke(_,k){var T=ae[_&255];return k<=8?T>>>8-k:(T=T<<8|ae[_>>8&255],k<=16?T>>>16-k:(T=T<<8|ae[_>>16&255],T>>>24-k))}function at(_,k){var T=k&7,S=k>>>3;return(_[S]|(T<=6?0:_[S+1]<<8))>>>T&3}function Ae(_,k){var T=k&7,S=k>>>3;return(_[S]|(T<=5?0:_[S+1]<<8))>>>T&7}function Ct(_,k){var T=k&7,S=k>>>3;return(_[S]|(T<=4?0:_[S+1]<<8))>>>T&15}function Ve(_,k){var T=k&7,S=k>>>3;return(_[S]|(T<=3?0:_[S+1]<<8))>>>T&31}function fe(_,k){var T=k&7,S=k>>>3;return(_[S]|(T<=1?0:_[S+1]<<8))>>>T&127}function Vt(_,k,T){var S=k&7,b=k>>>3,A=(1<<T)-1,B=_[b]>>>S;return T<8-S||(B|=_[b+1]<<8-S,T<16-S)||(B|=_[b+2]<<16-S,T<24-S)||(B|=_[b+3]<<24-S),B&A}function Tr(_,k,T){var S=k&7,b=k>>>3;return S<=5?_[b]|=(T&7)<<S:(_[b]|=T<<S&255,_[b+1]=(T&7)>>8-S),k+3}function on(_,k,T){var S=k&7,b=k>>>3;return T=(T&1)<<S,_[b]|=T,k+1}function Fn(_,k,T){var S=k&7,b=k>>>3;return T<<=S,_[b]|=T&255,T>>>=8,_[b+1]=T,k+8}function na(_,k,T){var S=k&7,b=k>>>3;return T<<=S,_[b]|=T&255,T>>>=8,_[b+1]=T&255,_[b+2]=T>>>8,k+16}function Zi(_,k){var T=_.length,S=2*T>k?2*T:k+5,b=0;if(T>=k)return _;if(Fe){var A=dp(S);if(_.copy)_.copy(A);else for(;b<_.length;++b)A[b]=_[b];return A}else if(de){var B=new Uint8Array(S);if(B.set)B.set(_);else for(;b<T;++b)B[b]=_[b];return B}return _.length=S,_}function Er(_){for(var k=new Array(_),T=0;T<_;++T)k[T]=0;return k}function xi(_,k,T){var S=1,b=0,A=0,B=0,K=0,M=_.length,U=de?new Uint16Array(32):Er(32);for(A=0;A<32;++A)U[A]=0;for(A=M;A<T;++A)_[A]=0;M=_.length;var z=de?new Uint16Array(M):Er(M);for(A=0;A<M;++A)U[b=_[A]]++,S<b&&(S=b),z[A]=0;for(U[0]=0,A=1;A<=S;++A)U[A+16]=K=K+U[A-1]<<1;for(A=0;A<M;++A)K=_[A],K!=0&&(z[A]=U[K+16]++);var J=0;for(A=0;A<M;++A)if(J=_[A],J!=0)for(K=ke(z[A],S)>>S-J,B=(1<<S+4-J)-1;B>=0;--B)k[K|B<<J]=J&15|A<<4;return S}var es=de?new Uint16Array(512):Er(512),ia=de?new Uint16Array(32):Er(32);if(!de){for(var ln=0;ln<512;++ln)es[ln]=0;for(ln=0;ln<32;++ln)ia[ln]=0}(function(){for(var _=[],k=0;k<32;k++)_.push(5);xi(_,ia,32);var T=[];for(k=0;k<=143;k++)T.push(8);for(;k<=255;k++)T.push(9);for(;k<=279;k++)T.push(7);for(;k<=287;k++)T.push(8);xi(T,es,288)})();var Yc=function(){for(var k=de?new Uint8Array(32768):[],T=0,S=0;T<ce.length-1;++T)for(;S<ce[T+1];++S)k[S]=T;for(;S<32768;++S)k[S]=29;var b=de?new Uint8Array(259):[];for(T=0,S=0;T<X.length-1;++T)for(;S<X[T+1];++S)b[S]=T;function A(K,M){for(var U=0;U<K.length;){var z=Math.min(65535,K.length-U),J=U+z==K.length;for(M.write_shift(1,+J),M.write_shift(2,z),M.write_shift(2,~z&65535);z-- >0;)M[M.l++]=K[U++]}return M.l}function B(K,M){for(var U=0,z=0,J=de?new Uint16Array(32768):[];z<K.length;){var se=Math.min(65535,K.length-z);if(se<10){for(U=Tr(M,U,+(z+se==K.length)),U&7&&(U+=8-(U&7)),M.l=U/8|0,M.write_shift(2,se),M.write_shift(2,~se&65535);se-- >0;)M[M.l++]=K[z++];U=M.l*8;continue}U=Tr(M,U,+(z+se==K.length)+2);for(var ue=0;se-- >0;){var te=K[z];ue=(ue<<5^te)&32767;var oe=-1,ye=0;if((oe=J[ue])&&(oe|=z&-32768,oe>z&&(oe-=32768),oe<z))for(;K[oe+ye]==K[z+ye]&&ye<250;)++ye;if(ye>2){te=b[ye],te<=22?U=Fn(M,U,ae[te+1]>>1)-1:(Fn(M,U,3),U+=5,Fn(M,U,ae[te-23]>>5),U+=3);var qe=te<8?0:te-4>>2;qe>0&&(na(M,U,ye-X[te]),U+=qe),te=k[z-oe],U=Fn(M,U,ae[te]>>3),U-=3;var Qe=te<4?0:te-2>>1;Qe>0&&(na(M,U,z-oe-ce[te]),U+=Qe);for(var Lt=0;Lt<ye;++Lt)J[ue]=z&32767,ue=(ue<<5^K[z])&32767,++z;se-=ye-1}else te<=143?te=te+48:U=on(M,U,1),U=Fn(M,U,ae[te]),J[ue]=z&32767,++z}U=Fn(M,U,0)-1}return M.l=(U+7)/8|0,M.l}return function(M,U){return M.length<8?A(M,U):B(M,U)}}();function sa(_){var k=V(50+Math.floor(_.length*1.1)),T=Yc(_,k);return k.slice(0,T)}var xe=de?new Uint16Array(32768):Er(32768),Ne=de?new Uint16Array(32768):Er(32768),cn=de?new Uint16Array(128):Er(128),vi=1,aa=1;function Hv(_,k){var T=Ve(_,k)+257;k+=5;var S=Ve(_,k)+1;k+=5;var b=Ct(_,k)+4;k+=4;for(var A=0,B=de?new Uint8Array(19):Er(19),K=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],M=1,U=de?new Uint8Array(8):Er(8),z=de?new Uint8Array(8):Er(8),J=B.length,se=0;se<b;++se)B[I[se]]=A=Ae(_,k),M<A&&(M=A),U[A]++,k+=3;var ue=0;for(U[0]=0,se=1;se<=M;++se)z[se]=ue=ue+U[se-1]<<1;for(se=0;se<J;++se)(ue=B[se])!=0&&(K[se]=z[ue]++);var te=0;for(se=0;se<J;++se)if(te=B[se],te!=0){ue=ae[K[se]]>>8-te;for(var oe=(1<<7-te)-1;oe>=0;--oe)cn[ue|oe<<te]=te&7|se<<3}var ye=[];for(M=1;ye.length<T+S;)switch(ue=cn[fe(_,k)],k+=ue&7,ue>>>=3){case 16:for(A=3+at(_,k),k+=2,ue=ye[ye.length-1];A-- >0;)ye.push(ue);break;case 17:for(A=3+Ae(_,k),k+=3;A-- >0;)ye.push(0);break;case 18:for(A=11+fe(_,k),k+=7;A-- >0;)ye.push(0);break;default:ye.push(ue),M<ue&&(M=ue);break}var qe=ye.slice(0,T),Qe=ye.slice(T);for(se=T;se<286;++se)qe[se]=0;for(se=S;se<30;++se)Qe[se]=0;return vi=xi(qe,xe,286),aa=xi(Qe,Ne,30),k}function zv(_,k){if(_[0]==3&&!(_[1]&3))return[Hi(k),2];for(var T=0,S=0,b=dp(k||1<<18),A=0,B=b.length>>>0,K=0,M=0;!(S&1);){if(S=Ae(_,T),T+=3,S>>>1)S>>1==1?(K=9,M=5):(T=Hv(_,T),K=vi,M=aa);else{T&7&&(T+=8-(T&7));var U=_[T>>>3]|_[(T>>>3)+1]<<8;if(T+=32,U>0)for(!k&&B<A+U&&(b=Zi(b,A+U),B=b.length);U-- >0;)b[A++]=_[T>>>3],T+=8;continue}for(;;){!k&&B<A+32767&&(b=Zi(b,A+32767),B=b.length);var z=Vt(_,T,K),J=S>>>1==1?es[z]:xe[z];if(T+=J&15,J>>>=4,!(J>>>8&255))b[A++]=J;else{if(J==256)break;J-=257;var se=J<8?0:J-4>>2;se>5&&(se=0);var ue=A+X[J];se>0&&(ue+=Vt(_,T,se),T+=se),z=Vt(_,T,M),J=S>>>1==1?ia[z]:Ne[z],T+=J&15,J>>>=4;var te=J<4?0:J-2>>1,oe=ce[J];for(te>0&&(oe+=Vt(_,T,te),T+=te),!k&&B<ue&&(b=Zi(b,ue+100),B=b.length);A<ue;)b[A]=b[A-oe],++A}}}return k?[b,T+7>>>3]:[b.slice(0,A),T+7>>>3]}function Sh(_,k){var T=_.slice(_.l||0),S=zv(T,k);return _.l+=S[1],S[0]}function kh(_,k){if(_)typeof console<"u"&&console.error(k);else throw new Error(k)}function Ch(_,k){var T=_;dr(T,0);var S=[],b=[],A={FileIndex:S,FullPaths:b};D(A,{root:k.root});for(var B=T.length-4;(T[B]!=80||T[B+1]!=75||T[B+2]!=5||T[B+3]!=6)&&B>=0;)--B;T.l=B+4,T.l+=4;var K=T.read_shift(2);T.l+=6;var M=T.read_shift(4);for(T.l=M,B=0;B<K;++B){T.l+=20;var U=T.read_shift(4),z=T.read_shift(4),J=T.read_shift(2),se=T.read_shift(2),ue=T.read_shift(2);T.l+=8;var te=T.read_shift(4),oe=o(T.slice(T.l+J,T.l+J+se));T.l+=J+se+ue;var ye=T.l;T.l=te+4,Wv(T,U,z,A,oe),T.l=ye}return A}function Wv(_,k,T,S,b){_.l+=2;var A=_.read_shift(2),B=_.read_shift(2),K=a(_);if(A&8257)throw new Error("Unsupported ZIP encryption");for(var M=_.read_shift(4),U=_.read_shift(4),z=_.read_shift(4),J=_.read_shift(2),se=_.read_shift(2),ue="",te=0;te<J;++te)ue+=String.fromCharCode(_[_.l++]);if(se){var oe=o(_.slice(_.l,_.l+se));(oe[21589]||{}).mt&&(K=oe[21589].mt),((b||{})[21589]||{}).mt&&(K=b[21589].mt)}_.l+=se;var ye=_.slice(_.l,_.l+U);switch(B){case 8:ye=L(_,z);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+B)}var qe=!1;A&8&&(M=_.read_shift(4),M==134695760&&(M=_.read_shift(4),qe=!0),U=_.read_shift(4),z=_.read_shift(4)),U!=k&&kh(qe,"Bad compressed size: "+k+" != "+U),z!=T&&kh(qe,"Bad uncompressed size: "+T+" != "+z),qc(S,ue,ye,{unsafe:!0,mt:K})}function Vv(_,k){var T=k||{},S=[],b=[],A=V(1),B=T.compression?8:0,K=0,M=0,U=0,z=0,J=0,se=_.FullPaths[0],ue=se,te=_.FileIndex[0],oe=[],ye=0;for(M=1;M<_.FullPaths.length;++M)if(ue=_.FullPaths[M].slice(se.length),te=_.FileIndex[M],!(!te.size||!te.content||ue=="Sh33tJ5")){var qe=z,Qe=V(ue.length);for(U=0;U<ue.length;++U)Qe.write_shift(1,ue.charCodeAt(U)&127);Qe=Qe.slice(0,Qe.l),oe[J]=A4.buf(te.content,0);var Lt=te.content;B==8&&(Lt=j(Lt)),A=V(30),A.write_shift(4,67324752),A.write_shift(2,20),A.write_shift(2,K),A.write_shift(2,B),te.mt?s(A,te.mt):A.write_shift(4,0),A.write_shift(-4,oe[J]),A.write_shift(4,Lt.length),A.write_shift(4,te.content.length),A.write_shift(2,Qe.length),A.write_shift(2,0),z+=A.length,S.push(A),z+=Qe.length,S.push(Qe),z+=Lt.length,S.push(Lt),A=V(46),A.write_shift(4,33639248),A.write_shift(2,0),A.write_shift(2,20),A.write_shift(2,K),A.write_shift(2,B),A.write_shift(4,0),A.write_shift(-4,oe[J]),A.write_shift(4,Lt.length),A.write_shift(4,te.content.length),A.write_shift(2,Qe.length),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(4,0),A.write_shift(4,qe),ye+=A.l,b.push(A),ye+=Qe.length,b.push(Qe),++J}return A=V(22),A.write_shift(4,101010256),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,J),A.write_shift(2,J),A.write_shift(4,ye),A.write_shift(4,z),A.write_shift(2,0),Ot([Ot(S),Ot(b),A])}var Lo={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Gv(_,k){if(_.ctype)return _.ctype;var T=_.name||"",S=T.match(/\.([^\.]+)$/);return S&&Lo[S[1]]||k&&(S=(T=k).match(/[\.\\]([^\.\\])+$/),S&&Lo[S[1]])?Lo[S[1]]:"application/octet-stream"}function Kv(_){for(var k=go(_),T=[],S=0;S<k.length;S+=76)T.push(k.slice(S,S+76));return T.join(`\r
`)+`\r
`}function Xv(_){var k=_.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(U){var z=U.charCodeAt(0).toString(16).toUpperCase();return"="+(z.length==1?"0"+z:z)});k=k.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),k.charAt(0)==`
`&&(k="=0D"+k.slice(1)),k=k.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var T=[],S=k.split(`\r
`),b=0;b<S.length;++b){var A=S[b];if(A.length==0){T.push("");continue}for(var B=0;B<A.length;){var K=76,M=A.slice(B,B+K);M.charAt(K-1)=="="?K--:M.charAt(K-2)=="="?K-=2:M.charAt(K-3)=="="&&(K-=3),M=A.slice(B,B+K),B+=K,B<A.length&&(M+="="),T.push(M)}}return T.join(`\r
`)}function Yv(_){for(var k=[],T=0;T<_.length;++T){for(var S=_[T];T<=_.length&&S.charAt(S.length-1)=="=";)S=S.slice(0,S.length-1)+_[++T];k.push(S)}for(var b=0;b<k.length;++b)k[b]=k[b].replace(/[=][0-9A-Fa-f]{2}/g,function(A){return String.fromCharCode(parseInt(A.slice(1),16))});return $r(k.join(`\r
`))}function qv(_,k,T){for(var S="",b="",A="",B,K=0;K<10;++K){var M=k[K];if(!M||M.match(/^\s*$/))break;var U=M.match(/^(.*?):\s*([^\s].*)$/);if(U)switch(U[1].toLowerCase()){case"content-location":S=U[2].trim();break;case"content-type":A=U[2].trim();break;case"content-transfer-encoding":b=U[2].trim();break}}switch(++K,b.toLowerCase()){case"base64":B=$r(An(k.slice(K).join("")));break;case"quoted-printable":B=Yv(k.slice(K));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+b)}var z=qc(_,S.slice(T.length),B,{unsafe:!0});A&&(z.ctype=A)}function Qv(_,k){if(q(_.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var T=k&&k.root||"",S=(Fe&&Buffer.isBuffer(_)?_.toString("binary"):q(_)).split(`\r
`),b=0,A="";for(b=0;b<S.length;++b)if(A=S[b],!!/^Content-Location:/i.test(A)&&(A=A.slice(A.indexOf("file")),T||(T=A.slice(0,A.lastIndexOf("/")+1)),A.slice(0,T.length)!=T))for(;T.length>0&&(T=T.slice(0,T.length-1),T=T.slice(0,T.lastIndexOf("/")+1),A.slice(0,T.length)!=T););var B=(S[1]||"").match(/boundary="(.*?)"/);if(!B)throw new Error("MAD cannot find boundary");var K="--"+(B[1]||""),M=[],U=[],z={FileIndex:M,FullPaths:U};D(z);var J,se=0;for(b=0;b<S.length;++b){var ue=S[b];ue!==K&&ue!==K+"--"||(se++&&qv(z,S.slice(J,b),T),J=b)}return z}function Jv(_,k){var T=k||{},S=T.boundary||"SheetJS";S="------="+S;for(var b=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+S.slice(2)+'"',"","",""],A=_.FullPaths[0],B=A,K=_.FileIndex[0],M=1;M<_.FullPaths.length;++M)if(B=_.FullPaths[M].slice(A.length),K=_.FileIndex[M],!(!K.size||!K.content||B=="Sh33tJ5")){B=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ye){return"_x"+ye.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ye){return"_u"+ye.charCodeAt(0).toString(16)+"_"});for(var U=K.content,z=Fe&&Buffer.isBuffer(U)?U.toString("binary"):q(U),J=0,se=Math.min(1024,z.length),ue=0,te=0;te<=se;++te)(ue=z.charCodeAt(te))>=32&&ue<128&&++J;var oe=J>=se*4/5;b.push(S),b.push("Content-Location: "+(T.root||"file:///C:/SheetJS/")+B),b.push("Content-Transfer-Encoding: "+(oe?"quoted-printable":"base64")),b.push("Content-Type: "+Gv(K,B)),b.push(""),b.push(oe?Xv(z):Kv(z))}return b.push(S+`--\r
`),b.join(`\r
`)}function Zv(_){var k={};return D(k,_),k}function qc(_,k,T,S){var b=S&&S.unsafe;b||D(_);var A=!b&&He.find(_,k);if(!A){var B=_.FullPaths[0];k.slice(0,B.length)==B?B=k:(B.slice(-1)!="/"&&(B+="/"),B=(B+k).replace("//","/")),A={name:i(k),type:2},_.FileIndex.push(A),_.FullPaths.push(B),b||He.utils.cfb_gc(_)}return A.content=T,A.size=T?T.length:0,S&&(S.CLSID&&(A.clsid=S.CLSID),S.mt&&(A.mt=S.mt),S.ct&&(A.ct=S.ct)),A}function ey(_,k){D(_);var T=He.find(_,k);if(T){for(var S=0;S<_.FileIndex.length;++S)if(_.FileIndex[S]==T)return _.FileIndex.splice(S,1),_.FullPaths.splice(S,1),!0}return!1}function ty(_,k,T){D(_);var S=He.find(_,k);if(S){for(var b=0;b<_.FileIndex.length;++b)if(_.FileIndex[b]==S)return _.FileIndex[b].name=i(T),_.FullPaths[b]=T,!0}return!1}function ry(_){N(_,!0)}return t.find=W,t.read=R,t.parse=u,t.write=ie,t.writeFile=H,t.utils={cfb_new:Zv,cfb_add:qc,cfb_del:ey,cfb_mov:ty,cfb_gc:ry,ReadShift:Wa,CheckField:Bx,prep_blob:dr,bconcat:Ot,use_zlib:O,_deflateRaw:sa,_inflateRaw:Sh,consts:Ee},t}();function D4(e){return typeof e=="string"?$c(e):Array.isArray(e)?r4(e):e}function Po(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=$c(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?vo(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([D4(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=e,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Oo(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function It(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function _p(e,t){for(var r=[],n=It(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function sh(e){for(var t=[],r=It(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Wc(e){for(var t=[],r=It(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function O4(e){for(var t=[],r=It(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var lc=new Date(1899,11,30,0,0,0);function cr(e,t){var r=e.getTime(),n=lc.getTime()+(e.getTimezoneOffset()-lc.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Tx=new Date,P4=lc.getTime()+(Tx.getTimezoneOffset()-lc.getTimezoneOffset())*6e4,Tp=Tx.getTimezoneOffset();function Ex(e){var t=new Date;return t.setTime(e*24*60*60*1e3+P4),t.getTimezoneOffset()!==Tp&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Tp)*6e4),t}var Ep=new Date("2017-02-19T19:06:09.000Z"),Sx=isNaN(Ep.getFullYear())?new Date("2/19/17"):Ep,F4=Sx.getFullYear()==2017;function Qt(e,t){var r=new Date(e);if(F4)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Sx.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Vc(e,t){if(Fe&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function ur(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ur(e[r]));return t}function nt(e,t){for(var r="";r.length<t;)r+=e;return r}function Tn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var R4=["january","february","march","april","may","june","july","august","september","october","november","december"];function xo(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&R4.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function _e(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Fe?n=Pn(r):n=n4(r),He.utils.cfb_add(e,t,n)}He.utils.cfb_add(e,t,r)}else e.file(t,r)}function ah(){return He.utils.cfb_new()}var mt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,j4={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},oh=sh(j4),lh=/[&<>'"]/g,I4=/[\u0000-\u0008\u000b-\u001f]/g;function Be(e){var t=e+"";return t.replace(lh,function(r){return oh[r]}).replace(I4,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Sp(e){return Be(e).replace(/ /g,"_x0020_")}var kx=/[\u0000-\u001f]/g;function L4(e){var t=e+"";return t.replace(lh,function(r){return oh[r]}).replace(/\n/g,"<br/>").replace(kx,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function M4(e){var t=e+"";return t.replace(lh,function(r){return oh[r]}).replace(kx,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function B4(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function U4(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Fu(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function kp(e){var t=Hi(2*e.length),r,n,i=1,s=0,a=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function Cp(e){return Pn(e,"binary").toString("utf8")}var cl="foo bar bazâð£",za=Fe&&(Cp(cl)==Fu(cl)&&Cp||kp(cl)==Fu(cl)&&kp)||Fu,vo=Fe?function(e){return Pn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},$4=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),Cx=/(^\s|\s$|\n)/;function Pt(e,t){return"<"+e+(t.match(Cx)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function yo(e){return It(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function re(e,t,r){return"<"+e+(r!=null?yo(r):"")+(t!=null?(t.match(Cx)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function K0(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function H4(e,t){switch(typeof e){case"string":var r=re("vt:lpwstr",Be(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return re((e|0)==e?"vt:i4":"vt:r8",Be(String(e)));case"boolean":return re("vt:bool",e?"true":"false")}if(e instanceof Date)return re("vt:filetime",K0(e));throw new Error("Unable to serialize "+e)}var _t={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Zs=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],pr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function z4(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function W4(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,a=n?-t:t;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var bp=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},Np=Fe?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Pn(t)})):bp(e)}:bp,Ap=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(ba(e,i)));return n.join("").replace(Ha,"")},ch=Fe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ha,""):Ap(e,t,r)}:Ap,Dp=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},bx=Fe?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Dp(e,t,r)}:Dp,Op=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(fs(e,i)));return n.join("")},Fo=Fe?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Op(t,r,n)}:Op,Nx=function(e,t){var r=mr(e,t);return r>0?Fo(e,t+4,t+4+r-1):""},Ax=Nx,Dx=function(e,t){var r=mr(e,t);return r>0?Fo(e,t+4,t+4+r-1):""},Ox=Dx,Px=function(e,t){var r=2*mr(e,t);return r>0?Fo(e,t+4,t+4+r-1):""},Fx=Px,Rx=function(t,r){var n=mr(t,r);return n>0?ch(t,r+4,r+4+n):""},jx=Rx,Ix=function(e,t){var r=mr(e,t);return r>0?Fo(e,t+4,t+4+r):""},Lx=Ix,Mx=function(e,t){return z4(e,t)},cc=Mx,uh=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Fe&&(Ax=function(t,r){if(!Buffer.isBuffer(t))return Nx(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Ox=function(t,r){if(!Buffer.isBuffer(t))return Dx(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Fx=function(t,r){if(!Buffer.isBuffer(t))return Px(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},jx=function(t,r){if(!Buffer.isBuffer(t))return Rx(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Lx=function(t,r){if(!Buffer.isBuffer(t))return Ix(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},cc=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Mx(t,r)},uh=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var fs=function(e,t){return e[t]},ba=function(e,t){return e[t+1]*256+e[t]},V4=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},mr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ai=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},G4=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Wa(e,t){var r="",n,i,s=[],a,o,l,c;switch(t){case"dbcs":if(c=this.l,Fe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(ba(this,c)),c+=2;e*=2;break;case"utf8":r=Fo(this,this.l,this.l+e);break;case"utf16le":e*=2,r=ch(this,this.l,this.l+e);break;case"wstr":return Wa.call(this,e,"dbcs");case"lpstr-ansi":r=Ax(this,this.l),e=4+mr(this,this.l);break;case"lpstr-cp":r=Ox(this,this.l),e=4+mr(this,this.l);break;case"lpwstr":r=Fx(this,this.l),e=4+2*mr(this,this.l);break;case"lpp4":e=4+mr(this,this.l),r=jx(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+mr(this,this.l),r=Lx(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=fs(this,this.l+e++))!==0;)s.push(al(a));r=s.join("");break;case"_wstr":for(e=0,r="";(a=ba(this,this.l+e))!==0;)s.push(al(a)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=fs(this,c),this.l=c+1,o=Wa.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(al(ba(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=fs(this,c),this.l=c+1,o=Wa.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(al(fs(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=fs(this,this.l),this.l++,n;case 2:return n=(t==="i"?V4:ba)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Ai:G4)(this,this.l),this.l+=4,n):(i=mr(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=cc(this,this.l):i=cc([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=bx(this,this.l,e);break}}return this.l+=e,r}var K4=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},X4=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Y4=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function q4(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)Y4(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,K4(this,t,this.l);break;case 8:if(n=8,r==="f"){W4(this,t,this.l);break}case 16:break;case-4:n=4,X4(this,t,this.l);break}return this.l+=n,this}function Bx(e,t){var r=bx(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function dr(e,t){e.l=t,e.read_shift=Wa,e.chk=Bx,e.write_shift=q4}function an(e,t){e.l+=t}function V(e){var t=Hi(e);return dr(t,0),t}function lr(){var e=[],t=Fe?256:2048,r=function(c){var u=V(c);return dr(u,0),u},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,t)))},a=function(){return i(),Ot(e)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:a,_bufs:e}}function Y(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=z6[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=e.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&uh(r)&&e.push(r)}}function Va(e,t,r){var n=ur(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Pp(e,t,r){var n=ur(e);return n.s=Va(n.s,t.s,r),n.e=Va(n.e,t.s,r),n}function Ga(e,t){if(e.cRel&&e.c<0)for(e=ur(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ur(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=$e(e);return!e.cRel&&e.cRel!=null&&(r=Z4(r)),!e.rRel&&e.rRel!=null&&(r=Q4(r)),r}function Ru(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ht(e.s.c)+":"+(e.e.cRel?"":"$")+Ht(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Rt(e.s.r)+":"+(e.e.rRel?"":"$")+Rt(e.e.r):Ga(e.s,t.biff)+":"+Ga(e.e,t.biff)}function fh(e){return parseInt(J4(e),10)-1}function Rt(e){return""+(e+1)}function Q4(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function J4(e){return e.replace(/\$(\d+)$/,"$1")}function hh(e){for(var t=e3(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Ht(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Z4(e){return e.replace(/^([A-Z])/,"$$$1")}function e3(e){return e.replace(/^\$([A-Z])/,"$1")}function t3(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Tt(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function $e(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function yr(e){var t=e.indexOf(":");return t==-1?{s:Tt(e),e:Tt(e)}:{s:Tt(e.slice(0,t)),e:Tt(e.slice(t+1))}}function dt(e,t){return typeof t>"u"||typeof t=="number"?dt(e.s,e.e):(typeof e!="string"&&(e=$e(e)),typeof t!="string"&&(t=$e(t)),e==t?e:e+":"+t)}function Xe(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function Fp(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ci(e.z,r?cr(t):t)}catch{}try{return e.w=ci((e.XF||{}).numFmtId||(r?14:0),r?cr(t):t)}catch{return""+t}}function Dn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ro[e.v]||e.v:t==null?Fp(e,e.v):Fp(e,t))}function Xi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Ux(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Tt(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=Xe(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),a==-1&&(c.e.r=a=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[h].length;++d)if(!(typeof t[h][d]>"u")){var m={v:t[h][d]},g=a+h,p=o+d;if(c.s.r>g&&(c.s.r=g),c.s.c>p&&(c.s.c=p),c.e.r<g&&(c.e.r=g),c.e.c<p&&(c.e.c=p),t[h][d]&&typeof t[h][d]=="object"&&!Array.isArray(t[h][d])&&!(t[h][d]instanceof Date))m=t[h][d];else if(Array.isArray(m.v)&&(m.f=t[h][d][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||it[14],n.cellDates?(m.t="d",m.w=ci(m.z,cr(m.v))):(m.t="n",m.v=cr(m.v),m.w=ci(m.z,m.v))):m.t="s";if(i)s[g]||(s[g]=[]),s[g][p]&&s[g][p].z&&(m.z=s[g][p].z),s[g][p]=m;else{var v=$e({c:p,r:g});s[v]&&s[v].z&&(m.z=s[v].z),s[v]=m}}}return c.s.c<1e7&&(s["!ref"]=dt(c)),s}function ea(e,t){return Ux(null,e,t)}function r3(e){return e.read_shift(4,"i")}function Vr(e,t){return t||(t=V(4)),t.write_shift(4,e),t}function zt(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Et(e,t){var r=!1;return t==null&&(r=!0,t=V(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function n3(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function i3(e,t){return t||(t=V(4)),t.write_shift(2,0),t.write_shift(2,0),t}function dh(e,t){var r=e.l,n=e.read_shift(1),i=zt(e),s=[],a={t:i,h:i};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(n3(e));a.r=s}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}function s3(e,t){var r=!1;return t==null&&(r=!0,t=V(15+4*e.t.length)),t.write_shift(1,0),Et(e.t,t),r?t.slice(0,t.l):t}var a3=dh;function o3(e,t){var r=!1;return t==null&&(r=!0,t=V(23+4*e.t.length)),t.write_shift(1,1),Et(e.t,t),t.write_shift(4,1),i3({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function Pr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Yi(e,t){return t==null&&(t=V(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function qi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Qi(e,t){return t==null&&(t=V(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var l3=zt,$x=Et;function ph(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function uc(e,t){var r=!1;return t==null&&(r=!0,t=V(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var c3=zt,X0=ph,mh=uc;function Hx(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?cc([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ai(t,0)>>2;return r?i/100:i}function zx(e,t){t==null&&(t=V(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Wx(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function u3(e,t){return t||(t=V(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Ji=Wx,ta=u3;function ra(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function zi(e,t){return(t||V(8)).write_shift(8,e,"f")}function f3(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var c=w3[i];c&&(t.rgb=Wp(c));break;case 2:t.rgb=Wp([a,o,l]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function fc(e,t){if(t||(t=V(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function h3(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function d3(e,t){t||(t=V(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var Vx=2,fr=3,ul=11,hc=19,fl=64,p3=65,m3=71,g3=4108,x3=4126,At=80,Rp={1:{n:"CodePage",t:Vx},2:{n:"Category",t:At},3:{n:"PresentationFormat",t:At},4:{n:"ByteCount",t:fr},5:{n:"LineCount",t:fr},6:{n:"ParagraphCount",t:fr},7:{n:"SlideCount",t:fr},8:{n:"NoteCount",t:fr},9:{n:"HiddenCount",t:fr},10:{n:"MultimediaClipCount",t:fr},11:{n:"ScaleCrop",t:ul},12:{n:"HeadingPairs",t:g3},13:{n:"TitlesOfParts",t:x3},14:{n:"Manager",t:At},15:{n:"Company",t:At},16:{n:"LinksUpToDate",t:ul},17:{n:"CharacterCount",t:fr},19:{n:"SharedDoc",t:ul},22:{n:"HyperlinksChanged",t:ul},23:{n:"AppVersion",t:fr,p:"version"},24:{n:"DigSig",t:p3},26:{n:"ContentType",t:At},27:{n:"ContentStatus",t:At},28:{n:"Language",t:At},29:{n:"Version",t:At},255:{},2147483648:{n:"Locale",t:hc},2147483651:{n:"Behavior",t:hc},1919054434:{}},jp={1:{n:"CodePage",t:Vx},2:{n:"Title",t:At},3:{n:"Subject",t:At},4:{n:"Author",t:At},5:{n:"Keywords",t:At},6:{n:"Comments",t:At},7:{n:"Template",t:At},8:{n:"LastAuthor",t:At},9:{n:"RevNumber",t:At},10:{n:"EditTime",t:fl},11:{n:"LastPrinted",t:fl},12:{n:"CreatedDate",t:fl},13:{n:"ModifiedDate",t:fl},14:{n:"PageCount",t:fr},15:{n:"WordCount",t:fr},16:{n:"CharCount",t:fr},17:{n:"Thumbnail",t:m3},18:{n:"Application",t:At},19:{n:"DocSecurity",t:fr},255:{},2147483648:{n:"Locale",t:hc},2147483651:{n:"Behavior",t:hc},1919054434:{}};function v3(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var y3=v3([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),w3=ur(y3),Ro={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},_3={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},hl={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Gx(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Kx(e,t){var r=O4(_3),n=[],i;n[n.length]=mt,n[n.length]=re("Types",null,{xmlns:_t.CT,"xmlns:xsd":_t.xsd,"xmlns:xsi":_t.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return re("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(i=e[l][0],n[n.length]=re("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:hl[l][t.bookType]||hl[l].xlsx}))},a=function(l){(e[l]||[]).forEach(function(c){n[n.length]=re("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:hl[l][t.bookType]||hl[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=re("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Pe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Xx(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Fs(e){var t=[mt,re("Relationships",null,{xmlns:_t.RELS})];return It(e["!id"]).forEach(function(r){t[t.length]=re("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Me(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[Pe.HLINK,Pe.XPATH,Pe.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function T3(e){var t=[mt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Ip(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function E3(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function S3(e){var t=[mt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Ip(e[r][0],e[r][1])),t.push(E3("",e[r][0]));return t.push(Ip("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Yx(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ic.version+"</meta:generator></office:meta></office:document-meta>"}var Ii=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function ju(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Be(t),n[n.length]=r?re(e,t,r):Pt(e,t))}function qx(e,t){var r=t||{},n=[mt,re("cp:coreProperties",null,{"xmlns:cp":_t.CORE_PROPS,"xmlns:dc":_t.dc,"xmlns:dcterms":_t.dcterms,"xmlns:dcmitype":_t.dcmitype,"xmlns:xsi":_t.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&ju("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:K0(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&ju("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:K0(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Ii.length;++s){var a=Ii[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e?e[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&ju(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Rs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Qx=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Jx(e){var t=[],r=re;return e||(e={}),e.Application="SheetJS",t[t.length]=mt,t[t.length]=re("Properties",null,{xmlns:_t.EXT_PROPS,"xmlns:vt":_t.vt}),Rs.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Be(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Be(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Zx(e){var t=[mt,re("Properties",null,{xmlns:_t.CUST_PROPS,"xmlns:vt":_t.vt})];if(!e)return t.join("");var r=1;return It(e).forEach(function(i){++r,t[t.length]=re("property",H4(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Be(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Lp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function k3(e,t){var r=[];return It(Lp).map(function(n){for(var i=0;i<Ii.length;++i)if(Ii[i][1]==n)return Ii[i];for(i=0;i<Rs.length;++i)if(Rs[i][1]==n)return Rs[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Pt(Lp[n[1]]||n[1],i))}}),re("DocumentProperties",r.join(""),{xmlns:pr.o})}function C3(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&It(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var a=0;a<Ii.length;++a)if(s==Ii[a][1])return;for(a=0;a<Rs.length;++a)if(s==Rs[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(re(Sp(s),o,{"dt:dt":l}))}}),t&&It(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var a=t[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(re(Sp(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+pr.o+'">'+i.join("")+"</"+n+">"}function b3(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=V(8);return a.write_shift(4,n),a.write_shift(4,i),a}function Mp(e,t){var r=V(4),n=V(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=V(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=b3(t);break;case 31:case 80:for(n=V(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Ot([r,n])}var ev=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function N3(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Bp(e,t,r){var n=V(8),i=[],s=[],a=8,o=0,l=V(8),c=V(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!t){c=V(8),c.write_shift(4,0),i.unshift(c);var u=[V(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for(l=V(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Ot(u),s.unshift(l),a+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(ev.indexOf(e[o][0])>-1||Qx.indexOf(e[o][0])>-1)&&e[o][1]!=null){var d=e[o][1],m=0;if(t){m=+t[e[o][0]];var g=r[m];if(g.p=="version"&&typeof d=="string"){var p=d.split(".");d=(+p[0]<<16)+(+p[1]||0)}l=Mp(g.t,d)}else{var v=N3(d);v==-1&&(v=31,d=String(d)),l=Mp(v,d)}s.push(l),c=V(8),c.write_shift(4,t?m:2+o),i.push(c),a+=8+l.length}var x=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,x),x+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),Ot([n].concat(i).concat(s))}function Up(e,t,r,n,i,s){var a=V(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,He.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,i?68:48);var l=Bp(e,r,n);if(o.push(l),i){var c=Bp(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return Ot(o)}function A3(e,t){t||(t=V(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function D3(e,t){return e.read_shift(t)===1}function Xt(e,t){return t||(t=V(2)),t.write_shift(2,+!!e),t}function tv(e){return e.read_shift(2,"u")}function kr(e,t){return t||(t=V(2)),t.write_shift(2,e),t}function rv(e,t,r){return r||(r=V(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function nv(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?e.read_shift(n,i):"";return a}function O3(e){var t=e.t||"",r=V(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=V(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return Ot(i)}function P3(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function F3(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):P3(e,n,r)}function R3(e,t,r){if(r.biff>5)return F3(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function iv(e,t,r){return r||(r=V(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function $p(e,t){t||(t=V(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function j3(e){var t=V(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)t.write_shift(4,a[r]);if(s==28)n=n.slice(1),$p(n,t);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&$p(i>-1?n.slice(i+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Wi(e,t,r,n){return n||(n=V(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function I3(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[i,s,a]}function L3(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function sv(e,t){return t||(t=V(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function gh(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=V(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function M3(e,t){var r=!t||t.biff==8,n=V(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function B3(e,t){var r=!t||t.biff>=8?2:1,n=V(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function U3(e,t){var r=V(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=O3(e[i]);var s=Ot([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function $3(){var e=V(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function H3(e){var t=V(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function z3(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=V(i);return s.write_shift(2,(e.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function W3(e,t,r,n){var i=V(10);return Wi(e,t,n,i),i.write_shift(4,r),i}function V3(e,t,r,n,i){var s=!i||i.biff==8,a=V(8+ +s+(1+s)*r.length);return Wi(e,t,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function G3(e,t,r,n){var i=r&&r.biff==5;n||(n=V(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function K3(e,t){var r=t.biff==8||!t.biff?4:2,n=V(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Hp(e,t,r,n){var i=r&&r.biff==5;n||(n=V(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function X3(e){var t=V(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Y3(e,t,r,n,i,s){var a=V(8);return Wi(e,t,n,a),rv(r,s,a),a}function q3(e,t,r,n){var i=V(14);return Wi(e,t,n,i),zi(r,i),i}function Q3(e,t,r){if(r.biff<8)return J3(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(I3(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function J3(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=nv(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Z3(e){var t=V(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)sv(e[r],t);return t}function eC(e){var t=V(24),r=Tt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return Ot([t,j3(e[1])])}function tC(e){var t=e[1].Tooltip,r=V(10+2*(t.length+1));r.write_shift(2,2048);var n=Tt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function rC(e){return e||(e=V(4)),e.write_shift(2,1),e.write_shift(2,1),e}function nC(e,t,r){if(!r.cellStyles)return an(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function iC(e,t){var r=V(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function sC(e){for(var t=V(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function aC(e,t,r){var n=V(15);return Io(n,e,t),n.write_shift(8,r,"f"),n}function oC(e,t,r){var n=V(9);return Io(n,e,t),n.write_shift(2,r),n}var lC=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=sh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=Hi(1);switch(l.type){case"base64":u=$r(An(o));break;case"binary":u=$r(o);break;case"buffer":case"array":u=o;break}dr(u,0);var h=u.read_shift(1),d=!!(h&136),m=!1,g=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,d=!0;break;case 49:m=!0,d=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var p=0,v=521;h==2&&(p=u.read_shift(2)),u.l+=3,h!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),h!=2&&(v=u.read_shift(2));var x=u.read_shift(2),w=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(w=e[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var y=[],E={},C=Math.min(u.length,h==2?521:v-10-(m?264:0)),R=g?32:11;u.l<C&&u[u.l]!=13;)switch(E={},E.name=Ni.utils.decode(w,u.slice(u.l,u.l+R)).replace(/[\u0000\r\n].*$/g,""),u.l+=R,E.type=String.fromCharCode(u.read_shift(1)),h!=2&&!g&&(E.offset=u.read_shift(4)),E.len=u.read_shift(1),h==2&&(E.offset=u.read_shift(2)),E.dec=u.read_shift(1),E.name.length&&y.push(E),h!=2&&(u.l+=g?13:14),E.type){case"B":(!m||E.len!=8)&&l.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+E.name+":"+E.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+E.type)}if(u[u.l]!==13&&(u.l=v-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=v;var D=0,F=0;for(c[0]=[],F=0;F!=y.length;++F)c[0][F]=y[F].name;for(;p-- >0;){if(u[u.l]===42){u.l+=x;continue}for(++u.l,c[++D]=[],F=0,F=0;F!=y.length;++F){var N=u.slice(u.l,u.l+y[F].len);u.l+=y[F].len,dr(N,0);var P=Ni.utils.decode(w,N);switch(y[F].type){case"C":P.trim().length&&(c[D][F]=P.replace(/\s+$/,""));break;case"D":P.length===8?c[D][F]=new Date(+P.slice(0,4),+P.slice(4,6)-1,+P.slice(6,8)):c[D][F]=P;break;case"F":c[D][F]=parseFloat(P.trim());break;case"+":case"I":c[D][F]=g?N.read_shift(-4,"i")^2147483648:N.read_shift(4,"i");break;case"L":switch(P.trim().toUpperCase()){case"Y":case"T":c[D][F]=!0;break;case"N":case"F":c[D][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+P+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[D][F]="##MEMO##"+(g?parseInt(P.trim(),10):N.read_shift(4));break;case"N":P=P.replace(/\u0000/g,"").trim(),P&&P!="."&&(c[D][F]=+P||0);break;case"@":c[D][F]=new Date(N.read_shift(-8,"f")-621356832e5);break;case"T":c[D][F]=new Date((N.read_shift(4)-2440588)*864e5+N.read_shift(4));break;case"Y":c[D][F]=N.read_shift(4,"i")/1e4+N.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[D][F]=-N.read_shift(-8,"f");break;case"B":if(m&&y[F].len==8){c[D][F]=N.read_shift(8,"f");break}case"G":case"P":N.l+=y[F].len;break;case"0":if(y[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[F].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=y,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=ea(r(o,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function i(o,l){try{return Xi(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&mo(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=lr(),h=xc(o,{header:1,raw:!0,cellDates:!0}),d=h[0],m=h.slice(1),g=o["!cols"]||[],p=0,v=0,x=0,w=1;for(p=0;p<d.length;++p){if(((g[p]||{}).DBF||{}).name){d[p]=g[p].DBF.name,++x;continue}if(d[p]!=null){if(++x,typeof d[p]=="number"&&(d[p]=d[p].toString(10)),typeof d[p]!="string")throw new Error("DBF Invalid column name "+d[p]+" |"+typeof d[p]+"|");if(d.indexOf(d[p])!==p){for(v=0;v<1024;++v)if(d.indexOf(d[p]+"_"+v)==-1){d[p]+="_"+v;break}}}}var y=Xe(o["!ref"]),E=[],C=[],R=[];for(p=0;p<=y.e.c-y.s.c;++p){var D="",F="",N=0,P=[];for(v=0;v<m.length;++v)m[v][p]!=null&&P.push(m[v][p]);if(P.length==0||d[p]==null){E[p]="?";continue}for(v=0;v<P.length;++v){switch(typeof P[v]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=P[v]instanceof Date?"D":"C";break;default:F="C"}N=Math.max(N,String(P[v]).length),D=D&&D!=F?"C":F}N>250&&(N=250),F=((g[p]||{}).DBF||{}).type,F=="C"&&g[p].DBF.len>N&&(N=g[p].DBF.len),D=="B"&&F=="N"&&(D="N",R[p]=g[p].DBF.dec,N=g[p].DBF.len),C[p]=D=="C"||F=="N"?N:s[D]||0,w+=C[p],E[p]=D}var W=u.next(32);for(W.write_shift(4,318902576),W.write_shift(4,m.length),W.write_shift(2,296+32*x),W.write_shift(2,w),p=0;p<4;++p)W.write_shift(4,0);for(W.write_shift(4,0|(+t[ox]||3)<<8),p=0,v=0;p<d.length;++p)if(d[p]!=null){var G=u.next(32),Q=(d[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);G.write_shift(1,Q,"sbcs"),G.write_shift(1,E[p]=="?"?"C":E[p],"sbcs"),G.write_shift(4,v),G.write_shift(1,C[p]||s[E[p]]||0),G.write_shift(1,R[p]||0),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(1,0),G.write_shift(4,0),G.write_shift(4,0),v+=C[p]||s[E[p]]||0}var ve=u.next(264);for(ve.write_shift(4,13),p=0;p<65;++p)ve.write_shift(4,0);for(p=0;p<m.length;++p){var ge=u.next(w);for(ge.write_shift(1,0),v=0;v<d.length;++v)if(d[v]!=null)switch(E[v]){case"L":ge.write_shift(1,m[p][v]==null?63:m[p][v]?84:70);break;case"B":ge.write_shift(8,m[p][v]||0,"f");break;case"N":var Te="0";for(typeof m[p][v]=="number"&&(Te=m[p][v].toFixed(R[v]||0)),x=0;x<C[v]-Te.length;++x)ge.write_shift(1,32);ge.write_shift(1,Te,"sbcs");break;case"D":m[p][v]?(ge.write_shift(4,("0000"+m[p][v].getFullYear()).slice(-4),"sbcs"),ge.write_shift(2,("00"+(m[p][v].getMonth()+1)).slice(-2),"sbcs"),ge.write_shift(2,("00"+m[p][v].getDate()).slice(-2),"sbcs")):ge.write_shift(8,"00000000","sbcs");break;case"C":var Ee=String(m[p][v]!=null?m[p][v]:"").slice(0,C[v]);for(ge.write_shift(1,Ee,"sbcs"),x=0;x<C[v]-Ee.length;++x)ge.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),cC=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+It(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,m){var g=e[m];return typeof g=="number"?hp(g):g},n=function(d,m,g){var p=m.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return p==59?d:hp(p)};e["|"]=254;function i(d,m){switch(m.type){case"base64":return s(An(d),m);case"binary":return s(d,m);case"buffer":return s(Fe&&Buffer.isBuffer(d)?d.toString("binary"):Oo(d),m);case"array":return s(Vc(d),m)}throw new Error("Unrecognized type "+m.type)}function s(d,m){var g=d.split(/[\n\r]+/),p=-1,v=-1,x=0,w=0,y=[],E=[],C=null,R={},D=[],F=[],N=[],P=0,W;for(+m.codepage>=0&&mo(+m.codepage);x!==g.length;++x){P=0;var G=g[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),Q=G.replace(/;;/g,"\0").split(";").map(function(I){return I.replace(/\u0000/g,";")}),ve=Q[0],ge;if(G.length>0)switch(ve){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Q[1].charAt(0)=="P"&&E.push(G.slice(3).replace(/;;/g,";"));break;case"C":var Te=!1,Ee=!1,H=!1,q=!1,ie=-1,pe=-1;for(w=1;w<Q.length;++w)switch(Q[w].charAt(0)){case"A":break;case"X":v=parseInt(Q[w].slice(1))-1,Ee=!0;break;case"Y":for(p=parseInt(Q[w].slice(1))-1,Ee||(v=0),W=y.length;W<=p;++W)y[W]=[];break;case"K":ge=Q[w].slice(1),ge.charAt(0)==='"'?ge=ge.slice(1,ge.length-1):ge==="TRUE"?ge=!0:ge==="FALSE"?ge=!1:isNaN(Tn(ge))?isNaN(xo(ge).getDate())||(ge=Qt(ge)):(ge=Tn(ge),C!==null&&yx(C)&&(ge=Ex(ge))),Te=!0;break;case"E":q=!0;var O=ob(Q[w].slice(1),{r:p,c:v});y[p][v]=[y[p][v],O];break;case"S":H=!0,y[p][v]=[y[p][v],"S5S"];break;case"G":break;case"R":ie=parseInt(Q[w].slice(1))-1;break;case"C":pe=parseInt(Q[w].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+G)}if(Te&&(y[p][v]&&y[p][v].length==2?y[p][v][0]=ge:y[p][v]=ge,C=null),H){if(q)throw new Error("SYLK shared formula cannot have own formula");var L=ie>-1&&y[ie][pe];if(!L||!L[1])throw new Error("SYLK shared formula cannot find base");y[p][v][1]=lb(L[1],{r:p-ie,c:v-pe})}break;case"F":var j=0;for(w=1;w<Q.length;++w)switch(Q[w].charAt(0)){case"X":v=parseInt(Q[w].slice(1))-1,++j;break;case"Y":for(p=parseInt(Q[w].slice(1))-1,W=y.length;W<=p;++W)y[W]=[];break;case"M":P=parseInt(Q[w].slice(1))/20;break;case"F":break;case"G":break;case"P":C=E[parseInt(Q[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(N=Q[w].slice(1).split(" "),W=parseInt(N[0],10);W<=parseInt(N[1],10);++W)P=parseInt(N[2],10),F[W-1]=P===0?{hidden:!0}:{wch:P},xh(F[W-1]);break;case"C":v=parseInt(Q[w].slice(1))-1,F[v]||(F[v]={});break;case"R":p=parseInt(Q[w].slice(1))-1,D[p]||(D[p]={}),P>0?(D[p].hpt=P,D[p].hpx=uv(P)):P===0&&(D[p].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+G)}j<1&&(C=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+G)}}return D.length>0&&(R["!rows"]=D),F.length>0&&(R["!cols"]=F),m&&m.sheetRows&&(y=y.slice(0,m.sheetRows)),[y,R]}function a(d,m){var g=i(d,m),p=g[0],v=g[1],x=ea(p,m);return It(v).forEach(function(w){x[w]=v[w]}),x}function o(d,m){return Xi(a(d,m),m)}function l(d,m,g,p){var v="C;Y"+(g+1)+";X"+(p+1)+";K";switch(d.t){case"n":v+=d.v||0,d.f&&!d.F&&(v+=";E"+yh(d.f,{r:g,c:p}));break;case"b":v+=d.v?"TRUE":"FALSE";break;case"e":v+=d.w||d.v;break;case"d":v+='"'+(d.w||d.v)+'"';break;case"s":v+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function c(d,m){m.forEach(function(g,p){var v="F;W"+(p+1)+" "+(p+1)+" ";g.hidden?v+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=dc(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=pc(g.wpx)),typeof g.wch=="number"&&(v+=Math.round(g.wch))),v.charAt(v.length-1)!=" "&&d.push(v)})}function u(d,m){m.forEach(function(g,p){var v="F;";g.hidden?v+="M0;":g.hpt?v+="M"+20*g.hpt+";":g.hpx&&(v+="M"+20*mc(g.hpx)+";"),v.length>2&&d.push(v+"R"+(p+1))})}function h(d,m){var g=["ID;PWXL;N;E"],p=[],v=Xe(d["!ref"]),x,w=Array.isArray(d),y=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),d["!cols"]&&c(g,d["!cols"]),d["!rows"]&&u(g,d["!rows"]),g.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var E=v.s.r;E<=v.e.r;++E)for(var C=v.s.c;C<=v.e.c;++C){var R=$e({r:E,c:C});x=w?(d[E]||[])[C]:d[R],!(!x||x.v==null&&(!x.f||x.F))&&p.push(l(x,d,E,C))}return g.join(y)+y+p.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),uC=function(){function e(s,a){switch(a.type){case"base64":return t(An(s),a);case"binary":return t(s,a);case"buffer":return t(Fe&&Buffer.isBuffer(s)?s.toString("binary"):Oo(s),a);case"array":return t(Vc(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){for(var o=s.split(`
`),l=-1,c=-1,u=0,h=[];u!==o.length;++u){if(o[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var d=o[u].trim().split(","),m=d[0],g=d[1];++u;for(var p=o[u]||"";(p.match(/["]/g)||[]).length&1&&u<o.length-1;)p+=`
`+o[++u];switch(p=p.trim(),+m){case-1:if(p==="BOT"){h[++l]=[],c=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?h[l][c]=!0:p==="FALSE"?h[l][c]=!1:isNaN(Tn(g))?isNaN(xo(g).getDate())?h[l][c]=g:h[l][c]=Qt(g):h[l][c]=Tn(g),++c;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),h[l][c++]=p!==""?p:null;break}if(p==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function r(s,a){return ea(e(s,a),a)}function n(s,a){return Xi(r(s,a),a)}var i=function(){var s=function(l,c,u,h,d){l.push(c),l.push(u+","+h),l.push('"'+d.replace(/"/g,'""')+'"')},a=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=Xe(l["!ref"]),h,d=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var m=u.s.r;m<=u.e.r;++m){a(c,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var p=$e({r:m,c:g});if(h=d?(l[m]||[])[g]:l[p],!h){a(c,1,0,"");continue}switch(h.t){case"n":var v=h.w;!v&&h.v!=null&&(v=h.v),v==null?h.f&&!h.F?a(c,1,0,"="+h.f):a(c,1,0,""):a(c,0,v,"V");break;case"b":a(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=ci(h.z||it[14],cr(Qt(h.v)))),a(c,0,h.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var x=`\r
`,w=c.join(x);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),av=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var m=h.split(`
`),g=-1,p=-1,v=0,x=[];v!==m.length;++v){var w=m[v].trim().split(":");if(w[0]==="cell"){var y=Tt(w[1]);if(x.length<=y.r)for(g=x.length;g<=y.r;++g)x[g]||(x[g]=[]);switch(g=y.r,p=y.c,w[2]){case"t":x[g][p]=e(w[3]);break;case"v":x[g][p]=+w[3];break;case"vtf":var E=w[w.length-1];case"vtc":switch(w[3]){case"nl":x[g][p]=!!+w[4];break;default:x[g][p]=+w[4];break}w[2]=="vtf"&&(x[g][p]=[x[g][p],E])}}}return d&&d.sheetRows&&(x=x.slice(0,d.sheetRows)),x}function n(h,d){return ea(r(h,d),d)}function i(h,d){return Xi(n(h,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var d=[],m=[],g,p="",v=yr(h["!ref"]),x=Array.isArray(h),w=v.s.r;w<=v.e.r;++w)for(var y=v.s.c;y<=v.e.c;++y)if(p=$e({r:w,c:y}),g=x?(h[w]||[])[y]:h[p],!(!g||g.v==null||g.t==="z")){switch(m=["cell",p,"t"],g.t){case"s":case"str":m.push(t(g.v));break;case"n":g.f?(m[2]="vtf",m[3]="n",m[4]=g.v,m[5]=t(g.f)):(m[2]="v",m[3]=g.v);break;case"b":m[2]="vt"+(g.f?"f":"c"),m[3]="nl",m[4]=g.v?"1":"0",m[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var E=cr(Qt(g.v));m[2]="vtc",m[3]="nd",m[4]=""+E,m[5]=g.w||ci(g.z||it[14],E);break;case"e":continue}d.push(m.join(":"))}return d.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function u(h){return[s,a,o,a,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),fC=function(){function e(u,h,d,m,g){g.raw?h[d][m]=u:u===""||(u==="TRUE"?h[d][m]=!0:u==="FALSE"?h[d][m]=!1:isNaN(Tn(u))?isNaN(xo(u).getDate())?h[d][m]=u:h[d][m]=Qt(u):h[d][m]=Tn(u))}function t(u,h){var d=h||{},m=[];if(!u||u.length===0)return m;for(var g=u.split(/[\r\n]/),p=g.length-1;p>=0&&g[p].length===0;)--p;for(var v=10,x=0,w=0;w<=p;++w)x=g[w].indexOf(" "),x==-1?x=g[w].length:x++,v=Math.max(v,x);for(w=0;w<=p;++w){m[w]=[];var y=0;for(e(g[w].slice(0,v).trim(),m,w,y,d),y=1;y<=(g[w].length-v)/10+1;++y)e(g[w].slice(v+(y-1)*10,v+y*10).trim(),m,w,y,d)}return d.sheetRows&&(m=m.slice(0,d.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var h={},d=!1,m=0,g=0;m<u.length;++m)(g=u.charCodeAt(m))==34?d=!d:!d&&g in r&&(h[g]=(h[g]||0)+1);g=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&g.push([h[m],m]);if(!g.length){h=n;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&g.push([h[m],m])}return g.sort(function(p,v){return p[0]-v[0]||n[p[1]]-n[v[1]]}),r[g.pop()[1]]||44}function s(u,h){var d=h||{},m="",g=d.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(m=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(m=u.charAt(4),u=u.slice(6)):m=i(u.slice(0,1024)):d&&d.FS?m=d.FS:m=i(u.slice(0,1024));var v=0,x=0,w=0,y=0,E=0,C=m.charCodeAt(0),R=!1,D=0,F=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var N=d.dateNF!=null?b4(d.dateNF):null;function P(){var W=u.slice(y,E),G={};if(W.charAt(0)=='"'&&W.charAt(W.length-1)=='"'&&(W=W.slice(1,-1).replace(/""/g,'"')),W.length===0)G.t="z";else if(d.raw)G.t="s",G.v=W;else if(W.trim().length===0)G.t="s",G.v=W;else if(W.charCodeAt(0)==61)W.charCodeAt(1)==34&&W.charCodeAt(W.length-1)==34?(G.t="s",G.v=W.slice(2,-1).replace(/""/g,'"')):cb(W)?(G.t="n",G.f=W.slice(1)):(G.t="s",G.v=W);else if(W=="TRUE")G.t="b",G.v=!0;else if(W=="FALSE")G.t="b",G.v=!1;else if(!isNaN(w=Tn(W)))G.t="n",d.cellText!==!1&&(G.w=W),G.v=w;else if(!isNaN(xo(W).getDate())||N&&W.match(N)){G.z=d.dateNF||it[14];var Q=0;N&&W.match(N)&&(W=N4(W,d.dateNF,W.match(N)||[]),Q=1),d.cellDates?(G.t="d",G.v=Qt(W,Q)):(G.t="n",G.v=cr(Qt(W,Q))),d.cellText!==!1&&(G.w=ci(G.z,G.v instanceof Date?cr(G.v):G.v)),d.cellNF||delete G.z}else G.t="s",G.v=W;if(G.t=="z"||(d.dense?(g[v]||(g[v]=[]),g[v][x]=G):g[$e({c:x,r:v})]=G),y=E+1,F=u.charCodeAt(y),p.e.c<x&&(p.e.c=x),p.e.r<v&&(p.e.r=v),D==C)++x;else if(x=0,++v,d.sheetRows&&d.sheetRows<=v)return!0}e:for(;E<u.length;++E)switch(D=u.charCodeAt(E)){case 34:F===34&&(R=!R);break;case C:case 10:case 13:if(!R&&P())break e;break}return E-y>0&&P(),g["!ref"]=dt(p),g}function a(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,h):ea(t(u,h),h)}function o(u,h){var d="",m=h.type=="string"?[0,0,0,0]:ED(u,h);switch(h.type){case"base64":d=An(u);break;case"binary":d=u;break;case"buffer":h.codepage==65001?d=u.toString("utf8"):h.codepage&&typeof Ni<"u"?d=Ni.utils.decode(h.codepage,u):d=Fe&&Buffer.isBuffer(u)?u.toString("binary"):Oo(u);break;case"array":d=Vc(u);break;case"string":d=u;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?d=za(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=za(d):h.type=="binary"&&typeof Ni<"u"&&h.codepage&&(d=Ni.utils.decode(h.codepage,Ni.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?av.to_sheet(h.type=="string"?d:za(d),h):a(d,h)}function l(u,h){return Xi(o(u,h),h)}function c(u){for(var h=[],d=Xe(u["!ref"]),m,g=Array.isArray(u),p=d.s.r;p<=d.e.r;++p){for(var v=[],x=d.s.c;x<=d.e.c;++x){var w=$e({r:p,c:x});if(m=g?(u[p]||[])[x]:u[w],!m||m.v==null){v.push("          ");continue}for(var y=(m.w||(Dn(m),m.w)||"").slice(0,10);y.length<10;)y+=" ";v.push(y+(x===0?" ":""))}h.push(v.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}(),zp=function(){function e(O,L,j){if(O){dr(O,O.l||0);for(var I=j.Enum||ie;O.l<O.length;){var X=O.read_shift(2),ce=I[X]||I[65535],me=O.read_shift(2),de=O.l+me,ae=ce.f&&ce.f(O,me,j);if(O.l=de,L(ae,ce,X))return}}}function t(O,L){switch(L.type){case"base64":return r($r(An(O)),L);case"binary":return r($r(O),L);case"buffer":case"array":return r(O,L)}throw"Unsupported type "+L.type}function r(O,L){if(!O)return O;var j=L||{},I=j.dense?[]:{},X="Sheet1",ce="",me=0,de={},ae=[],je=[],ke={s:{r:0,c:0},e:{r:0,c:0}},at=j.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)j.Enum=ie,e(O,function(fe,Vt,Tr){switch(Tr){case 0:j.vers=fe,fe>=4096&&(j.qpro=!0);break;case 6:ke=fe;break;case 204:fe&&(ce=fe);break;case 222:ce=fe;break;case 15:case 51:j.qpro||(fe[1].v=fe[1].v.slice(1));case 13:case 14:case 16:Tr==14&&(fe[2]&112)==112&&(fe[2]&15)>1&&(fe[2]&15)<15&&(fe[1].z=j.dateNF||it[14],j.cellDates&&(fe[1].t="d",fe[1].v=Ex(fe[1].v))),j.qpro&&fe[3]>me&&(I["!ref"]=dt(ke),de[X]=I,ae.push(X),I=j.dense?[]:{},ke={s:{r:0,c:0},e:{r:0,c:0}},me=fe[3],X=ce||"Sheet"+(me+1),ce="");var on=j.dense?(I[fe[0].r]||[])[fe[0].c]:I[$e(fe[0])];if(on){on.t=fe[1].t,on.v=fe[1].v,fe[1].z!=null&&(on.z=fe[1].z),fe[1].f!=null&&(on.f=fe[1].f);break}j.dense?(I[fe[0].r]||(I[fe[0].r]=[]),I[fe[0].r][fe[0].c]=fe[1]):I[$e(fe[0])]=fe[1];break}},j);else if(O[2]==26||O[2]==14)j.Enum=pe,O[2]==14&&(j.qpro=!0,O.l=0),e(O,function(fe,Vt,Tr){switch(Tr){case 204:X=fe;break;case 22:fe[1].v=fe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(fe[3]>me&&(I["!ref"]=dt(ke),de[X]=I,ae.push(X),I=j.dense?[]:{},ke={s:{r:0,c:0},e:{r:0,c:0}},me=fe[3],X="Sheet"+(me+1)),at>0&&fe[0].r>=at)break;j.dense?(I[fe[0].r]||(I[fe[0].r]=[]),I[fe[0].r][fe[0].c]=fe[1]):I[$e(fe[0])]=fe[1],ke.e.c<fe[0].c&&(ke.e.c=fe[0].c),ke.e.r<fe[0].r&&(ke.e.r=fe[0].r);break;case 27:fe[14e3]&&(je[fe[14e3][0]]=fe[14e3][1]);break;case 1537:je[fe[0]]=fe[1],fe[0]==me&&(X=fe[1]);break}},j);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(I["!ref"]=dt(ke),de[ce||X]=I,ae.push(ce||X),!je.length)return{SheetNames:ae,Sheets:de};for(var Ae={},Ct=[],Ve=0;Ve<je.length;++Ve)de[ae[Ve]]?(Ct.push(je[Ve]||ae[Ve]),Ae[je[Ve]]=de[je[Ve]]||de[ae[Ve]]):(Ct.push(je[Ve]),Ae[je[Ve]]={"!ref":"A1"});return{SheetNames:Ct,Sheets:Ae}}function n(O,L){var j=L||{};if(+j.codepage>=0&&mo(+j.codepage),j.type=="string")throw new Error("Cannot write WK1 to JS string");var I=lr(),X=Xe(O["!ref"]),ce=Array.isArray(O),me=[];ne(I,0,s(1030)),ne(I,6,l(X));for(var de=Math.min(X.e.r,8191),ae=X.s.r;ae<=de;++ae)for(var je=Rt(ae),ke=X.s.c;ke<=X.e.c;++ke){ae===X.s.r&&(me[ke]=Ht(ke));var at=me[ke]+je,Ae=ce?(O[ae]||[])[ke]:O[at];if(!(!Ae||Ae.t=="z"))if(Ae.t=="n")(Ae.v|0)==Ae.v&&Ae.v>=-32768&&Ae.v<=32767?ne(I,13,m(ae,ke,Ae.v)):ne(I,14,p(ae,ke,Ae.v));else{var Ct=Dn(Ae);ne(I,15,h(ae,ke,Ct.slice(0,239)))}}return ne(I,1),I.end()}function i(O,L){var j=L||{};if(+j.codepage>=0&&mo(+j.codepage),j.type=="string")throw new Error("Cannot write WK3 to JS string");var I=lr();ne(I,0,a(O));for(var X=0,ce=0;X<O.SheetNames.length;++X)(O.Sheets[O.SheetNames[X]]||{})["!ref"]&&ne(I,27,q(O.SheetNames[X],ce++));var me=0;for(X=0;X<O.SheetNames.length;++X){var de=O.Sheets[O.SheetNames[X]];if(!(!de||!de["!ref"])){for(var ae=Xe(de["!ref"]),je=Array.isArray(de),ke=[],at=Math.min(ae.e.r,8191),Ae=ae.s.r;Ae<=at;++Ae)for(var Ct=Rt(Ae),Ve=ae.s.c;Ve<=ae.e.c;++Ve){Ae===ae.s.r&&(ke[Ve]=Ht(Ve));var fe=ke[Ve]+Ct,Vt=je?(de[Ae]||[])[Ve]:de[fe];if(!(!Vt||Vt.t=="z"))if(Vt.t=="n")ne(I,23,P(Ae,Ve,me,Vt.v));else{var Tr=Dn(Vt);ne(I,22,D(Ae,Ve,me,Tr.slice(0,239)))}}++me}}return ne(I,1),I.end()}function s(O){var L=V(2);return L.write_shift(2,O),L}function a(O){var L=V(26);L.write_shift(2,4096),L.write_shift(2,4),L.write_shift(4,0);for(var j=0,I=0,X=0,ce=0;ce<O.SheetNames.length;++ce){var me=O.SheetNames[ce],de=O.Sheets[me];if(!(!de||!de["!ref"])){++X;var ae=yr(de["!ref"]);j<ae.e.r&&(j=ae.e.r),I<ae.e.c&&(I=ae.e.c)}}return j>8191&&(j=8191),L.write_shift(2,j),L.write_shift(1,X),L.write_shift(1,I),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(1,1),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(4,0),L}function o(O,L,j){var I={s:{c:0,r:0},e:{c:0,r:0}};return L==8&&j.qpro?(I.s.c=O.read_shift(1),O.l++,I.s.r=O.read_shift(2),I.e.c=O.read_shift(1),O.l++,I.e.r=O.read_shift(2),I):(I.s.c=O.read_shift(2),I.s.r=O.read_shift(2),L==12&&j.qpro&&(O.l+=2),I.e.c=O.read_shift(2),I.e.r=O.read_shift(2),L==12&&j.qpro&&(O.l+=2),I.s.c==65535&&(I.s.c=I.e.c=I.s.r=I.e.r=0),I)}function l(O){var L=V(8);return L.write_shift(2,O.s.c),L.write_shift(2,O.s.r),L.write_shift(2,O.e.c),L.write_shift(2,O.e.r),L}function c(O,L,j){var I=[{c:0,r:0},{t:"n",v:0},0,0];return j.qpro&&j.vers!=20768?(I[0].c=O.read_shift(1),I[3]=O.read_shift(1),I[0].r=O.read_shift(2),O.l+=2):(I[2]=O.read_shift(1),I[0].c=O.read_shift(2),I[0].r=O.read_shift(2)),I}function u(O,L,j){var I=O.l+L,X=c(O,L,j);if(X[1].t="s",j.vers==20768){O.l++;var ce=O.read_shift(1);return X[1].v=O.read_shift(ce,"utf8"),X}return j.qpro&&O.l++,X[1].v=O.read_shift(I-O.l,"cstr"),X}function h(O,L,j){var I=V(7+j.length);I.write_shift(1,255),I.write_shift(2,L),I.write_shift(2,O),I.write_shift(1,39);for(var X=0;X<I.length;++X){var ce=j.charCodeAt(X);I.write_shift(1,ce>=128?95:ce)}return I.write_shift(1,0),I}function d(O,L,j){var I=c(O,L,j);return I[1].v=O.read_shift(2,"i"),I}function m(O,L,j){var I=V(7);return I.write_shift(1,255),I.write_shift(2,L),I.write_shift(2,O),I.write_shift(2,j,"i"),I}function g(O,L,j){var I=c(O,L,j);return I[1].v=O.read_shift(8,"f"),I}function p(O,L,j){var I=V(13);return I.write_shift(1,255),I.write_shift(2,L),I.write_shift(2,O),I.write_shift(8,j,"f"),I}function v(O,L,j){var I=O.l+L,X=c(O,L,j);if(X[1].v=O.read_shift(8,"f"),j.qpro)O.l=I;else{var ce=O.read_shift(2);E(O.slice(O.l,O.l+ce),X),O.l+=ce}return X}function x(O,L,j){var I=L&32768;return L&=-32769,L=(I?O:0)+(L>=8192?L-16384:L),(I?"":"$")+(j?Ht(L):Rt(L))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function E(O,L){dr(O,0);for(var j=[],I=0,X="",ce="",me="",de="";O.l<O.length;){var ae=O[O.l++];switch(ae){case 0:j.push(O.read_shift(8,"f"));break;case 1:ce=x(L[0].c,O.read_shift(2),!0),X=x(L[0].r,O.read_shift(2),!1),j.push(ce+X);break;case 2:{var je=x(L[0].c,O.read_shift(2),!0),ke=x(L[0].r,O.read_shift(2),!1);ce=x(L[0].c,O.read_shift(2),!0),X=x(L[0].r,O.read_shift(2),!1),j.push(je+ke+":"+ce+X)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:j.push("("+j.pop()+")");break;case 5:j.push(O.read_shift(2));break;case 6:{for(var at="";ae=O[O.l++];)at+=String.fromCharCode(ae);j.push('"'+at.replace(/"/g,'""')+'"')}break;case 8:j.push("-"+j.pop());break;case 23:j.push("+"+j.pop());break;case 22:j.push("NOT("+j.pop()+")");break;case 20:case 21:de=j.pop(),me=j.pop(),j.push(["AND","OR"][ae-20]+"("+me+","+de+")");break;default:if(ae<32&&y[ae])de=j.pop(),me=j.pop(),j.push(me+y[ae]+de);else if(w[ae]){if(I=w[ae][1],I==69&&(I=O[O.l++]),I>j.length){console.error("WK1 bad formula parse 0x"+ae.toString(16)+":|"+j.join("|")+"|");return}var Ae=j.slice(-I);j.length-=I,j.push(w[ae][0]+"("+Ae.join(",")+")")}else return ae<=7?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=24?console.error("WK1 unsupported op "+ae.toString(16)):ae<=30?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=115?console.error("WK1 unsupported function opcode "+ae.toString(16)):console.error("WK1 unrecognized opcode "+ae.toString(16))}}j.length==1?L[1].f=""+j[0]:console.error("WK1 bad formula parse |"+j.join("|")+"|")}function C(O){var L=[{c:0,r:0},{t:"n",v:0},0];return L[0].r=O.read_shift(2),L[3]=O[O.l++],L[0].c=O[O.l++],L}function R(O,L){var j=C(O);return j[1].t="s",j[1].v=O.read_shift(L-4,"cstr"),j}function D(O,L,j,I){var X=V(6+I.length);X.write_shift(2,O),X.write_shift(1,j),X.write_shift(1,L),X.write_shift(1,39);for(var ce=0;ce<I.length;++ce){var me=I.charCodeAt(ce);X.write_shift(1,me>=128?95:me)}return X.write_shift(1,0),X}function F(O,L){var j=C(O);j[1].v=O.read_shift(2);var I=j[1].v>>1;if(j[1].v&1)switch(I&7){case 0:I=(I>>3)*5e3;break;case 1:I=(I>>3)*500;break;case 2:I=(I>>3)/20;break;case 3:I=(I>>3)/200;break;case 4:I=(I>>3)/2e3;break;case 5:I=(I>>3)/2e4;break;case 6:I=(I>>3)/16;break;case 7:I=(I>>3)/64;break}return j[1].v=I,j}function N(O,L){var j=C(O),I=O.read_shift(4),X=O.read_shift(4),ce=O.read_shift(2);if(ce==65535)return I===0&&X===3221225472?(j[1].t="e",j[1].v=15):I===0&&X===3489660928?(j[1].t="e",j[1].v=42):j[1].v=0,j;var me=ce&32768;return ce=(ce&32767)-16446,j[1].v=(1-me*2)*(X*Math.pow(2,ce+32)+I*Math.pow(2,ce)),j}function P(O,L,j,I){var X=V(14);if(X.write_shift(2,O),X.write_shift(1,j),X.write_shift(1,L),I==0)return X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,65535),X;var ce=0,me=0,de=0,ae=0;return I<0&&(ce=1,I=-I),me=Math.log2(I)|0,I/=Math.pow(2,me-31),ae=I>>>0,ae&2147483648||(I/=2,++me,ae=I>>>0),I-=ae,ae|=2147483648,ae>>>=0,I*=Math.pow(2,32),de=I>>>0,X.write_shift(4,de),X.write_shift(4,ae),me+=16383+(ce?32768:0),X.write_shift(2,me),X}function W(O,L){var j=N(O);return O.l+=L-14,j}function G(O,L){var j=C(O),I=O.read_shift(4);return j[1].v=I>>6,j}function Q(O,L){var j=C(O),I=O.read_shift(8,"f");return j[1].v=I,j}function ve(O,L){var j=Q(O);return O.l+=L-10,j}function ge(O,L){return O[O.l+L-1]==0?O.read_shift(L,"cstr"):""}function Te(O,L){var j=O[O.l++];j>L-1&&(j=L-1);for(var I="";I.length<j;)I+=String.fromCharCode(O[O.l++]);return I}function Ee(O,L,j){if(!(!j.qpro||L<21)){var I=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var X=O.read_shift(L-21,"cstr");return[I,X]}}function H(O,L){for(var j={},I=O.l+L;O.l<I;){var X=O.read_shift(2);if(X==14e3){for(j[X]=[0,""],j[X][0]=O.read_shift(2);O[O.l];)j[X][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return j}function q(O,L){var j=V(5+O.length);j.write_shift(2,14e3),j.write_shift(2,L);for(var I=0;I<O.length;++I){var X=O.charCodeAt(I);j[j.l++]=X>127?95:X}return j[j.l++]=0,j}var ie={0:{n:"BOF",f:tv},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ge},222:{n:"SHEETNAMELP",f:Te},65535:{n:""}},pe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:N},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:W},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:H},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:G},38:{n:"??"},39:{n:"NUMBER27",f:Q},40:{n:"FORMULA28",f:ve},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ge},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ee},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}(),hC=/^\s|\s$|[\t\n\r]/;function ov(e,t){if(!t.bookSST)return"";var r=[mt];r[r.length]=re("sst",null,{xmlns:Zs[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(hC)&&(s+=' xml:space="preserve"'),s+=">"+Be(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function dC(e){return[e.read_shift(4),e.read_shift(4)]}function pC(e,t){return t||(t=V(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var mC=s3;function gC(e){var t=lr();Y(t,159,pC(e));for(var r=0;r<e.length;++r)Y(t,19,mC(e[r]));return Y(t,160),t.end()}function xC(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function lv(e){var t=0,r,n=xC(e),i=n.length+1,s,a,o,l,c;for(r=Hi(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^a;return t^52811}var vC=function(){function e(i,s){switch(s.type){case"base64":return t(An(i),s);case"binary":return t(i,s);case"buffer":return t(Fe&&Buffer.isBuffer(i)?i.toString("binary"):Oo(i),s);case"array":return t(Vc(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(o)&&(o[h]=[]);for(var d=/\\\w+\b/g,m=0,g,p=-1;g=d.exec(u);){switch(g[0]){case"\\cell":var v=u.slice(m,d.lastIndex-g[0].length);if(v[0]==" "&&(v=v.slice(1)),++p,v.length){var x={v,t:"s"};Array.isArray(o)?o[h][p]=x:o[$e({r:h,c:p})]=x}break}m=d.lastIndex}p>c.e.c&&(c.e.c=p)}),o["!ref"]=dt(c),o}function r(i,s){return Xi(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=Xe(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var h=$e({r:c,c:u});o=l?(i[c]||[])[u]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Dn(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Wp(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var yC=6,En=yC;function dc(e){return Math.floor((e+Math.round(128/En)/256)*En)}function pc(e){return Math.floor((e-5)/En*100+.5)/100}function Y0(e){return Math.round((e*En+5)/En*256)/256}function xh(e){e.width?(e.wpx=dc(e.width),e.wch=pc(e.wpx),e.MDW=En):e.wpx?(e.wch=pc(e.wpx),e.width=Y0(e.wch),e.MDW=En):typeof e.wch=="number"&&(e.width=Y0(e.wch),e.wpx=dc(e.width),e.MDW=En),e.customWidth&&delete e.customWidth}var wC=96,cv=wC;function mc(e){return e*96/cv}function uv(e){return e*cv/96}function _C(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=re("numFmt",null,{numFmtId:n,formatCode:Be(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=re("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function TC(e){var t=[];return t[t.length]=re("cellXfs",null),e.forEach(function(r){t[t.length]=re("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=re("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function fv(e,t){var r=[mt,re("styleSheet",null,{xmlns:Zs[0],"xmlns:vt":_t.vt})],n;return e.SSF&&(n=_C(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=TC(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function EC(e,t){var r=e.read_shift(2),n=zt(e);return[r,n]}function SC(e,t,r){r||(r=V(6+4*t.length)),r.write_shift(2,e),Et(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function kC(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=h3(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=f3(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=zt(e),n}function CC(e,t){t||(t=V(25+4*32)),t.write_shift(2,e.sz*20),d3(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),fc(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),Et(e.name,t),t.length>t.l?t.slice(0,t.l):t}var bC=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Iu,NC=an;function Vp(e,t){t||(t=V(4*3+8*7+16*1)),Iu||(Iu=sh(bC));var r=Iu[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(fc({auto:1},t),fc({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function AC(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function hv(e,t,r){r||(r=V(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function wa(e,t){return t||(t=V(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var DC=an;function OC(e,t){return t||(t=V(51)),t.write_shift(1,0),wa(null,t),wa(null,t),wa(null,t),wa(null,t),wa(null,t),t.length>t.l?t.slice(0,t.l):t}function PC(e,t){return t||(t=V(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),uc(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function FC(e,t,r){var n=V(2052);return n.write_shift(4,e),uc(t,n),uc(r,n),n.length>n.l?n.slice(0,n.l):n}function RC(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(Y(e,615,Vr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Y(e,44,SC(i,t[i]))}),Y(e,616))}}function jC(e){var t=1;Y(e,611,Vr(t)),Y(e,43,CC({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Y(e,612)}function IC(e){var t=2;Y(e,603,Vr(t)),Y(e,45,Vp({patternType:"none"})),Y(e,45,Vp({patternType:"gray125"})),Y(e,604)}function LC(e){var t=1;Y(e,613,Vr(t)),Y(e,46,OC()),Y(e,614)}function MC(e){var t=1;Y(e,626,Vr(t)),Y(e,47,hv({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Y(e,627)}function BC(e,t){Y(e,617,Vr(t.length)),t.forEach(function(r){Y(e,47,hv(r,0))}),Y(e,618)}function UC(e){var t=1;Y(e,619,Vr(t)),Y(e,48,PC({xfId:0,builtinId:0,name:"Normal"})),Y(e,620)}function $C(e){var t=0;Y(e,505,Vr(t)),Y(e,506)}function HC(e){var t=0;Y(e,508,FC(t,"TableStyleMedium9","PivotStyleMedium4")),Y(e,509)}function zC(e,t){var r=lr();return Y(r,278),RC(r,e.SSF),jC(r),IC(r),LC(r),MC(r),BC(r,t.cellXfs),UC(r),$C(r),HC(r),Y(r,279),r.end()}function dv(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[mt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function WC(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:zt(e)}}function VC(e){var t=V(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Et(e.name,t),t.slice(0,t.l)}function GC(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function KC(e){var t=V(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function XC(e,t){var r=V(8+2*t.length);return r.write_shift(4,e),Et(t,r),r.slice(0,r.l)}function YC(e){return e.l+=4,e.read_shift(4)!=0}function qC(e,t){var r=V(8);return r.write_shift(4,e),r.write_shift(4,1),r}function QC(){var e=lr();return Y(e,332),Y(e,334,Vr(1)),Y(e,335,VC({name:"XLDAPR",version:12e4,flags:3496657072})),Y(e,336),Y(e,339,XC(1,"XLDAPR")),Y(e,52),Y(e,35,Vr(514)),Y(e,4096,Vr(0)),Y(e,4097,kr(1)),Y(e,36),Y(e,53),Y(e,340),Y(e,337,qC(1)),Y(e,51,KC([[1,0]])),Y(e,338),Y(e,333),e.end()}function pv(){var e=[mt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function JC(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=$e(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var Ss=1024;function mv(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[re("xml",null,{"xmlns:v":pr.v,"xmlns:o":pr.o,"xmlns:x":pr.x,"xmlns:mv":pr.mv}).replace(/\/>/,">"),re("o:shapelayout",re("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),re("v:shapetype",[re("v:stroke",null,{joinstyle:"miter"}),re("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Ss<e*1e3;)Ss+=1e3;return t.forEach(function(s){var a=Tt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?re("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=re("v:fill",l,o),u={on:"t",obscured:"t"};++Ss,i=i.concat(["<v:shape"+yo({id:"_x0000_s"+Ss,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,re("v:shadow",null,u),re("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Pt("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Pt("x:AutoFill","False"),Pt("x:Row",String(a.r)),Pt("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function gv(e){var t=[mt,re("comments",null,{xmlns:Zs[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=Be(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(Be(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(Pt("t",Be(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;t.push(Pt("t",Be(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function ZC(e,t,r){var n=[mt,re("ThreadedComments",null,{xmlns:_t.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),n.push(re("threadedComment",Pt("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function eb(e){var t=[mt,re("personList",null,{xmlns:_t.TCMNT,"xmlns:x":Zs[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(re("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function tb(e){var t={};t.iauthor=e.read_shift(4);var r=Ji(e);return t.rfx=r.s,t.ref=$e(r.s),e.l+=16,t}function rb(e,t){return t==null&&(t=V(36)),t.write_shift(4,e[1].iauthor),ta(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var nb=zt;function ib(e){return Et(e.slice(0,54))}function sb(e){var t=lr(),r=[];return Y(t,628),Y(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Y(t,632,ib(i.a)))})}),Y(t,631),Y(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Tt(n[0]),e:Tt(n[0])};Y(t,635,rb([s,i])),i.t&&i.t.length>0&&Y(t,637,o3(i)),Y(t,636),delete i.iauthor})}),Y(t,634),Y(t,629),t.end()}function ab(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&He.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var xv=["xlsb","xlsm","xlam","biff8","xla"],ob=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,i+(o?"":"$")+Ht(u)+(l?"":"$")+Rt(c)}return function(i,s){return t=s,i.replace(e,r)}}(),vh=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,yh=function(){return function(t,r){return t.replace(vh,function(n,i,s,a,o,l){var c=hh(a)-(s?0:r.c),u=fh(l)-(o?0:r.r),h=u==0?"":o?u+1:"["+u+"]",d=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+d})}}();function lb(e,t){return e.replace(vh,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Ht(hh(s)+t.c))+(a=="$"?a+o:Rt(fh(o)+t.r))})}function cb(e){return e.length!=1}function ft(e){e.l+=1}function ui(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function vv(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return yv(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),a=ui(e),o=ui(e);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function yv(e){var t=ui(e),r=ui(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function ub(e,t,r){if(r.biff<8)return yv(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=ui(e),a=ui(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function wv(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return fb(e);var n=e.read_shift(r&&r.biff==12?4:2),i=ui(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function fb(e){var t=ui(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function hb(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function db(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return pb(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function pb(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function mb(e,t,r){var n=(e[e.l++]&96)>>5,i=vv(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function gb(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var a=vv(e,s,r);return[n,i,a]}function xb(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function vb(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function yb(e,t,r){var n=(e[e.l++]&96)>>5,i=ub(e,t-1,r);return[n,i]}function wb(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Gp(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function _b(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function Tb(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Eb(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Sb(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function kb(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function _v(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Cb(e){return e.read_shift(2),_v(e)}function bb(e){return e.read_shift(2),_v(e)}function Nb(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=wv(e,0,r);return[n,i]}function Ab(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=db(e,0,r);return[n,i]}function Db(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=wv(e,0,r);return[n,i,s]}function Ob(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[ON[i],Sv[i],n]}function Pb(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Fb(e);return[i,(s[0]===0?Sv:DN)[s[1]]]}function Fb(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Rb(e,t,r){e.l+=r&&r.biff==2?3:4}function jb(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Ib(e){return e.l++,Ro[e.read_shift(1)]}function Lb(e){return e.l++,e.read_shift(2)}function Mb(e){return e.l++,e.read_shift(1)!==0}function Bb(e){return e.l++,ra(e)}function Ub(e,t,r){return e.l++,nv(e,t-1,r)}function $b(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=D3(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ro[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ra(e);break;case 2:r[1]=R3(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Hb(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Ji:L3)(e));return i}function zb(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=$b(e,r.biff);return a}function Wb(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function Vb(e,t,r){if(r.biff==5)return Gb(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function Gb(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Kb(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Xb(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Yb(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function qb(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var Qb=an,Jb=an,Zb=an;function jo(e,t,r){return e.l+=2,[hb(e)]}function wh(e){return e.l+=6,[]}var eN=jo,tN=wh,rN=wh,nN=jo;function Tv(e){return e.l+=2,[tv(e),e.read_shift(2)&1]}var iN=jo,sN=Tv,aN=wh,oN=jo,lN=jo,cN=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function uN(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),a=cN[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:i,C:s}}function fN(e){return e.l+=2,[e.read_shift(4)]}function hN(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function dN(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function pN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function mN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function gN(e){return e.l+=4,[0,0]}var Kp={1:{n:"PtgExp",f:jb},2:{n:"PtgTbl",f:Zb},3:{n:"PtgAdd",f:ft},4:{n:"PtgSub",f:ft},5:{n:"PtgMul",f:ft},6:{n:"PtgDiv",f:ft},7:{n:"PtgPower",f:ft},8:{n:"PtgConcat",f:ft},9:{n:"PtgLt",f:ft},10:{n:"PtgLe",f:ft},11:{n:"PtgEq",f:ft},12:{n:"PtgGe",f:ft},13:{n:"PtgGt",f:ft},14:{n:"PtgNe",f:ft},15:{n:"PtgIsect",f:ft},16:{n:"PtgUnion",f:ft},17:{n:"PtgRange",f:ft},18:{n:"PtgUplus",f:ft},19:{n:"PtgUminus",f:ft},20:{n:"PtgPercent",f:ft},21:{n:"PtgParen",f:ft},22:{n:"PtgMissArg",f:ft},23:{n:"PtgStr",f:Ub},26:{n:"PtgSheet",f:hN},27:{n:"PtgEndSheet",f:dN},28:{n:"PtgErr",f:Ib},29:{n:"PtgBool",f:Mb},30:{n:"PtgInt",f:Lb},31:{n:"PtgNum",f:Bb},32:{n:"PtgArray",f:wb},33:{n:"PtgFunc",f:Ob},34:{n:"PtgFuncVar",f:Pb},35:{n:"PtgName",f:Wb},36:{n:"PtgRef",f:Nb},37:{n:"PtgArea",f:mb},38:{n:"PtgMemArea",f:Kb},39:{n:"PtgMemErr",f:Qb},40:{n:"PtgMemNoMem",f:Jb},41:{n:"PtgMemFunc",f:Xb},42:{n:"PtgRefErr",f:Yb},43:{n:"PtgAreaErr",f:xb},44:{n:"PtgRefN",f:Ab},45:{n:"PtgAreaN",f:yb},46:{n:"PtgMemAreaN",f:pN},47:{n:"PtgMemNoMemN",f:mN},57:{n:"PtgNameX",f:Vb},58:{n:"PtgRef3d",f:Db},59:{n:"PtgArea3d",f:gb},60:{n:"PtgRefErr3d",f:qb},61:{n:"PtgAreaErr3d",f:vb},255:{}},xN={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},vN={1:{n:"PtgElfLel",f:Tv},2:{n:"PtgElfRw",f:oN},3:{n:"PtgElfCol",f:eN},6:{n:"PtgElfRwV",f:lN},7:{n:"PtgElfColV",f:nN},10:{n:"PtgElfRadical",f:iN},11:{n:"PtgElfRadicalS",f:aN},13:{n:"PtgElfColS",f:tN},15:{n:"PtgElfColSV",f:rN},16:{n:"PtgElfRadicalLel",f:sN},25:{n:"PtgList",f:uN},29:{n:"PtgSxName",f:fN},255:{}},yN={0:{n:"PtgAttrNoop",f:gN},1:{n:"PtgAttrSemi",f:kb},2:{n:"PtgAttrIf",f:Eb},4:{n:"PtgAttrChoose",f:_b},8:{n:"PtgAttrGoto",f:Tb},16:{n:"PtgAttrSum",f:Rb},32:{n:"PtgAttrBaxcel",f:Gp},33:{n:"PtgAttrBaxcel",f:Gp},64:{n:"PtgAttrSpace",f:Cb},65:{n:"PtgAttrSpaceSemi",f:bb},128:{n:"PtgAttrIfError",f:Sb},255:{}};function wN(e,t,r,n){if(n.biff<8)return an(e,t);for(var i=e.l+t,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=zb(e,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=Hb(e,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=i-e.l,t!==0&&s.push(an(e,t)),s}function _N(e,t,r){for(var n=e.l+t,i,s,a=[];n!=e.l;)t=n-e.l,s=e[e.l],i=Kp[s]||Kp[xN[s]],(s===24||s===25)&&(i=(s===24?vN:yN)[e[e.l+1]]),!i||!i.f?an(e,t):a.push([i.n,i.f(e,t,r)]);return a}function TN(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var EN={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function SN(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Ev(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Xp(e,t,r){var n=Ev(e,t,r);return n=="#REF"?n:SN(n,r)}function Gs(e,t,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,u,h=0,d=0,m,g="";if(!e[0]||!e[0][0])return"";for(var p=-1,v="",x=0,w=e[0].length;x<w;++x){var y=e[0][x];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:v=nt(" ",e[0][p][1][1]);break;case 1:v=nt("\r",e[0][p][1][1]);break;default:if(v="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}c=c+v,p=-1}o.push(c+EN[y[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Va(y[1][1],a,i),o.push(Ga(u,s));break;case"PtgRefN":u=r?Va(y[1][1],r,i):y[1][1],o.push(Ga(u,s));break;case"PtgRef3d":h=y[1][1],u=Va(y[1][2],a,i),g=Xp(n,h,i),o.push(g+"!"+Ga(u,s));break;case"PtgFunc":case"PtgFuncVar":var E=y[1][0],C=y[1][1];E||(E=0),E&=127;var R=E==0?[]:o.slice(-E);o.length-=E,C==="User"&&(C=R.shift()),o.push(C+"("+R.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":m=Pp(y[1][1],r?{s:r}:a,i),o.push(Ru(m,i));break;case"PtgArea":m=Pp(y[1][1],a,i),o.push(Ru(m,i));break;case"PtgArea3d":h=y[1][1],m=y[1][2],g=Xp(n,h,i),o.push(g+"!"+Ru(m,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=y[1][2];var D=(n.names||[])[d-1]||(n[0]||[])[d],F=D?D.Name:"SH33TJSNAME"+String(d);F&&F.slice(0,6)=="_xlfn."&&!i.xlfn&&(F=F.slice(6)),o.push(F);break;case"PtgNameX":var N=y[1][1];d=y[1][2];var P;if(i.biff<=5)N<0&&(N=-N),n[N]&&(P=n[N][d]);else{var W="";if(((n[N]||[])[0]||[])[0]==14849||(((n[N]||[])[0]||[])[0]==1025?n[N][d]&&n[N][d].itab>0&&(W=n.SheetNames[n[N][d].itab-1]+"!"):W=n.SheetNames[d-1]+"!"),n[N]&&n[N][d])W+=n[N][d].Name;else if(n[0]&&n[0][d])W+=n[0][d].Name;else{var G=(Ev(n,N,i)||"").split(";;");G[d-1]?W=G[d-1]:W+="SH33TJSERRX"}o.push(W);break}P||(P={Name:"SH33TJSERRY"}),o.push(P.Name);break;case"PtgParen":var Q="(",ve=")";if(p>=0){switch(v="",e[0][p][1][0]){case 2:Q=nt(" ",e[0][p][1][1])+Q;break;case 3:Q=nt("\r",e[0][p][1][1])+Q;break;case 4:ve=nt(" ",e[0][p][1][1])+ve;break;case 5:ve=nt("\r",e[0][p][1][1])+ve;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(Q+o.pop()+ve);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var ge={c:r.c,r:r.r};if(n.sharedf[$e(u)]){var Te=n.sharedf[$e(u)];o.push(Gs(Te,a,ge,n,i))}else{var Ee=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Gs(c[1],a,ge,n,i)),Ee=!0;break}Ee||o.push(y[1])}break;case"PtgArray":o.push("{"+TN(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var H=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&p>=0&&H.indexOf(e[0][x][0])==-1){y=e[0][p];var q=!0;switch(y[1][0]){case 4:q=!1;case 0:v=nt(" ",y[1][1]);break;case 5:q=!1;case 1:v=nt("\r",y[1][1]);break;default:if(v="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((q?v:"")+o.pop()+(q?"":v)),p=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function kN(e){if(e==null){var t=V(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return zi(e);return zi(0)}function CN(e,t,r,n,i){var s=Wi(t,r,i),a=kN(e.v),o=V(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=V(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var h=Ot([s,a,o,c]);return h}function Gc(e,t,r){var n=e.read_shift(4),i=_N(e,n,r),s=e.read_shift(4),a=s>0?wN(e,s,i,r):null;return[i,a]}var bN=Gc,Kc=Gc,NN=Gc,AN=Gc,DN={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Sv={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},ON={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function PN(e){var t="of:="+e.replace(vh,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function FN(e){return e.replace(/\./,"!")}var Ka=typeof Map<"u";function _h(e,t,r){var n=0,i=e.length;if(r){if(Ka?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Ka?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(Ka?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function Xc(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(En=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=pc(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Y0(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function kv(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function gi(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){wx(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function RN(e,t,r){if(e&&e["!ref"]){var n=Xe(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function jN(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+dt(e[r])+'"/>';return t+"</mergeCells>"}function IN(e,t,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=vo(Be(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+re("outlinePr",null,c)}!s&&!o||(i[i.length]=re("sheetPr",o,a))}var LN=["objects","scenarios","selectLockedCells","selectUnlockedCells"],MN=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function BN(e){var t={sheet:1};return LN.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),MN.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=lv(e.password).toString(16).toUpperCase()),re("sheetProtection",null,t)}function UN(e){return kv(e),re("pageMargins",null,e)}function $N(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=re("col",null,Xc(i,n)));return r[r.length]="</cols>",r.join("")}function HN(e,t,r,n){var i=typeof e.ref=="string"?e.ref:dt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=yr(i);a.s.r==a.e.r&&(a.e.r=yr(t["!ref"]).e.r,i=dt(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),re("autoFilter",null,{ref:i})}function zN(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),re("sheetViews",re("sheetView",null,i),{})}function WN(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,a=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Ro[e.v];break;case"d":n&&n.cellDates?i=Qt(e.v,-1).toISOString():(e=ur(e),e.t="n",i=""+(e.v=cr(Qt(e.v)))),typeof e.z>"u"&&(e.z=it[14]);break;default:i=e.v;break}var o=Pt("v",Be(i)),l={r:t},c=gi(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Pt("v",""+_h(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=a),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=re("f",Be(e.f),u)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),re("c",o,l)}function VN(e,t,r,n){var i=[],s=[],a=Xe(e["!ref"]),o="",l,c="",u=[],h=0,d=0,m=e["!rows"],g=Array.isArray(e),p={r:c},v,x=-1;for(d=a.s.c;d<=a.e.c;++d)u[d]=Ht(d);for(h=a.s.r;h<=a.e.r;++h){for(s=[],c=Rt(h),d=a.s.c;d<=a.e.c;++d){l=u[d]+c;var w=g?(e[h]||[])[d]:e[l];w!==void 0&&(o=WN(w,l,e,t))!=null&&s.push(o)}(s.length>0||m&&m[h])&&(p={r:c},m&&m[h]&&(v=m[h],v.hidden&&(p.hidden=1),x=-1,v.hpx?x=mc(v.hpx):v.hpt&&(x=v.hpt),x>-1&&(p.ht=x,p.customHeight=1),v.level&&(p.outlineLevel=v.level)),i[i.length]=re("row",s.join(""),p))}if(m)for(;h<m.length;++h)m&&m[h]&&(p={r:h+1},v=m[h],v.hidden&&(p.hidden=1),x=-1,v.hpx?x=mc(v.hpx):v.hpt&&(x=v.hpt),x>-1&&(p.ht=x,p.customHeight=1),v.level&&(p.outlineLevel=v.level),i[i.length]=re("row","",p));return i.join("")}function Cv(e,t,r,n){var i=[mt,re("worksheet",null,{xmlns:Zs[0],"xmlns:r":_t.r})],s=r.SheetNames[e],a=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",u=Xe(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=dt(u)}n||(n={}),l["!comments"]=[];var h=[];IN(l,r,e,t,i),i[i.length]=re("dimension",null,{ref:c}),i[i.length]=zN(l,t,e,r),t.sheetFormat&&(i[i.length]=re("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=$N(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=VN(l,t),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=BN(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=HN(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=jN(l["!merges"]));var d=-1,m,g=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(p){p[1].Target&&(m={ref:p[0]},p[1].Target.charAt(0)!="#"&&(g=Me(n,-1,Be(p[1].Target).replace(/#.*$/,""),Pe.HLINK),m["r:id"]="rId"+g),(d=p[1].Target.indexOf("#"))>-1&&(m.location=Be(p[1].Target.slice(d+1))),p[1].Tooltip&&(m.tooltip=Be(p[1].Tooltip)),i[i.length]=re("hyperlink",null,m))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=UN(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=Pt("ignoredErrors",re("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(g=Me(n,-1,"../drawings/drawing"+(e+1)+".xml",Pe.DRAW),i[i.length]=re("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=h),l["!comments"].length>0&&(g=Me(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Pe.VML),i[i.length]=re("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function GN(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function KN(e,t,r){var n=V(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=mc(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var h=-1,d=-1,m=u<<10;m<u+1<<10;++m){c.c=m;var g=Array.isArray(r)?(r[c.r]||[])[c.c]:r[$e(c)];g&&(h<0&&(h=m),d=m)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,d))}var p=n.l;return n.l=l,n.write_shift(4,o),n.l=p,n.length>n.l?n.slice(0,n.l):n}function XN(e,t,r,n){var i=KN(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&Y(e,0,i)}var YN=Ji,qN=ta;function QN(){}function JN(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=l3(e),r}function ZN(e,t,r){r==null&&(r=V(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return fc({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),$x(e,r),r.slice(0,r.l)}function eA(e){var t=Pr(e);return[t]}function tA(e,t,r){return r==null&&(r=V(8)),Yi(t,r)}function rA(e){var t=qi(e);return[t]}function nA(e,t,r){return r==null&&(r=V(4)),Qi(t,r)}function iA(e){var t=Pr(e),r=e.read_shift(1);return[t,r,"b"]}function sA(e,t,r){return r==null&&(r=V(9)),Yi(t,r),r.write_shift(1,e.v?1:0),r}function aA(e){var t=qi(e),r=e.read_shift(1);return[t,r,"b"]}function oA(e,t,r){return r==null&&(r=V(5)),Qi(t,r),r.write_shift(1,e.v?1:0),r}function lA(e){var t=Pr(e),r=e.read_shift(1);return[t,r,"e"]}function cA(e,t,r){return r==null&&(r=V(9)),Yi(t,r),r.write_shift(1,e.v),r}function uA(e){var t=qi(e),r=e.read_shift(1);return[t,r,"e"]}function fA(e,t,r){return r==null&&(r=V(8)),Qi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function hA(e){var t=Pr(e),r=e.read_shift(4);return[t,r,"s"]}function dA(e,t,r){return r==null&&(r=V(12)),Yi(t,r),r.write_shift(4,t.v),r}function pA(e){var t=qi(e),r=e.read_shift(4);return[t,r,"s"]}function mA(e,t,r){return r==null&&(r=V(8)),Qi(t,r),r.write_shift(4,t.v),r}function gA(e){var t=Pr(e),r=ra(e);return[t,r,"n"]}function xA(e,t,r){return r==null&&(r=V(16)),Yi(t,r),zi(e.v,r),r}function vA(e){var t=qi(e),r=ra(e);return[t,r,"n"]}function yA(e,t,r){return r==null&&(r=V(12)),Qi(t,r),zi(e.v,r),r}function wA(e){var t=Pr(e),r=Hx(e);return[t,r,"n"]}function _A(e,t,r){return r==null&&(r=V(12)),Yi(t,r),zx(e.v,r),r}function TA(e){var t=qi(e),r=Hx(e);return[t,r,"n"]}function EA(e,t,r){return r==null&&(r=V(8)),Qi(t,r),zx(e.v,r),r}function SA(e){var t=Pr(e),r=dh(e);return[t,r,"is"]}function kA(e){var t=Pr(e),r=zt(e);return[t,r,"str"]}function CA(e,t,r){return r==null&&(r=V(12+4*e.v.length)),Yi(t,r),Et(e.v,r),r.length>r.l?r.slice(0,r.l):r}function bA(e){var t=qi(e),r=zt(e);return[t,r,"str"]}function NA(e,t,r){return r==null&&(r=V(8+4*e.v.length)),Qi(t,r),Et(e.v,r),r.length>r.l?r.slice(0,r.l):r}function AA(e,t,r){var n=e.l+t,i=Pr(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"b"];if(r.cellFormula){e.l+=2;var o=Kc(e,n-e.l,r);a[3]=Gs(o,null,i,r.supbooks,r)}else e.l=n;return a}function DA(e,t,r){var n=e.l+t,i=Pr(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"e"];if(r.cellFormula){e.l+=2;var o=Kc(e,n-e.l,r);a[3]=Gs(o,null,i,r.supbooks,r)}else e.l=n;return a}function OA(e,t,r){var n=e.l+t,i=Pr(e);i.r=r["!row"];var s=ra(e),a=[i,s,"n"];if(r.cellFormula){e.l+=2;var o=Kc(e,n-e.l,r);a[3]=Gs(o,null,i,r.supbooks,r)}else e.l=n;return a}function PA(e,t,r){var n=e.l+t,i=Pr(e);i.r=r["!row"];var s=zt(e),a=[i,s,"str"];if(r.cellFormula){e.l+=2;var o=Kc(e,n-e.l,r);a[3]=Gs(o,null,i,r.supbooks,r)}else e.l=n;return a}var FA=Ji,RA=ta;function jA(e,t){return t==null&&(t=V(4)),t.write_shift(4,e),t}function IA(e,t){var r=e.l+t,n=Ji(e),i=ph(e),s=zt(e),a=zt(e),o=zt(e);e.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function LA(e,t){var r=V(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ta({s:Tt(e[0]),e:Tt(e[0])},r),mh("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return Et(i||"",r),Et(e[1].Tooltip||"",r),Et("",r),r.slice(0,r.l)}function MA(){}function BA(e,t,r){var n=e.l+t,i=Wx(e),s=e.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=bN(e,n-e.l,r);a[1]=o}else e.l=n;return a}function UA(e,t,r){var n=e.l+t,i=Ji(e),s=[i];if(r.cellFormula){var a=AN(e,n-e.l,r);s[1]=a,e.l=n}else e.l=n;return s}function $A(e,t,r){r==null&&(r=V(18));var n=Xc(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var bv=["left","right","top","bottom","header","footer"];function HA(e){var t={};return bv.forEach(function(r){t[r]=ra(e)}),t}function zA(e,t){return t==null&&(t=V(6*8)),kv(e),bv.forEach(function(r){zi(e[r],t)}),t}function WA(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function VA(e,t,r){r==null&&(r=V(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function GA(e){var t=V(24);return t.write_shift(4,4),t.write_shift(4,1),ta(e,t),t}function KA(e,t){return t==null&&(t=V(16*4+2)),t.write_shift(2,e.password?lv(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function XA(){}function YA(){}function qA(e,t,r,n,i,s,a){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=ur(t),t.z=t.z||it[14],t.v=cr(Qt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=gi(i.cellXfs,t,i),t.l&&s["!links"].push([$e(l),t.l]),t.c&&s["!comments"].push([$e(l),t.c]),t.t){case"s":case"str":return i.bookSST?(o=_h(i.Strings,t.v,i.revStrings),l.t="s",l.v=o,a?Y(e,18,mA(t,l)):Y(e,7,dA(t,l))):(l.t="str",a?Y(e,17,NA(t,l)):Y(e,6,CA(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?Y(e,13,EA(t,l)):Y(e,2,_A(t,l)):a?Y(e,16,yA(t,l)):Y(e,5,xA(t,l)),!0;case"b":return l.t="b",a?Y(e,15,oA(t,l)):Y(e,4,sA(t,l)),!0;case"e":return l.t="e",a?Y(e,14,fA(t,l)):Y(e,3,cA(t,l)),!0}return a?Y(e,12,nA(t,l)):Y(e,1,tA(t,l)),!0}function QA(e,t,r,n){var i=Xe(t["!ref"]||"A1"),s,a="",o=[];Y(e,145);var l=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var u=i.s.r;u<=c;++u){a=Rt(u),XN(e,t,i,u);var h=!1;if(u<=i.e.r)for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(o[d]=Ht(d)),s=o[d]+a;var m=l?(t[u]||[])[d]:t[s];if(!m){h=!1;continue}h=qA(e,m,u,d,n,t,h)}}Y(e,146)}function JA(e,t){!t||!t["!merges"]||(Y(e,177,jA(t["!merges"].length)),t["!merges"].forEach(function(r){Y(e,176,RA(r))}),Y(e,178))}function ZA(e,t){!t||!t["!cols"]||(Y(e,390),t["!cols"].forEach(function(r,n){r&&Y(e,60,$A(n,r))}),Y(e,391))}function e6(e,t){!t||!t["!ref"]||(Y(e,648),Y(e,649,GA(Xe(t["!ref"]))),Y(e,650))}function t6(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=Me(r,-1,n[1].Target.replace(/#.*$/,""),Pe.HLINK);Y(e,494,LA(n,i))}}),delete t["!links"]}function r6(e,t,r,n){if(t["!comments"].length>0){var i=Me(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Pe.VML);Y(e,551,mh("rId"+i)),t["!legacy"]=i}}function n6(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:dt(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=yr(s);o.s.r==o.e.r&&(o.e.r=yr(t["!ref"]).e.r,s=dt(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Y(e,161,ta(Xe(s))),Y(e,162)}}function i6(e,t,r){Y(e,133),Y(e,137,VA(t,r)),Y(e,138),Y(e,134)}function s6(e,t){t["!protect"]&&Y(e,535,KA(t["!protect"]))}function a6(e,t,r,n){var i=lr(),s=r.SheetNames[e],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=Xe(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Y(i,129),(r.vbaraw||a["!outline"])&&Y(i,147,ZN(o,a["!outline"])),Y(i,148,qN(l)),i6(i,a,r.Workbook),ZA(i,a),QA(i,a,e,t),s6(i,a),n6(i,a,r,e),JA(i,a),t6(i,a,n),a["!margins"]&&Y(i,476,zA(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&e6(i,a),r6(i,a,e,n),Y(i,130),i.end()}function o6(e,t){e.l+=10;var r=zt(e);return{name:r}}var l6=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function c6(e){return!e.Workbook||!e.Workbook.WBProps?"false":U4(e.Workbook.WBProps.date1904)?"true":"false"}var u6="][*?/\\".split("");function Nv(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return u6.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function f6(e,t,r){e.forEach(function(n,i){Nv(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=t&&t[i]&&t[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function h6(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];f6(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)RN(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function Av(e){var t=[mt];t[t.length]=re("workbook",null,{xmlns:Zs[0],"xmlns:r":_t.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(l6.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=re("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var a={name:Be(e.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=re("sheet",null,a)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=re("definedName",Be(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function d6(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=X0(e),r.name=zt(e),r}function p6(e,t){return t||(t=V(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),mh(e.strRelID,t),Et(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function m6(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?zt(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function g6(e,t){t||(t=V(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),$x(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function x6(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=c3(e),a=NN(e,0,r),o=ph(e);e.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function v6(e,t){Y(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Y(e,156,p6(i))}Y(e,144)}function y6(e,t){t||(t=V(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Et("SheetJS",t),Et(ic.version,t),Et(ic.version,t),Et("7262",t),t.length>t.l?t.slice(0,t.l):t}function w6(e,t){t||(t=V(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function _6(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(Y(e,135),Y(e,158,w6(i)),Y(e,136))}}function T6(e,t){var r=lr();return Y(r,131),Y(r,128,y6()),Y(r,153,g6(e.Workbook&&e.Workbook.WBProps||null)),_6(r,e),v6(r,e),Y(r,132),r.end()}function E6(e,t,r){return(t.slice(-4)===".bin"?T6:Av)(e)}function S6(e,t,r,n,i){return(t.slice(-4)===".bin"?a6:Cv)(e,r,n,i)}function k6(e,t,r){return(t.slice(-4)===".bin"?zC:fv)(e,r)}function C6(e,t,r){return(t.slice(-4)===".bin"?gC:ov)(e,r)}function b6(e,t,r){return(t.slice(-4)===".bin"?sb:gv)(e)}function N6(e){return(e.slice(-4)===".bin"?QC:pv)()}function A6(e,t){var r=[];return e.Props&&r.push(k3(e.Props,t)),e.Custprops&&r.push(C3(e.Props,e.Custprops)),r.join("")}function D6(){return""}function O6(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(re("NumberFormat",null,{"ss:Format":Be(it[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(re("Style",s.join(""),a))}),re("Styles",r.join(""))}function Dv(e){return re("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+yh(e.Ref,{r:0,c:0})})}function P6(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(Dv(i)))}return re("Names",r.join(""))}function F6(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(Dv(o)))}return s.join("")}function R6(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(re("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(re("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(re("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(re("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(Pt("ProtectContents","True")),e["!protect"].objects&&i.push(Pt("ProtectObjects","True")),e["!protect"].scenarios&&i.push(Pt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(Pt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(Pt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){e["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":re("WorksheetOptions",i.join(""),{xmlns:pr.x})}function j6(e){return e.map(function(t){var r=B4(t.t||""),n=re("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return re("Comment",n,{"ss:Author":t.a})}).join("")}function I6(e,t,r,n,i,s,a){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Be(yh(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var l=Tt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Be(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Be(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=a.c||c[u].s.r!=a.r||(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",d="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",d=String(e.v);break;case"b":h="Boolean",d=e.v?"1":"0";break;case"e":h="Error",d=Ro[e.v];break;case"d":h="DateTime",d=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||it[14]);break;case"s":h="String",d=M4(e.v||"");break}var m=gi(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=a.c+1;var g=e.v!=null?d:"",p=e.t=="z"?"":'<Data ss:Type="'+h+'">'+g+"</Data>";return(e.c||[]).length>0&&(p+=j6(e.c)),re("Cell",p,o)}function L6(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=uv(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function M6(e,t,r,n){if(!e["!ref"])return"";var i=Xe(e["!ref"]),s=e["!merges"]||[],a=0,o=[];e["!cols"]&&e["!cols"].forEach(function(v,x){xh(v);var w=!!v.width,y=Xc(x,v),E={"ss:Index":x+1};w&&(E["ss:Width"]=dc(y.width)),v.hidden&&(E["ss:Hidden"]="1"),o.push(re("Column",null,E))});for(var l=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var u=[L6(c,(e["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var d=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>h)&&!(s[a].s.r>c)&&!(s[a].e.c<h)&&!(s[a].e.r<c)){(s[a].s.c!=h||s[a].s.r!=c)&&(d=!0);break}if(!d){var m={r:c,c:h},g=$e(m),p=l?(e[c]||[])[h]:e[g];u.push(I6(p,g,e,t,r,n,m))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function B6(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],a=s?F6(s,t,e,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?M6(s,t,e,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(R6(s,t,e,r)),n.join("")}function U6(e,t){t||(t={}),e.SSF||(e.SSF=ur(it)),e.SSF&&(zc(),Hc(e.SSF),t.revssf=Wc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],gi(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(A6(e,t)),r.push(D6()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(re("Worksheet",B6(n,t,e),{"ss:Name":Be(e.SheetNames[n])}));return r[2]=O6(e,t),r[3]=P6(e),mt+re("Workbook",r.join(""),{xmlns:pr.ss,"xmlns:o":pr.o,"xmlns:x":pr.x,"xmlns:ss":pr.ss,"xmlns:dt":pr.dt,"xmlns:html":pr.html})}var Lu={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function $6(e,t){var r=[],n=[],i=[],s=0,a,o=_p(Rp,"n"),l=_p(jp,"n");if(e.Props)for(a=It(e.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],e.Props[a[s]]]);if(e.Custprops)for(a=It(e.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],e.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)ev.indexOf(i[s][0])>-1||Qx.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&He.utils.cfb_add(t,"/SummaryInformation",Up(n,Lu.SI,l,jp)),(r.length||c.length)&&He.utils.cfb_add(t,"/DocumentSummaryInformation",Up(r,Lu.DSI,o,Rp,c.length?c:null,Lu.UDI))}function H6(e,t){var r=t||{},n=He.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return He.utils.cfb_add(n,i,Ov(e,r)),r.biff==8&&(e.Props||e.Custprops)&&$6(e,n),r.biff==8&&e.vbaraw&&ab(n,He.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var z6={0:{f:GN},1:{f:eA},2:{f:wA},3:{f:lA},4:{f:iA},5:{f:gA},6:{f:kA},7:{f:hA},8:{f:PA},9:{f:OA},10:{f:AA},11:{f:DA},12:{f:rA},13:{f:TA},14:{f:uA},15:{f:aA},16:{f:vA},17:{f:bA},18:{f:pA},19:{f:dh},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:x6},40:{},42:{},43:{f:kC},44:{f:EC},45:{f:NC},46:{f:DC},47:{f:AC},48:{},49:{f:r3},50:{},51:{f:GC},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:nC},62:{f:SA},63:{f:JC},64:{f:XA},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:an,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:WA},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:JN},148:{f:YN,p:16},151:{f:MA},152:{},153:{f:m6},154:{},155:{},156:{f:d6},157:{},158:{},159:{T:1,f:dC},160:{T:-1},161:{T:1,f:Ji},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:FA},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:WC},336:{T:-1},337:{f:YC,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:X0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Q3},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:BA},427:{f:UA},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:HA},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:QN},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:IA},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:X0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:nb},633:{T:1},634:{T:-1},635:{T:1,f:tb},636:{T:-1},637:{f:a3},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:o6},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:YA},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ne(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&uh(r)&&e.push(r)}}function W6(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return ne(e,t,r,i);var s=t;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,s),u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<i;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function Io(e,t,r){return e||(e=V(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function V6(e,t,r,n){var i=V(9);return Io(i,e,t),rv(r,n||"b",i),i}function G6(e,t,r){var n=V(8+2*r.length);return Io(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function K6(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?cr(Qt(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?ne(e,2,oC(r,n,i)):ne(e,3,aC(r,n,i));return;case"b":case"e":ne(e,5,V6(r,n,t.v,t.t));return;case"s":case"str":ne(e,4,G6(r,n,(t.v||"").slice(0,255)));return}ne(e,1,Io(null,r,n))}function X6(e,t,r,n){var i=Array.isArray(t),s=Xe(t["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=dt(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Rt(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=Ht(u)),a=l[u]+o;var h=i?(t[c]||[])[u]:t[a];h&&K6(e,h,c,u)}}}function Y6(e,t){for(var r=t||{},n=lr(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ne(n,r.biff==4?1033:r.biff==3?521:9,gh(e,16,r)),X6(n,e.Sheets[e.SheetNames[i]],i,r),ne(n,10),n.end()}function q6(e,t,r){ne(e,49,z3({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function Q6(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&ne(e,1054,G3(i,t[i],r))})}function J6(e,t){var r=V(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ne(e,2151,r),r=V(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),sv(Xe(t["!ref"]||"A1"),r),r.write_shift(4,4),ne(e,2152,r)}function Z6(e,t){for(var r=0;r<16;++r)ne(e,224,Hp({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ne(e,224,Hp(n,0,t))})}function eD(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ne(e,440,eC(n)),n[1].Tooltip&&ne(e,2048,tC(n))}delete t["!links"]}function tD(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&ne(e,125,iC(Xc(i,n),i))})}}function rD(e,t,r,n,i){var s=16+gi(i.cellXfs,t,i);if(t.v==null&&!t.bf){ne(e,513,Wi(r,n,s));return}if(t.bf)ne(e,6,CN(t,r,n,i,s));else switch(t.t){case"d":case"n":var a=t.t=="d"?cr(Qt(t.v)):t.v;ne(e,515,q3(r,n,a,s));break;case"b":case"e":ne(e,517,Y3(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var o=_h(i.Strings,t.v,i.revStrings);ne(e,253,W3(r,n,o,s))}else ne(e,516,V3(r,n,(t.v||"").slice(0,255),s,i));break;default:ne(e,513,Wi(r,n,s))}}function nD(e,t,r){var n=lr(),i=r.SheetNames[e],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[e]||{},l=Array.isArray(s),c=t.biff==8,u,h="",d=[],m=Xe(s["!ref"]||"A1"),g=c?65536:16384;if(m.e.c>255||m.e.r>=g){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,g-1)}ne(n,2057,gh(r,16,t)),ne(n,13,kr(1)),ne(n,12,kr(100)),ne(n,15,Xt(!0)),ne(n,17,Xt(!1)),ne(n,16,zi(.001)),ne(n,95,Xt(!0)),ne(n,42,Xt(!1)),ne(n,43,Xt(!1)),ne(n,130,kr(1)),ne(n,128,X3()),ne(n,131,Xt(!1)),ne(n,132,Xt(!1)),c&&tD(n,s["!cols"]),ne(n,512,K3(m,t)),c&&(s["!links"]=[]);for(var p=m.s.r;p<=m.e.r;++p){h=Rt(p);for(var v=m.s.c;v<=m.e.c;++v){p===m.s.r&&(d[v]=Ht(v)),u=d[v]+h;var x=l?(s[p]||[])[v]:s[u];x&&(rD(n,x,p,v,t),c&&x.l&&s["!links"].push([u,x.l]))}}var w=o.CodeName||o.name||i;return c&&ne(n,574,H3((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&ne(n,229,Z3(s["!merges"])),c&&eD(n,s),ne(n,442,iv(w)),c&&J6(n,s),ne(n,10),n.end()}function iD(e,t,r){var n=lr(),i=(e||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(ne(n,2057,gh(e,5,r)),r.bookType=="xla"&&ne(n,135),ne(n,225,o?kr(1200):null),ne(n,193,A3(2)),l&&ne(n,191),l&&ne(n,192),ne(n,226),ne(n,92,M3("SheetJS",r)),ne(n,66,kr(o?1200:1252)),o&&ne(n,353,kr(0)),o&&ne(n,448),ne(n,317,sC(e.SheetNames.length)),o&&e.vbaraw&&ne(n,211),o&&e.vbaraw){var c=a.CodeName||"ThisWorkbook";ne(n,442,iv(c))}ne(n,156,kr(17)),ne(n,25,Xt(!1)),ne(n,18,Xt(!1)),ne(n,19,kr(0)),o&&ne(n,431,Xt(!1)),o&&ne(n,444,kr(0)),ne(n,61,$3()),ne(n,64,Xt(!1)),ne(n,141,kr(0)),ne(n,34,Xt(c6(e)=="true")),ne(n,14,Xt(!0)),o&&ne(n,439,Xt(!1)),ne(n,218,kr(0)),q6(n,e,r),Q6(n,e.SSF,r),Z6(n,r),o&&ne(n,352,Xt(!1));var u=n.end(),h=lr();o&&ne(h,140,rC()),o&&r.Strings&&W6(h,252,U3(r.Strings)),ne(h,10);var d=h.end(),m=lr(),g=0,p=0;for(p=0;p<e.SheetNames.length;++p)g+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var v=u.length+g+d.length;for(p=0;p<e.SheetNames.length;++p){var x=s[p]||{};ne(m,133,B3({pos:v,hs:x.Hidden||0,dt:0,name:e.SheetNames[p]},r)),v+=t[p].length}var w=m.end();if(g!=w.length)throw new Error("BS8 "+g+" != "+w.length);var y=[];return u.length&&y.push(u),w.length&&y.push(w),d.length&&y.push(d),Ot(y)}function sD(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=ur(it)),e&&e.SSF&&(zc(),Hc(e.SSF),r.revssf=Wc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Th(r),r.cellXfs=[],gi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=nD(i,r,e);return n.unshift(iD(e,n,r)),Ot(n)}function Ov(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=yr(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return sD(e,t);case 4:case 3:case 2:return Y6(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function aD(e,t,r,n){for(var i=e["!merges"]||[],s=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var u=$e({r,c:a}),h=n.dense?(e[r]||[])[a]:e[u],d=h&&h.v!=null&&(h.h||L4(h.w||(Dn(h),h.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),m.id=(n.id||"sjs")+"-"+u,s.push(re("td",d,m))}}var g="<tr>";return g+s.join("")+"</tr>"}var oD='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',lD="</body></html>";function cD(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Pv(e,t){var r=t||{},n=r.header!=null?r.header:oD,i=r.footer!=null?r.footer:lD,s=[n],a=yr(e["!ref"]);r.dense=Array.isArray(e),s.push(cD(e,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(aD(e,a,o,r));return s.push("</table>"+i),s.join("")}function Fv(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Tt(n.origin):n.origin;i=a.r,s=a.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var u=yr(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var h=[],d=0,m=e["!rows"]||(e["!rows"]=[]),g=0,p=0,v=0,x=0,w=0,y=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&p<l;++g){var E=o[g];if(Yp(E)){if(n.display)continue;m[p]={hidden:!0}}var C=E.children;for(v=x=0;v<C.length;++v){var R=C[v];if(!(n.display&&Yp(R))){var D=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):$4(R.innerHTML),F=R.getAttribute("data-z")||R.getAttribute("z");for(d=0;d<h.length;++d){var N=h[d];N.s.c==x+s&&N.s.r<p+i&&p+i<=N.e.r&&(x=N.e.c+1-s,d=-1)}y=+R.getAttribute("colspan")||1,((w=+R.getAttribute("rowspan")||1)>1||y>1)&&h.push({s:{r:p+i,c:x+s},e:{r:p+i+(w||1)-1,c:x+s+(y||1)-1}});var P={t:"s",v:D},W=R.getAttribute("data-t")||R.getAttribute("t")||"";D!=null&&(D.length==0?P.t=W||"z":n.raw||D.trim().length==0||W=="s"||(D==="TRUE"?P={t:"b",v:!0}:D==="FALSE"?P={t:"b",v:!1}:isNaN(Tn(D))?isNaN(xo(D).getDate())||(P={t:"d",v:Qt(D)},n.cellDates||(P={t:"n",v:cr(P.v)}),P.z=n.dateNF||it[14]):P={t:"n",v:Tn(D)})),P.z===void 0&&F!=null&&(P.z=F);var G="",Q=R.getElementsByTagName("A");if(Q&&Q.length)for(var ve=0;ve<Q.length&&!(Q[ve].hasAttribute("href")&&(G=Q[ve].getAttribute("href"),G.charAt(0)!="#"));++ve);G&&G.charAt(0)!="#"&&(P.l={Target:G}),n.dense?(e[p+i]||(e[p+i]=[]),e[p+i][x+s]=P):e[$e({c:x+s,r:p+i})]=P,c.e.c<x+s&&(c.e.c=x+s),x+=y}}++p}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,p-1+i),e["!ref"]=dt(c),p>=l&&(e["!fullref"]=dt((c.e.r=o.length-g+p-1+i,c))),e}function Rv(e,t){var r=t||{},n=r.dense?[]:{};return Fv(n,e,t)}function uD(e,t){return Xi(Rv(e,t),t)}function Yp(e){var t="",r=fD(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function fD(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var hD=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+yo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return mt+t}}(),qp=function(){var e=function(s){return Be(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+Be(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,u=0,h=yr(s["!ref"]||"A1"),d=s["!merges"]||[],m=0,g=Array.isArray(s);if(s["!cols"])for(u=0;u<=h.e.c;++u)l.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var p="",v=s["!rows"]||[];for(c=0;c<h.s.r;++c)p=v[c]?' table:style-name="ro'+v[c].ods+'"':"",l.push("        <table:table-row"+p+`></table:table-row>
`);for(;c<=h.e.r;++c){for(p=v[c]?' table:style-name="ro'+v[c].ods+'"':"",l.push("        <table:table-row"+p+`>
`),u=0;u<h.s.c;++u)l.push(t);for(;u<=h.e.c;++u){var x=!1,w={},y="";for(m=0;m!=d.length;++m)if(!(d[m].s.c>u)&&!(d[m].s.r>c)&&!(d[m].e.c<u)&&!(d[m].e.r<c)){(d[m].s.c!=u||d[m].s.r!=c)&&(x=!0),w["table:number-columns-spanned"]=d[m].e.c-d[m].s.c+1,w["table:number-rows-spanned"]=d[m].e.r-d[m].s.r+1;break}if(x){l.push(r);continue}var E=$e({r:c,c:u}),C=g?(s[c]||[])[u]:s[E];if(C&&C.f&&(w["table:formula"]=Be(PN(C.f)),C.F&&C.F.slice(0,E.length)==E)){var R=yr(C.F);w["table:number-matrix-columns-spanned"]=R.e.c-R.s.c+1,w["table:number-matrix-rows-spanned"]=R.e.r-R.s.r+1}if(!C){l.push(t);continue}switch(C.t){case"b":y=C.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=C.v?"true":"false";break;case"n":y=C.w||String(C.v||0),w["office:value-type"]="float",w["office:value"]=C.v||0;break;case"s":case"str":y=C.v==null?"":C.v,w["office:value-type"]="string";break;case"d":y=C.w||Qt(C.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=Qt(C.v).toISOString(),w["table:style-name"]="ce1";break;default:l.push(t);continue}var D=e(y);if(C.l&&C.l.Target){var F=C.l.Target;F=F.charAt(0)=="#"?"#"+FN(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),D=re("text:a",D,{"xlink:href":F.replace(/&/g,"&amp;")})}l.push("          "+re("table:table-cell",re("text:p",D,{}),w)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var h=c["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;xh(h),h.ods=o;var d=c["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var h=c["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[mt],c=yo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=yo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(Yx().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)l.push(n(a.Sheets[a.SheetNames[h]],a,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function jv(e,t){if(t.bookType=="fods")return qp(e,t);var r=ah(),n="",i=[],s=[];return n="mimetype",_e(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",_e(r,n,qp(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",_e(r,n,hD(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",_e(r,n,mt+Yx()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",_e(r,n,S3(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",_e(r,n,T3(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function gc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function dD(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):$r(vo(e))}function pD(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function fi(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function mD(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function wo(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Ie(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function js(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function gt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=wo(e,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:a=4,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=wo(e,r),o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function bt(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(Ie(n*8+i.type)),i.type==2&&t.push(Ie(i.data.length)),t.push(i.data))})}),fi(t)}function Rr(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=wo(e,n),s=gt(e.slice(n[0],n[0]+i));n[0]+=i;var a={id:js(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=gt(o.data),c=js(l[3][0].data);a.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(a.merge=js(s[3][0].data)>>>0>0),r.push(a)}return r}function ls(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Ie(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ie(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Ie(a.data.length)}],n[2].push({data:bt(a.meta),type:2})});var s=bt(n);t.push(Ie(s.length)),t.push(s),i.forEach(function(a){return t.push(a)})}),fi(t)}function gD(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=wo(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[r[0]],o>1&&(a|=t[r[0]+1]<<8),o>2&&(a|=t[r[0]+2]<<16),o>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[fi(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=fi(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function jr(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(gD(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return fi(t)}function cs(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=Ie(n),a=s.length;t.push(s),n<=60?(a++,t.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return fi(t)}function Mu(e,t){var r=new Uint8Array(32),n=gc(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,mD(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Bu(e,t){var r=new Uint8Array(32),n=gc(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function In(e){var t=gt(e);return wo(t[1][0].data)}function xD(e,t,r){var n,i,s,a;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=e[8])==null?void 0:s[0])==null?void 0:a.data)&&js(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=gc(e[7][0].data),u=0,h=[],d=gc(e[4][0].data),m=0,g=[],p=0;p<t.length;++p){if(t[p]==null){c.setUint16(p*2,65535,!0),d.setUint16(p*2,65535);continue}c.setUint16(p*2,u,!0),d.setUint16(p*2,m,!0);var v,x;switch(typeof t[p]){case"string":v=Mu({t:"s",v:t[p]},r),x=Bu({t:"s",v:t[p]},r);break;case"number":v=Mu({t:"n",v:t[p]},r),x=Bu({t:"n",v:t[p]},r);break;case"boolean":v=Mu({t:"b",v:t[p]},r),x=Bu({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}h.push(v),u+=v.length,g.push(x),m+=x.length,++l}for(e[2][0].data=Ie(l);p<e[7][0].data.length/2;++p)c.setUint16(p*2,65535,!0),d.setUint16(p*2,65535,!0);return e[6][0].data=fi(h),e[3][0].data=fi(g),l}function vD(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=yr(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(dt(n)));var s=xc(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(L){return L.forEach(function(j){typeof j=="string"&&a.push(j)})});var o={},l=[],c=He.read(t.numbers,{type:"base64"});c.FileIndex.map(function(L,j){return[L,c.FullPaths[j]]}).forEach(function(L){var j=L[0],I=L[1];if(j.type==2&&j.name.match(/\.iwa/)){var X=j.content,ce=jr(X),me=Rr(ce);me.forEach(function(de){l.push(de.id),o[de.id]={deps:[],location:I,type:js(de.messages[0].meta[1][0].data)}})}}),l.sort(function(L,j){return L-j});var u=l.filter(function(L){return L>1}).map(function(L){return[L,Ie(L)]});c.FileIndex.map(function(L,j){return[L,c.FullPaths[j]]}).forEach(function(L){var j=L[0];if(L[1],!!j.name.match(/\.iwa/)){var I=Rr(jr(j.content));I.forEach(function(X){X.messages.forEach(function(ce){u.forEach(function(me){X.messages.some(function(de){return js(de.meta[1][0].data)!=11006&&pD(de.data,me[1])})&&o[me[0]].deps.push(X.id)})})})}});for(var h=He.find(c,o[1].location),d=Rr(jr(h.content)),m,g=0;g<d.length;++g){var p=d[g];p.id==1&&(m=p)}var v=In(gt(m.messages[0].data)[1][0].data);for(h=He.find(c,o[v].location),d=Rr(jr(h.content)),g=0;g<d.length;++g)p=d[g],p.id==v&&(m=p);for(v=In(gt(m.messages[0].data)[2][0].data),h=He.find(c,o[v].location),d=Rr(jr(h.content)),g=0;g<d.length;++g)p=d[g],p.id==v&&(m=p);for(v=In(gt(m.messages[0].data)[2][0].data),h=He.find(c,o[v].location),d=Rr(jr(h.content)),g=0;g<d.length;++g)p=d[g],p.id==v&&(m=p);var x=gt(m.messages[0].data);{x[6][0].data=Ie(n.e.r+1),x[7][0].data=Ie(n.e.c+1);var w=In(x[46][0].data),y=He.find(c,o[w].location),E=Rr(jr(y.content));{for(var C=0;C<E.length&&E[C].id!=w;++C);if(E[C].id!=w)throw"Bad ColumnRowUIDMapArchive";var R=gt(E[C].messages[0].data);R[1]=[],R[2]=[],R[3]=[];for(var D=0;D<=n.e.c;++D){var F=[];F[1]=F[2]=[{type:0,data:Ie(D+420690)}],R[1].push({type:2,data:bt(F)}),R[2].push({type:0,data:Ie(D)}),R[3].push({type:0,data:Ie(D)})}R[4]=[],R[5]=[],R[6]=[];for(var N=0;N<=n.e.r;++N)F=[],F[1]=F[2]=[{type:0,data:Ie(N+726270)}],R[4].push({type:2,data:bt(F)}),R[5].push({type:0,data:Ie(N)}),R[6].push({type:0,data:Ie(N)});E[C].messages[0].data=bt(R)}y.content=cs(ls(E)),y.size=y.content.length,delete x[46];var P=gt(x[4][0].data);{P[7][0].data=Ie(n.e.r+1);var W=gt(P[1][0].data),G=In(W[2][0].data);y=He.find(c,o[G].location),E=Rr(jr(y.content));{if(E[0].id!=G)throw"Bad HeaderStorageBucket";var Q=gt(E[0].messages[0].data);for(N=0;N<s.length;++N){var ve=gt(Q[2][0].data);ve[1][0].data=Ie(N),ve[4][0].data=Ie(s[N].length),Q[2][N]={type:Q[2][0].type,data:bt(ve)}}E[0].messages[0].data=bt(Q)}y.content=cs(ls(E)),y.size=y.content.length;var ge=In(P[2][0].data);y=He.find(c,o[ge].location),E=Rr(jr(y.content));{if(E[0].id!=ge)throw"Bad HeaderStorageBucket";for(Q=gt(E[0].messages[0].data),D=0;D<=n.e.c;++D)ve=gt(Q[2][0].data),ve[1][0].data=Ie(D),ve[4][0].data=Ie(n.e.r+1),Q[2][D]={type:Q[2][0].type,data:bt(ve)};E[0].messages[0].data=bt(Q)}y.content=cs(ls(E)),y.size=y.content.length;var Te=In(P[4][0].data);(function(){for(var L=He.find(c,o[Te].location),j=Rr(jr(L.content)),I,X=0;X<j.length;++X){var ce=j[X];ce.id==Te&&(I=ce)}var me=gt(I.messages[0].data);{me[3]=[];var de=[];a.forEach(function(ke,at){de[1]=[{type:0,data:Ie(at)}],de[2]=[{type:0,data:Ie(1)}],de[3]=[{type:2,data:dD(ke)}],me[3].push({type:2,data:bt(de)})})}I.messages[0].data=bt(me);var ae=ls(j),je=cs(ae);L.content=je,L.size=L.content.length})();var Ee=gt(P[3][0].data);{var H=Ee[1][0];delete Ee[2];var q=gt(H.data);{var ie=In(q[2][0].data);(function(){for(var L=He.find(c,o[ie].location),j=Rr(jr(L.content)),I,X=0;X<j.length;++X){var ce=j[X];ce.id==ie&&(I=ce)}var me=gt(I.messages[0].data);{delete me[6],delete Ee[7];var de=new Uint8Array(me[5][0].data);me[5]=[];for(var ae=0,je=0;je<=n.e.r;++je){var ke=gt(de);ae+=xD(ke,s[je],a),ke[1][0].data=Ie(je),me[5].push({data:bt(ke),type:2})}me[1]=[{type:0,data:Ie(n.e.c+1)}],me[2]=[{type:0,data:Ie(n.e.r+1)}],me[3]=[{type:0,data:Ie(ae)}],me[4]=[{type:0,data:Ie(n.e.r+1)}]}I.messages[0].data=bt(me);var at=ls(j),Ae=cs(at);L.content=Ae,L.size=L.content.length})()}H.data=bt(q)}P[3][0].data=bt(Ee)}x[4][0].data=bt(P)}m.messages[0].data=bt(x);var pe=ls(d),O=cs(pe);return h.content=O,h.size=h.content.length,c}function yD(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Th(e){yD([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function wD(e,t){return t.bookType=="ods"?jv(e,t):t.bookType=="numbers"?vD(e,t):t.bookType=="xlsb"?_D(e,t):TD(e,t)}function _D(e,t){Ss=1024,e&&!e.SSF&&(e.SSF=ur(it)),e&&e.SSF&&(zc(),Hc(e.SSF),t.revssf=Wc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ka?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=xv.indexOf(t.bookType)>-1,i=Gx();Th(t=t||{});var s=ah(),a="",o=0;if(t.cellXfs=[],gi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",_e(s,a,qx(e.Props,t)),i.coreprops.push(a),Me(t.rels,2,a,Pe.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,_e(s,a,Jx(e.Props)),i.extprops.push(a),Me(t.rels,3,a,Pe.EXT_PROPS),e.Custprops!==e.Props&&It(e.Custprops||{}).length>0&&(a="docProps/custom.xml",_e(s,a,Zx(e.Custprops)),i.custprops.push(a),Me(t.rels,4,a,Pe.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,_e(s,a,S6(o-1,a,t,e,u)),i.sheets.push(a),Me(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Pe.WS[0])}if(h){var m=h["!comments"],g=!1,p="";m&&m.length>0&&(p="xl/comments"+o+"."+r,_e(s,p,b6(m,p)),i.comments.push(p),Me(u,-1,"../comments"+o+"."+r,Pe.CMNT),g=!0),h["!legacy"]&&g&&_e(s,"xl/drawings/vmlDrawing"+o+".vml",mv(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&_e(s,Xx(a),Fs(u))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,_e(s,a,C6(t.Strings,a,t)),i.strs.push(a),Me(t.wbrels,-1,"sharedStrings."+r,Pe.SST)),a="xl/workbook."+r,_e(s,a,E6(e,a)),i.workbooks.push(a),Me(t.rels,1,a,Pe.WB),a="xl/theme/theme1.xml",_e(s,a,dv(e.Themes,t)),i.themes.push(a),Me(t.wbrels,-1,"theme/theme1.xml",Pe.THEME),a="xl/styles."+r,_e(s,a,k6(e,a,t)),i.styles.push(a),Me(t.wbrels,-1,"styles."+r,Pe.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",_e(s,a,e.vbaraw),i.vba.push(a),Me(t.wbrels,-1,"vbaProject.bin",Pe.VBA)),a="xl/metadata."+r,_e(s,a,N6(a)),i.metadata.push(a),Me(t.wbrels,-1,"metadata."+r,Pe.XLMETA),_e(s,"[Content_Types].xml",Kx(i,t)),_e(s,"_rels/.rels",Fs(t.rels)),_e(s,"xl/_rels/workbook."+r+".rels",Fs(t.wbrels)),delete t.revssf,delete t.ssf,s}function TD(e,t){Ss=1024,e&&!e.SSF&&(e.SSF=ur(it)),e&&e.SSF&&(zc(),Hc(e.SSF),t.revssf=Wc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ka?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=xv.indexOf(t.bookType)>-1,i=Gx();Th(t=t||{});var s=ah(),a="",o=0;if(t.cellXfs=[],gi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",_e(s,a,qx(e.Props,t)),i.coreprops.push(a),Me(t.rels,2,a,Pe.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,_e(s,a,Jx(e.Props)),i.extprops.push(a),Me(t.rels,3,a,Pe.EXT_PROPS),e.Custprops!==e.Props&&It(e.Custprops||{}).length>0&&(a="docProps/custom.xml",_e(s,a,Zx(e.Custprops)),i.custprops.push(a),Me(t.rels,4,a,Pe.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],m=(d||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,_e(s,a,Cv(o-1,t,e,h)),i.sheets.push(a),Me(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Pe.WS[0])}if(d){var g=d["!comments"],p=!1,v="";if(g&&g.length>0){var x=!1;g.forEach(function(w){w[1].forEach(function(y){y.T==!0&&(x=!0)})}),x&&(v="xl/threadedComments/threadedComment"+o+"."+r,_e(s,v,ZC(g,u,t)),i.threadedcomments.push(v),Me(h,-1,"../threadedComments/threadedComment"+o+"."+r,Pe.TCMNT)),v="xl/comments"+o+"."+r,_e(s,v,gv(g)),i.comments.push(v),Me(h,-1,"../comments"+o+"."+r,Pe.CMNT),p=!0}d["!legacy"]&&p&&_e(s,"xl/drawings/vmlDrawing"+o+".vml",mv(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&_e(s,Xx(a),Fs(h))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,_e(s,a,ov(t.Strings,t)),i.strs.push(a),Me(t.wbrels,-1,"sharedStrings."+r,Pe.SST)),a="xl/workbook."+r,_e(s,a,Av(e)),i.workbooks.push(a),Me(t.rels,1,a,Pe.WB),a="xl/theme/theme1.xml",_e(s,a,dv(e.Themes,t)),i.themes.push(a),Me(t.wbrels,-1,"theme/theme1.xml",Pe.THEME),a="xl/styles."+r,_e(s,a,fv(e,t)),i.styles.push(a),Me(t.wbrels,-1,"styles."+r,Pe.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",_e(s,a,e.vbaraw),i.vba.push(a),Me(t.wbrels,-1,"vbaProject.bin",Pe.VBA)),a="xl/metadata."+r,_e(s,a,pv()),i.metadata.push(a),Me(t.wbrels,-1,"metadata."+r,Pe.XLMETA),u.length>1&&(a="xl/persons/person.xml",_e(s,a,eb(u)),i.people.push(a),Me(t.wbrels,-1,"persons/person.xml",Pe.PEOPLE)),_e(s,"[Content_Types].xml",Kx(i,t)),_e(s,"_rels/.rels",Fs(t.rels)),_e(s,"xl/_rels/workbook."+r+".rels",Fs(t.wbrels)),delete t.revssf,delete t.ssf,s}function ED(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=An(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Iv(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Po(t.file,He.write(e,{type:Fe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return He.write(e,t)}function SD(e,t){var r=ur(t||{}),n=wD(e,r);return kD(n,r)}function kD(e,t){var r={},n=Fe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?He.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array($c(i))}return t.password&&typeof encrypt_agile<"u"?Iv(encrypt_agile(i,t.password),t):t.type==="file"?Po(t.file,i):t.type=="string"?za(i):i}function CD(e,t){var r=t||{},n=H6(e,r);return Iv(n,r)}function Yr(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return go(vo(n));case"binary":return vo(n);case"string":return e;case"file":return Po(t.file,n,"utf8");case"buffer":return Fe?Pn(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Yr(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function bD(e,t){switch(t.type){case"base64":return go(e);case"binary":return e;case"string":return e;case"file":return Po(t.file,e,"binary");case"buffer":return Fe?Pn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function dl(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?go(r):t.type=="string"?za(r):r;case"file":return Po(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Lv(e,t){t4(),h6(e);var r=ur(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Lv(e,r);return r.type="array",$c(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Yr(U6(e,r),r);case"slk":case"sylk":return Yr(cC.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return Yr(Pv(e.Sheets[e.SheetNames[i]],r),r);case"txt":return bD(Mv(e.Sheets[e.SheetNames[i]],r),r);case"csv":return Yr(Eh(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return Yr(uC.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return dl(lC.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return Yr(fC.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return Yr(vC.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return Yr(av.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return Yr(jv(e,r),r);case"wk1":return dl(zp.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return dl(zp.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),dl(Ov(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),CD(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return SD(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function ND(e,t,r,n,i,s,a,o){var l=Rt(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!a||e[r])for(var m=t.s.c;m<=t.e.c;++m){var g=a?e[r][m]:e[n[m]+l];if(g===void 0||g.t===void 0){if(c===void 0)continue;s[m]!=null&&(d[s[m]]=c);continue}var p=g.v;switch(g.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(s[m]!=null){if(p==null)if(g.t=="e"&&p===null)d[s[m]]=null;else if(c!==void 0)d[s[m]]=c;else if(u&&p===null)d[s[m]]=null;else continue;else d[s[m]]=u&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?p:Dn(g,p,o);p!=null&&(h=!1)}}return{row:d,isempty:h}}function xc(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Xe(u);break;case"number":l=Xe(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var h=Rt(l.s.r),d=[],m=[],g=0,p=0,v=Array.isArray(e),x=l.s.r,w=0,y={};v&&!e[x]&&(e[x]=[]);var E=c.skipHidden&&e["!cols"]||[],C=c.skipHidden&&e["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(E[w]||{}).hidden)switch(d[w]=Ht(w),r=v?e[x][w]:e[d[w]+h],n){case 1:s[w]=w-l.s.c;break;case 2:s[w]=d[w];break;case 3:s[w]=c.header[w-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Dn(r,null,c),p=y[a]||0,!p)y[a]=1;else{do o=a+"_"+p++;while(y[o]);y[a]=p,y[o]=1}s[w]=o}for(x=l.s.r+i;x<=l.e.r;++x)if(!(C[x]||{}).hidden){var R=ND(e,l,x,d,n,s,v,c);(R.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(m[g++]=R.row)}return m.length=g,m}var Qp=/"/g;function AD(e,t,r,n,i,s,a,o){for(var l=!0,c=[],u="",h=Rt(r),d=t.s.c;d<=t.e.c;++d)if(n[d]){var m=o.dense?(e[r]||[])[d]:e[n[d]+h];if(m==null)u="";else if(m.v!=null){l=!1,u=""+(o.rawNumbers&&m.t=="n"?m.v:Dn(m,null,o));for(var g=0,p=0;g!==u.length;++g)if((p=u.charCodeAt(g))===i||p===s||p===34||o.forceQuotes){u='"'+u.replace(Qp,'""')+'"';break}u=="ID"&&(u='"ID"')}else m.f!=null&&!m.F?(l=!1,u="="+m.f,u.indexOf(",")>=0&&(u='"'+u.replace(Qp,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(a)}function Eh(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=Xe(e["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",h=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],m=n.skipHidden&&e["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(d[g]||{}).hidden||(h[g]=Ht(g));for(var p=0,v=i.s.r;v<=i.e.r;++v)(m[v]||{}).hidden||(u=AD(e,i,v,h,a,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((p++?o:"")+u)));return delete n.dense,r.join("")}function Mv(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Eh(e,t);return r}function DD(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=Xe(e["!ref"]),s="",a=[],o,l=[],c=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)a[o]=Ht(o);for(var u=i.s.r;u<=i.e.r;++u)for(s=Rt(u),o=i.s.c;o<=i.e.c;++o)if(t=a[o]+s,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function Bv(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Tt(n.origin):n.origin;a=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:a+t.length-1+i}};if(s["!ref"]){var h=Xe(s["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),a==-1&&(a=h.e.r+1,u.e.r=a+t.length-1+i)}else a==-1&&(a=0,u.e.r=t.length-1+i);var d=n.header||[],m=0;t.forEach(function(p,v){It(p).forEach(function(x){(m=d.indexOf(x))==-1&&(d[m=d.length]=x);var w=p[x],y="z",E="",C=$e({c:o+m,r:a+v+i});c=_o(s,C),w&&typeof w=="object"&&!(w instanceof Date)?s[C]=w:(typeof w=="number"?y="n":typeof w=="boolean"?y="b":typeof w=="string"?y="s":w instanceof Date?(y="d",n.cellDates||(y="n",w=cr(w)),E=n.dateNF||it[14]):w===null&&n.nullError&&(y="e",w=0),c?(c.t=y,c.v=w,delete c.w,delete c.R,E&&(c.z=E)):s[C]=c={t:y,v:w},E&&(c.z=E))})}),u.e.c=Math.max(u.e.c,o+d.length-1);var g=Rt(a);if(i)for(m=0;m<d.length;++m)s[Ht(m+o)+g]={t:"s",v:d[m]};return s["!ref"]=dt(u),s}function OD(e,t){return Bv(null,e,t)}function _o(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Tt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?_o(e,$e(t)):_o(e,$e({r:t,c:r||0}))}function PD(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function FD(){return{SheetNames:[],Sheets:{}}}function RD(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=a+i)!=-1;++i);}if(Nv(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function jD(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=PD(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function ID(e,t){return e.z=t,e}function Uv(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function LD(e,t,r){return Uv(e,"#"+t,r)}function MD(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function BD(e,t,r,n){for(var i=typeof t!="string"?t:Xe(t),s=typeof t=="string"?t:dt(t),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=_o(e,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var Uu={encode_col:Ht,encode_row:Rt,encode_cell:$e,encode_range:dt,decode_col:hh,decode_row:fh,split_cell:t3,decode_cell:Tt,decode_range:yr,format_cell:Dn,sheet_add_aoa:Ux,sheet_add_json:Bv,sheet_add_dom:Fv,aoa_to_sheet:ea,json_to_sheet:OD,table_to_sheet:Rv,table_to_book:uD,sheet_to_csv:Eh,sheet_to_txt:Mv,sheet_to_json:xc,sheet_to_html:Pv,sheet_to_formulae:DD,sheet_to_row_object_array:xc,sheet_get_cell:_o,book_new:FD,book_append_sheet:RD,book_set_sheet_visibility:jD,cell_set_number_format:ID,cell_set_hyperlink:Uv,cell_set_internal_link:LD,cell_add_comment:MD,sheet_set_array_formula:BD,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},$v={exports:{}};(function(e,t){(function(r,n){n()})(Dt,function(){function r(c,u){return typeof u>"u"?u={autoBom:!1}:typeof u!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),u={autoBom:!u}),u.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function n(c,u,h){var d=new XMLHttpRequest;d.open("GET",c),d.responseType="blob",d.onload=function(){l(d.response,u,h)},d.onerror=function(){console.error("could not download file")},d.send()}function i(c){var u=new XMLHttpRequest;u.open("HEAD",c,!1);try{u.send()}catch{}return 200<=u.status&&299>=u.status}function s(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var u=document.createEvent("MouseEvents");u.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(u)}}var a=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Dt=="object"&&Dt.global===Dt?Dt:void 0,o=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=a.saveAs||(typeof window!="object"||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(c,u,h){var d=a.URL||a.webkitURL,m=document.createElement("a");u=u||c.name||"download",m.download=u,m.rel="noopener",typeof c=="string"?(m.href=c,m.origin===location.origin?s(m):i(m.href)?n(c,u,h):s(m,m.target="_blank")):(m.href=d.createObjectURL(c),setTimeout(function(){d.revokeObjectURL(m.href)},4e4),setTimeout(function(){s(m)},0))}:"msSaveOrOpenBlob"in navigator?function(c,u,h){if(u=u||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(r(c,h),u);else if(i(c))n(c,u,h);else{var d=document.createElement("a");d.href=c,d.target="_blank",setTimeout(function(){s(d)})}}:function(c,u,h,d){if(d=d||open("","_blank"),d&&(d.document.title=d.document.body.innerText="downloading..."),typeof c=="string")return n(c,u,h);var m=c.type==="application/octet-stream",g=/constructor/i.test(a.HTMLElement)||a.safari,p=/CriOS\/[\d]+/.test(navigator.userAgent);if((p||m&&g||o)&&typeof FileReader<"u"){var v=new FileReader;v.onloadend=function(){var y=v.result;y=p?y:y.replace(/^data:[^;]*;/,"data:attachment/file;"),d?d.location.href=y:location=y,d=null},v.readAsDataURL(c)}else{var x=a.URL||a.webkitURL,w=x.createObjectURL(c);d?d.location=w:location.href=w,d=null,setTimeout(function(){x.revokeObjectURL(w)},4e4)}});a.saveAs=l.saveAs=l,e.exports=l})})($v);var UD=$v.exports;const pl=(e,t,r)=>{if(!e||e.length===0){alert("Không có dữ liệu để xuất ra Excel.");return}const n=t.map(u=>u.label),i=e.map(u=>{const h={};return t.forEach(d=>{h[d.label]=u[d.key]}),h}),s=Uu.json_to_sheet(i,{header:n}),a=t.map(u=>({wch:Math.max(u.label.length,...i.map(h=>h[u.label]?String(h[u.label]).length:0))+2}));s["!cols"]=a;const o=Uu.book_new();Uu.book_append_sheet(o,s,"Báo cáo");const l=Lv(o,{bookType:"xlsx",type:"array"}),c=new Blob([l],{type:"application/octet-stream"});UD.saveAs(c,`${r}.xlsx`)},$D=e=>{const t=[],r=[{key:"caseName",label:"Tên Vụ án"},{key:"stage",label:"Giai đoạn"},{key:"investigationRemaining",label:"Thời hạn ĐT còn lại"},{key:"prosecutor",label:"KSV"},{key:"defendantName",label:"Tên Bị can"},{key:"defendantCharges",label:"Tội danh Bị can"},{key:"preventiveMeasure",label:"Biện pháp Ngăn chặn"},{key:"detentionDeadline",label:"Thời hạn Tạm giam"},{key:"caseNotes",label:"Ghi chú Vụ án"}];return e.forEach(n=>{n.defendants&&n.defendants.length>0?n.defendants.forEach((i,s)=>{const a={};s===0?(a.caseName=n.name,a.stage=n.stage,a.investigationRemaining=`${Gn(n.investigationDeadline)} ngày`,a.prosecutor=n.prosecutor,a.caseNotes=n.notes||""):(a.caseName="",a.stage="",a.investigationRemaining="",a.prosecutor="",a.caseNotes=""),a.defendantName=i.name,a.defendantCharges=i.charges,a.preventiveMeasure=i.preventiveMeasure,a.detentionDeadline=i.detentionDeadline||"",t.push(a)}):t.push({caseName:n.name,stage:n.stage,investigationRemaining:`${Gn(n.investigationDeadline)} ngày`,prosecutor:n.prosecutor,caseNotes:n.notes||"",defendantName:"Không có bị can",defendantCharges:"",preventiveMeasure:"",detentionDeadline:""})}),{data:t,columns:r}},HD=e=>({data:e.map(n=>({"Tên Tin báo":n.name,"Tội danh":n.charges,"Hạn giải quyết":n.resolutionDeadline,KSV:n.prosecutor,"Ghi chú":n.notes||"","Trạng thái":n.stage})),columns:[{key:"Tên Tin báo",label:"Tên Tin báo"},{key:"Tội danh",label:"Tội danh"},{key:"Hạn giải quyết",label:"Hạn giải quyết"},{key:"KSV",label:"KSV"},{key:"Ghi chú",label:"Ghi chú"},{key:"Trạng thái",label:"Trạng thái"}]}),zD=(e,t,r)=>{const n=qt(t),i=qt(r),s=e.filter(p=>{const v=qt(p.createdAt);return v>=n&&v<=i}),a=()=>{const p=s.length,v=s.reduce((x,w)=>x+w.defendants.length,0);return{cases:p,defendants:v}},o=()=>{const p=s.filter(x=>["Hoàn thành","Tạm đình chỉ","Đình chỉ","Chuyển đi"].includes(x.stage));return{completed:p.filter(x=>x.stage==="Hoàn thành").length,suspended:p.filter(x=>x.stage==="Tạm đình chỉ").length,discontinued:p.filter(x=>x.stage==="Đình chỉ").length,transferred:p.filter(x=>x.stage==="Chuyển đi").length,totalCases:p.length,totalDefendants:p.reduce((x,w)=>x+w.defendants.length,0)}},l=()=>({investigation:s.filter(p=>p.stage==="Điều tra").length,prosecution:s.filter(p=>p.stage==="Truy tố").length,trial:s.filter(p=>p.stage==="Xét xử").length,completed:s.filter(p=>p.stage==="Hoàn thành").length,suspended:s.filter(p=>p.stage==="Tạm đình chỉ").length,discontinued:s.filter(p=>p.stage==="Đình chỉ").length,transferred:s.filter(p=>p.stage==="Chuyển đi").length}),c=a(),u=o(),h=l(),d=[{key:"header1",label:"BÁO CÁO THỐNG KÊ VỤ ÁN",value:""},{key:"dateRange",label:`Từ ngày: ${t} - Đến ngày: ${r}`,value:""},{key:"empty1",label:"",value:""},{key:"section1Header",label:"PHẦN I: VỤ ÁN/BỊ CAN MỚI NHẬN",value:""},{key:"newCasesLabel",label:"Chỉ tiêu",value:"Số vụ án",value2:"Số bị can"},{key:"newCases",label:"Mới nhận trong kỳ",value:c.cases,value2:c.defendants},{key:"empty2",label:"",value:""},{key:"section2Header",label:"PHẦN II: VỤ ÁN/BỊ CAN ĐÃ XỬ LÝ",value:""},{key:"processedCasesLabel",label:"Chỉ tiêu",value:"Số vụ án",value2:"Số bị can"},{key:"totalProcessed",label:"Tổng đã xử lý",value:u.totalCases,value2:u.totalDefendants},{key:"completed",label:"- Hoàn thành (đã xét xử)",value:u.completed,value2:s.filter(p=>p.stage==="Hoàn thành").reduce((p,v)=>p+v.defendants.length,0)},{key:"suspended",label:"- Tạm đình chỉ",value:u.suspended,value2:s.filter(p=>p.stage==="Tạm đình chỉ").reduce((p,v)=>p+v.defendants.length,0)},{key:"discontinued",label:"- Đình chỉ",value:u.discontinued,value2:s.filter(p=>p.stage==="Đình chỉ").reduce((p,v)=>p+v.defendants.length,0)},{key:"transferred",label:"- Chuyển đi",value:u.transferred,value2:s.filter(p=>p.stage==="Chuyển đi").reduce((p,v)=>p+v.defendants.length,0)},{key:"empty3",label:"",value:""},{key:"section3Header",label:"PHẦN III: PHÂN BỐ THEO GIAI ĐOẠN",value:""},{key:"stageLabel",label:"Giai đoạn",value:"Số vụ án"},{key:"investigation",label:"Điều tra",value:h.investigation},{key:"prosecution",label:"Truy tố",value:h.prosecution},{key:"trial",label:"Xét xử",value:h.trial},{key:"completedStage",label:"Hoàn thành",value:h.completed},{key:"suspendedStage",label:"Tạm đình chỉ",value:h.suspended},{key:"discontinuedStage",label:"Đình chỉ",value:h.discontinued},{key:"transferredStage",label:"Chuyển đi",value:h.transferred}],m=d.map(p=>{const v={};return p.key==="header1"||p.key==="dateRange"||p.key.startsWith("empty")||p.key.endsWith("Header")?(v["Chỉ tiêu"]=p.label,v["Số liệu"]="",v["Số bị can"]=""):p.key==="newCasesLabel"||p.key==="processedCasesLabel"?(v["Chỉ tiêu"]=p.label,v["Số liệu"]=p.value,v["Số bị can"]=p.value2):p.key==="stageLabel"?(v["Chỉ tiêu"]=p.label,v["Số liệu"]=p.value,v["Số bị can"]=""):(v["Chỉ tiêu"]=p.label,v["Số liệu"]=p.value,v["Số bị can"]=p.value2!==void 0?p.value2:""),v}),g=["Chỉ tiêu","Số liệu"];return d.some(p=>p.value2!==void 0&&p.value2!=="")&&g.push("Số bị can"),{data:m,columns:g.map(p=>({key:p,label:p}))}},WD=(e,t,r)=>{const n=qt(t),i=qt(r),s=e.filter(p=>{const v=qt(p.createdAt);return v>=n&&v<=i}),a=()=>s.length,o=()=>{const p=s.filter(v=>["Khởi tố","Không khởi tố","Tạm đình chỉ","Chuyển đi"].includes(v.stage));return{prosecuted:p.filter(v=>v.stage==="Khởi tố").length,notProsecuted:p.filter(v=>v.stage==="Không khởi tố").length,suspended:p.filter(v=>v.stage==="Tạm đình chỉ").length,transferred:p.filter(v=>v.stage==="Chuyển đi").length,total:p.length}},l=()=>({pending:s.filter(p=>p.stage==="Đang xử lý").length,prosecuted:s.filter(p=>p.stage==="Khởi tố").length,notProsecuted:s.filter(p=>p.stage==="Không khởi tố").length,suspended:s.filter(p=>p.stage==="Tạm đình chỉ").length,transferred:s.filter(p=>p.stage==="Chuyển đi").length}),c=a(),u=o(),h=l();return{data:[{key:"header1",label:"BÁO CÁO THỐNG KÊ TIN BÁO"},{key:"dateRange",label:`Từ ngày: ${t} - Đến ngày: ${r}`},{key:"empty1",label:""},{key:"section1Header",label:"PHẦN I: TIN BÁO MỚI TIẾP NHẬN"},{key:"newReportsLabel",label:"Chỉ tiêu",value:"Số tin báo"},{key:"newReports",label:"Mới tiếp nhận trong kỳ",value:c},{key:"empty2",label:""},{key:"section2Header",label:"PHẦN II: TIN BÁO ĐÃ XỬ LÝ"},{key:"processedReportsLabel",label:"Chỉ tiêu",value:"Số tin báo"},{key:"totalProcessed",label:"Tổng đã xử lý",value:u.total},{key:"prosecuted",label:"- Khởi tố",value:u.prosecuted},{key:"notProsecuted",label:"- Không khởi tố",value:u.notProsecuted},{key:"suspended",label:"- Tạm đình chỉ",value:u.suspended},{key:"transferred",label:"- Chuyển đi",value:u.transferred},{key:"empty3",label:""},{key:"section3Header",label:"PHẦN III: PHÂN BỐ THEO TRẠNG THÁI"},{key:"stageLabel",label:"Trạng thái",value:"Số tin báo"},{key:"pending",label:"Đang xử lý",value:h.pending},{key:"prosecutedStage",label:"Khởi tố",value:h.prosecuted},{key:"notProsecutedStage",label:"Không khởi tố",value:h.notProsecuted},{key:"suspendedStage",label:"Tạm đình chỉ",value:h.suspended},{key:"transferredStage",label:"Chuyển đi",value:h.transferred}].map(p=>{const v={};return p.key==="header1"||p.key==="dateRange"||p.key.startsWith("empty")||p.key.endsWith("Header")?(v["Chỉ tiêu"]=p.label,v["Số tin báo"]=""):(p.key==="newReportsLabel"||p.key==="processedReportsLabel"||p.key,v["Chỉ tiêu"]=p.label,v["Số tin báo"]=p.value),v}),columns:[{key:"Chỉ tiêu",label:"Chỉ tiêu"},{key:"Số tin báo",label:"Số tin báo"}]}},VD=()=>{var sa;const{user:e,loading:t,signIn:r,signOut:n,isAuthenticated:i,supabase:s}=rh(),{isInitialized:a}=Ig(),[o,l]=ee.useState("cases"),[c,u]=ee.useState("add"),[h,d]=ee.useState(""),[m,g]=ee.useState(""),[p,v]=ee.useState(lt()),[x,w]=ee.useState(lt()),{prosecutors:y,loading:E,error:C,setProsecutors:R}=Jk(),D=(e==null?void 0:e.id)||"default",{cases:F,addCase:N,updateCase:P,deleteCase:W,transferStage:G,getCasesByStage:Q,getExpiringSoonCases:ve,isLoading:ge,overwriteAllCases:Te}=qk(D,a),{reports:Ee,addReport:H,updateReport:q,deleteReport:ie,transferReportStage:pe,getReportsByStage:O,getExpiringSoonReports:L,isLoading:j,overwriteAllReports:I}=Qk(D,a),[X,ce]=ee.useState(!1),[me,de]=ee.useState(!1),[ae,je]=ee.useState(!1),[ke,at]=ee.useState(null),[Ae,Ct]=ee.useState(null);if(t||!a||E)return f.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx(La,{className:"text-blue-600 mx-auto mb-4",size:48}),f.jsx("p",{className:"text-gray-600",children:"Đang khởi tạo hệ thống và tải dữ liệu..."})]})});if(!i)return f.jsx(Yk,{onLogin:r});const Ve=xe=>{l(xe),u("add"),d(""),g(""),v(lt()),w(lt())},fe=xe=>{console.log("Updated criminal code data:",xe)},Vt=xe=>{console.log("Updated prosecutors data in App:",xe),R(xe)},Tr=xe=>xe.filter(Ne=>{const cn=!h||Ne.name.toLowerCase().includes(h.toLowerCase())||Ne.charges.toLowerCase().includes(h.toLowerCase())||Ne.defendants&&Ne.defendants.some(aa=>aa.name.toLowerCase().includes(h.toLowerCase())||aa.charges.toLowerCase().includes(h.toLowerCase())),vi=!m||Ne.prosecutor===m;return cn&&vi}),on=xe=>{const Ne=[{key:"name",label:"Tên Vụ án"}];switch(xe){case"all":return[...Ne,{key:"charges",label:"Tội danh (VA)"},{key:"investigationDeadline",label:"Thời hạn ĐT"},{key:"totalDefendants",label:"Tổng Bị can"},{key:"shortestDetention",label:"BP Ngăn chặn ngắn nhất"},{key:"prosecutor",label:"KSV"},{key:"notes",label:"Ghi chú"},{key:"stage",label:"Giai đoạn"},{key:"prosecutionTransferDate",label:"Ngày chuyển TT"},{key:"trialTransferDate",label:"Ngày chuyển XX"},{key:"actions",label:"Hành động"}];case"investigation":return[...Ne,{key:"investigationDeadline",label:"Thời hạn ĐT"},{key:"totalDefendants",label:"Tổng Bị can"},{key:"shortestDetention",label:"BP Ngăn chặn ngắn nhất"},{key:"prosecutor",label:"KSV"},{key:"notes",label:"Ghi chú"},{key:"actions",label:"Hành động"}];case"prosecution":return[...Ne,{key:"totalDefendants",label:"Tổng Bị can"},{key:"shortestDetention",label:"BP Ngăn chặn ngắn nhất"},{key:"prosecutor",label:"KSV"},{key:"notes",label:"Ghi chú"},{key:"prosecutionTransferDate",label:"Ngày chuyển TT"},{key:"actions",label:"Hành động"}];case"trial":return[...Ne,{key:"totalDefendants",label:"Tổng Bị can"},{key:"shortestDetention",label:"BP Ngăn chặn ngắn nhất"},{key:"prosecutor",label:"KSV"},{key:"notes",label:"Ghi chú"},{key:"trialTransferDate",label:"Ngày chuyển XX"},{key:"actions",label:"Hành động"}];case"expiring":return[...Ne,{key:"stage",label:"Giai đoạn"},{key:"investigationRemaining",label:"Thời hạn ĐT còn lại"},{key:"totalDefendants",label:"Tổng Bị can"},{key:"shortestDetentionRemaining",label:"Hạn Tạm giam ngắn nhất"},{key:"prosecutor",label:"KSV"},{key:"notes",label:"Ghi chú"},{key:"actions",label:"Hành động"}];default:return Ne}},Fn=xe=>{const Ne=[{key:"name",label:"Tên Tin báo"}];switch(xe){case"all":return[...Ne,{key:"charges",label:"Tội danh"},{key:"resolutionDeadline",label:"Hạn giải quyết"},{key:"prosecutor",label:"KSV"},{key:"notes",label:"Ghi chú"},{key:"stage",label:"Trạng thái"},{key:"actions",label:"Hành động"}];case"pending":return[...Ne,{key:"charges",label:"Tội danh"},{key:"resolutionDeadline",label:"Hạn giải quyết"},{key:"prosecutor",label:"KSV"},{key:"notes",label:"Ghi chú"},{key:"actions",label:"Hành động"}];case"expiring":return[...Ne,{key:"charges",label:"Tội danh"},{key:"resolutionDeadline",label:"Hạn giải quyết"},{key:"prosecutor",label:"KSV"},{key:"notes",label:"Ghi chú"},{key:"actions",label:"Hành động"}];default:return Ne}},na=()=>{if(ge)return[];let xe;switch(c){case"all":xe=F;break;case"investigation":xe=Q("Điều tra");break;case"prosecution":xe=Q("Truy tố");break;case"trial":xe=Q("Xét xử");break;case"expiring":xe=ve();break;default:xe=[]}return Tr(xe)},Zi=()=>{if(j)return[];let xe;switch(c){case"all":xe=Ee;break;case"pending":xe=O("Đang xử lý");break;case"expiring":xe=L();break;default:xe=[]}return Tr(xe)},Er=o==="cases"?ve().length:L().length,xi=()=>{if(c==="statistics"){const{data:xe,columns:Ne}=zD(F,p,x);pl(xe,Ne,"ThongKeVuAn")}else{const xe=na(),{data:Ne,columns:cn}=$D(xe);pl(Ne,cn,"DanhSachVuAn")}},es=()=>{if(c==="statistics"){const{data:xe,columns:Ne}=WD(Ee,p,x);pl(xe,Ne,"ThongKeTinBao")}else{const xe=Zi(),{data:Ne,columns:cn}=HD(xe);pl(Ne,cn,"DanhSachTinBao")}},ia=async()=>{if(!e||!s){at("Lỗi: Người dùng chưa đăng nhập hoặc Supabase chưa sẵn sàng.");return}de(!0),at(null);try{const xe={cases:F,reports:Ee},{error:Ne}=await s.from("user_backups").upsert({user_id:e.id,data:xe,created_at:new Date().toISOString()},{onConflict:"user_id"});if(Ne)throw Ne;at("Lưu dữ liệu thành công lên Supabase!")}catch(xe){console.error("Lỗi khi lưu dữ liệu lên Supabase:",xe.message),at(`Lỗi khi lưu dữ liệu: ${xe.message}`)}finally{de(!1)}},ln=async()=>{if(!e||!s){Ct("Lỗi: Người dùng chưa đăng nhập hoặc Supabase chưa sẵn sàng.");return}je(!0),Ct(null);try{const{data:xe,error:Ne}=await s.from("user_backups").select("data").eq("user_id",e.id).single();if(Ne&&Ne.code!=="PGRST116")throw Ne;if(!xe||!xe.data){Ct("Không tìm thấy bản sao lưu nào trên Supabase.");return}if(!window.confirm("Bạn có chắc chắn muốn khôi phục dữ liệu từ Supabase? Thao tác này sẽ GHI ĐÈ toàn bộ dữ liệu hiện có trên thiết bị của bạn và không thể hoàn tác!")){Ct("Đã hủy khôi phục dữ liệu.");return}const vi=xe.data;await Te(vi.cases),await I(vi.reports),Ct("Khôi phục dữ liệu thành công từ Supabase! Dữ liệu đã được cập nhật.")}catch(xe){console.error("Lỗi khi khôi phục dữ liệu từ Supabase:",xe.message),Ct(`Lỗi khi khôi phục dữ liệu: ${xe.message}`)}finally{je(!1)}},Yc=()=>{if(o==="reports")switch(c){case"add":return f.jsx(Vk,{onAddReport:H,onTransferToCase:N,prosecutors:y});case"statistics":return f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex justify-end mb-4",children:[" ",f.jsxs("button",{onClick:es,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:[f.jsx(Ci,{size:16}),"Xuất Excel Tin Báo"]})]}),f.jsx(Xk,{reports:Ee,fromDate:p,toDate:x,setFromDate:v,setToDate:w})]});case"data":return f.jsx(up,{onUpdateCriminalCode:fe,onUpdateProsecutors:Vt,currentUserId:(e==null?void 0:e.id)||""});default:return f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex justify-end mb-4",children:[" ",f.jsxs("button",{onClick:es,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:[f.jsx(Ci,{size:16}),"Xuất Excel Tin Báo"]})]}),f.jsx(fp,{searchTerm:h,onSearchChange:d,selectedProsecutor:m,onProsecutorChange:g,prosecutors:y}),f.jsx(Kk,{reports:Zi(),columns:Fn(c),onDeleteReport:ie,onTransferStage:pe,onUpdateReport:q,onTransferToCase:N})]})}else switch(c){case"add":return f.jsx(yE,{onAddCase:N,prosecutors:y});case"statistics":return f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex justify-end mb-4",children:[" ",f.jsxs("button",{onClick:xi,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:[f.jsx(Ci,{size:16}),"Xuất Excel Vụ Án"]})]}),f.jsx(Wk,{cases:F,fromDate:p,toDate:x,setFromDate:v,setToDate:w})]});case"data":return f.jsx(up,{onUpdateCriminalCode:fe,onUpdateProsecutors:Vt,currentUserId:(e==null?void 0:e.id)||""});default:return f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"flex justify-end mb-4",children:f.jsxs("button",{onClick:xi,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:[f.jsx(Ci,{size:16}),"Xuất Excel Vụ Án"]})}),f.jsx(fp,{searchTerm:h,onSearchChange:d,selectedProsecutor:m,onProsecutorChange:g,prosecutors:y}),f.jsx(EE,{cases:na(),columns:on(c),onDeleteCase:W,onTransferStage:G,onUpdateCase:P,showWarnings:c==="expiring"})]})}};return f.jsxs("div",{className:"min-h-screen bg-gray-50",children:[f.jsx("header",{className:"bg-white shadow-sm",children:f.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:f.jsxs("div",{className:"flex items-center justify-between h-16",children:[f.jsxs("div",{className:"flex items-center gap-6",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(La,{className:"text-blue-600",size:28}),f.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Hệ Thống Quản Lý"})]}),f.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[f.jsxs("button",{onClick:()=>Ve("cases"),className:`flex items-center gap-2 px-4 py-2 rounded-md font-medium text-sm transition-colors ${o==="cases"?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:[f.jsx(La,{size:16}),"Vụ Án"]}),f.jsxs("button",{onClick:()=>Ve("reports"),className:`flex items-center gap-2 px-4 py-2 rounded-md font-medium text-sm transition-colors ${o==="reports"?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-gray-800"}`,children:[f.jsx(De,{size:16}),"Tin Báo"]})]})]}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx("div",{className:"text-sm text-gray-500",children:o==="cases"?`Tổng số vụ án: ${F.length}`:`Tổng số tin báo: ${Ee.length}`}),f.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:f.jsx("span",{children:((sa=e==null?void 0:e.user_metadata)==null?void 0:sa.username)||(e==null?void 0:e.email)})}),f.jsxs("button",{onClick:()=>ce(!0),className:"flex items-center gap-2 px-3 py-2 text-gray-600 hover:text-gray-800 transition-colors",title:"Lưu và Khôi phục dữ liệu từ Supabase",children:[f.jsx(I2,{size:16}),"Cloud"]}),f.jsxs("button",{onClick:n,className:"flex items-center gap-2 px-3 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:[f.jsx($2,{size:16}),"Đăng xuất"]})]})]})})}),f.jsx(W2,{activeTab:c,onTabChange:u,expiringSoonCount:Er,systemType:o}),f.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:Yc()}),X&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl max-w-md w-full mx-4",children:[f.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Lưu & Khôi phục dữ liệu (Supabase)"}),f.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Bạn có thể lưu dữ liệu hiện tại lên Supabase hoặc khôi phục dữ liệu đã lưu. Lưu ý: Chỉ có một bản sao lưu duy nhất cho mỗi tài khoản. Khi bạn lưu, bản sao lưu cũ sẽ bị ghi đè."}),f.jsxs("div",{className:"flex justify-end gap-3",children:[f.jsx("button",{onClick:ia,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",disabled:me,children:me?"Đang lưu...":f.jsxs(f.Fragment,{children:[f.jsx(wg,{size:16})," Lưu lên Cloud"]})}),f.jsx("button",{onClick:ln,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors",disabled:ae,children:ae?"Đang khôi phục...":f.jsxs(f.Fragment,{children:[f.jsx(Ci,{size:16})," Khôi phục từ Cloud"]})}),f.jsx("button",{onClick:()=>{ce(!1),at(null),Ct(null)},className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Đóng"})]}),ke&&f.jsx("p",{className:`mt-4 text-sm ${ke.startsWith("Lỗi")?"text-red-600":"text-green-600"}`,children:ke}),Ae&&f.jsx("p",{className:`mt-4 text-sm ${Ae.startsWith("Lỗi")?"text-red-600":"text-green-600"}`,children:Ae})]})})]})};fg(document.getElementById("root")).render(f.jsx(ee.StrictMode,{children:f.jsx(VD,{})}));
